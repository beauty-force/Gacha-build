import{q as h,o as l,c as a,b as k,D as B,w as M,V as H,F as v,H as J,d as e,L as O,e as I,t as r,n as j,f as x,h as f,I as b,J as $,K,a1 as P,a as z,E as G,a6 as Q,a7 as W}from"./app.a46c74b4.js";import{A as X}from"./Admin.75d81b1f.js";import{h as D}from"./useConfirm.02a785cd.js";import{_ as Y}from"./_plugin-vue_export-helper.cdc0426e.js";const i=o=>(Q("data-v-252799d4"),o=o(),W(),o),Z={class:"py-3"},ee={class:"w-full"},te={class:"px-4 sm:px-6 py-1"},se=i(()=>e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),oe={class:"bg-white shadow-sm sm:rounded-lg"},ne={class:"p-3 sm:p-6 text-gray-900"},le={class:"mb-6 pb-6 border-b border-gray-200"},ae={class:"flex items-start justify-between mb-4"},ie={class:"space-y-1"},re={class:"text-lg font-bold text-gray-900 mb-2"},de={class:"flex items-center space-x-4 text-sm text-gray-500 px-2"},ce=i(()=>e("span",null,"\u2022",-1)),ue={class:"bg-gray-50 rounded-lg p-4"},ge={class:"text-gray-700 whitespace-pre-line mb-4"},he={key:0,class:"mt-4"},me={class:"text-sm font-semibold text-gray-700 mb-2"},pe={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},ve=["onClick"],fe=["src","alt"],_e=i(()=>e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-opacity flex items-center justify-center pointer-events-none"},[e("svg",{class:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),xe={key:0,class:"space-y-4 mb-6"},be={class:"text-base font-bold text-gray-900 flex items-center border-b pb-2"},ye=i(()=>e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),we={key:0,class:"flex-1 flex justify-end"},ke={class:"max-w-[80%] bg-blue-50 border border-blue-200 rounded-lg p-3"},qe={class:"flex items-center gap-2 mb-2"},Ce=i(()=>e("svg",{class:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),Me={class:"text-xs font-bold text-blue-700"},je={class:"text-xs text-gray-500"},Ie={class:"text-sm text-gray-800 whitespace-pre-line"},Se={key:0,class:"mt-2 grid grid-cols-3 gap-2"},Be=["src","onClick"],$e={key:1,class:"flex-1"},ze={class:"max-w-[80%] bg-gray-100 border border-gray-300 rounded-lg p-3"},De={class:"flex items-center gap-2 mb-2"},Le=i(()=>e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),Ve={class:"text-xs font-bold text-gray-700"},Te={class:"text-xs text-gray-500"},Ee={class:"text-sm text-gray-800 whitespace-pre-line"},Ae={key:0,class:"mt-2 grid grid-cols-3 gap-2"},Fe=["src","onClick"],Ne=["onSubmit"],Re=i(()=>e("h3",{class:"text-base font-bold text-gray-900"},"\u8FD4\u4FE1\u3092\u9001\u4FE1",-1)),Ue=i(()=>e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[I(" \u753B\u50CF\u3092\u6DFB\u4ED8 "),e("span",{class:"text-gray-500 text-xs font-normal"},"(\u4EFB\u610F\u3001\u6700\u59273\u679A)")],-1)),He={key:0,class:"mt-2 grid grid-cols-3 gap-2"},Je=["src"],Oe=["onClick"],Ke=i(()=>e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Pe=[Ke],Ge={class:"flex items-center gap-4"},Qe={class:"flex-1"},We=i(()=>e("label",{for:"status",class:"block text-sm font-medium text-gray-700 mb-2"}," \u30B9\u30C6\u30FC\u30BF\u30B9 ",-1)),Xe=i(()=>e("option",{value:"pending"},"\u5BFE\u5FDC\u4E2D",-1)),Ye=i(()=>e("option",{value:"answered"},"\u5B8C\u4E86",-1)),Ze=i(()=>e("option",{value:"closed"},"\u30AF\u30ED\u30FC\u30BA",-1)),et=[Xe,Ye,Ze],tt={class:"flex-shrink-0 mt-6"},st=["disabled"],ot={class:"flex flex-col items-center justify-center h-screen p-4 gap-2"},nt=i(()=>e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-90 transition-opacity"},null,-1)),lt={class:"relative z-10 flex items-center justify-center gap-4 w-full max-w-6xl flex-shrink-0"},at=i(()=>e("div",{class:"flex-1"},null,-1)),it={class:"px-4 py-2 bg-white rounded-full text-gray-900 text-sm font-bold shadow-xl"},rt={class:"flex-1 flex justify-end"},dt=["onClick"],ct=i(()=>e("svg",{class:"w-6 h-6 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M6 18L18 6M6 6l12 12"})],-1)),ut=[ct],gt={class:"relative z-10 flex flex-col items-center w-full max-w-6xl flex-1 min-h-0 gap-2"},ht={class:"flex-1 flex items-center justify-center min-h-0 w-full"},mt=["src"],pt={class:"flex items-center justify-center gap-3 flex-shrink-0"},vt=["onClick","disabled"],ft=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M15 19l-7-7 7-7"})],-1)),_t=[ft],xt=["onClick","disabled"],bt=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M9 5l7 7-7 7"})],-1)),yt=[bt],wt={__name:"Show",props:{question:Object},setup(o){const u=o,m=h(null),d=h(0),_=h(""),p=h([]),L=h(null),y=h(!1),w=h(u.question.status),q=s=>{const n=[...u.question.images||[],...u.question.replies.flatMap(t=>t.images||[])];m.value=s,d.value=n.indexOf(s)},V=()=>{const s=[...u.question.images||[],...u.question.replies.flatMap(n=>n.images||[])];d.value<s.length-1&&(d.value++,m.value=s[d.value])},T=()=>{if(d.value>0){const s=[...u.question.images||[],...u.question.replies.flatMap(n=>n.images||[])];d.value--,m.value=s[d.value]}},S=()=>{m.value=null},E=s=>{const n=Array.from(s.target.files);if(p.value.length+n.length>3){alert("\u753B\u50CF\u306F\u6700\u59273\u679A\u307E\u3067\u3067\u3059");return}n.forEach(t=>{const c=new FileReader;c.onload=g=>{p.value.push({file:t,preview:g.target.result})},c.readAsDataURL(t)}),s.target.value=""},A=s=>{p.value.splice(s,1)},F=()=>{let s=(u.question.images||[]).length;return u.question.replies&&u.question.replies.forEach(n=>{s+=(n.images||[]).length}),s},N=async()=>{if(!_.value.trim())return;y.value=!0;const s=new FormData;s.append("message",_.value),p.value.forEach((n,t)=>{s.append(`images[${t}]`,n.file)});try{await z.post(route("admin.support-questions.reply",u.question.id),s,{headers:{"Content-Type":"multipart/form-data"}}),w.value!==u.question.status&&await z.post(route("admin.support-questions.update-status",u.question.id),{status:w.value,admin_response:""}),await D.fire({icon:"success",title:"\u9001\u4FE1\u5B8C\u4E86",text:"\u8FD4\u4FE1\u3092\u9001\u4FE1\u3057\u307E\u3057\u305F",confirmButtonColor:"#3b82f6"}),G.Inertia.reload()}catch{await D.fire({icon:"error",title:"\u30A8\u30E9\u30FC",text:"\u9001\u4FE1\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}finally{y.value=!1}},R=s=>({pending:"\u5BFE\u5FDC\u4E2D",answered:"\u5B8C\u4E86",closed:"\u30AF\u30ED\u30FC\u30BA"})[s]||s,C=s=>new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(s,n)=>(l(),a(v,null,[k(B(J),{title:"\u30B5\u30DD\u30FC\u30C8\u8CEA\u554F\u8A73\u7D30"}),k(X,null,{default:M(()=>[e("div",Z,[e("div",ee,[e("div",te,[k(B(O),{href:s.route("admin.support-questions.index"),class:"inline-flex items-center text-gray-600 hover:text-yellow-600 font-semibold"},{default:M(()=>[se,I(" \u8CEA\u554F\u4E00\u89A7\u306B\u623B\u308B ")]),_:1},8,["href"])]),e("div",oe,[e("div",ne,[e("div",le,[e("div",ae,[e("div",ie,[e("h3",re,r(o.question.subject),1),e("div",de,[e("span",null,r(C(o.question.created_at)),1),ce,e("span",null,r(o.question.name)+" ("+r(o.question.email)+")",1)])]),e("span",{class:j({"my-1 px-3 py-1 text-xs font-semibold rounded-full text-nowrap":!0,"bg-yellow-100 text-yellow-800":o.question.status==="pending","bg-green-100 text-green-800":o.question.status==="answered","bg-gray-100 text-gray-800":o.question.status==="closed"})},r(R(o.question.status)),3)]),e("div",ue,[e("p",ge,r(o.question.question),1),o.question.images&&o.question.images.length>0?(l(),a("div",he,[e("h4",me,"\u6DFB\u4ED8\u753B\u50CF ("+r(o.question.images.length)+")",1),e("div",pe,[(l(!0),a(v,null,x(o.question.images,(t,c)=>(l(),a("div",{key:c,class:"relative group bg-white rounded-lg overflow-hidden border border-gray-200 hover:border-yellow-400 transition-all cursor-pointer",onClick:g=>q(t)},[e("img",{src:`/images/support_questions/${t}`,alt:`\u6DFB\u4ED8\u753B\u50CF ${c+1}`,class:"w-full h-full object-contain"},null,8,fe),_e],8,ve))),128))])])):f("",!0)])]),o.question.replies&&o.question.replies.length>0?(l(),a("div",xe,[e("h3",be,[ye,I(" \u4F1A\u8A71\u5C65\u6B74 ("+r(o.question.replies.length)+") ",1)]),(l(!0),a(v,null,x(o.question.replies,t=>(l(),a("div",{key:t.id,class:"flex gap-3"},[t.is_admin?(l(),a("div",we,[e("div",ke,[e("div",qe,[Ce,e("span",Me,"\u30B5\u30DD\u30FC\u30C8 ("+r(t.user.name)+")",1),e("span",je,r(C(t.created_at)),1)]),e("p",Ie,r(t.message),1),t.images&&t.images.length>0?(l(),a("div",Se,[(l(!0),a(v,null,x(t.images,(c,g)=>(l(),a("img",{key:g,src:`/images/support_questions/${c}`,class:"w-full h-20 object-cover rounded cursor-pointer",onClick:U=>q(c)},null,8,Be))),128))])):f("",!0)])])):(l(),a("div",$e,[e("div",ze,[e("div",De,[Le,e("span",Ve,r(t.user.name),1),e("span",Te,r(C(t.created_at)),1)]),e("p",Ee,r(t.message),1),t.images&&t.images.length>0?(l(),a("div",Ae,[(l(!0),a(v,null,x(t.images,(c,g)=>(l(),a("img",{key:g,src:`/images/support_questions/${c}`,class:"w-full h-20 object-cover rounded cursor-pointer",onClick:U=>q(c)},null,8,Fe))),128))])):f("",!0)])]))]))),128))])):f("",!0),e("form",{onSubmit:b(N,["prevent"]),class:"space-y-4 border-t pt-4"},[Re,e("div",null,[$(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=t=>_.value=t),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"\u8FD4\u4FE1\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044...",required:""},null,512),[[K,_.value]])]),e("div",null,[Ue,e("input",{type:"file",ref_key:"imageInput",ref:L,accept:"image/*",multiple:"",onChange:E,class:"hidden"},null,544),e("button",{type:"button",onClick:n[1]||(n[1]=t=>s.$refs.imageInput.click()),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50"}," \u753B\u50CF\u3092\u9078\u629E "),p.value.length>0?(l(),a("div",He,[(l(!0),a(v,null,x(p.value,(t,c)=>(l(),a("div",{key:c,class:"relative"},[e("img",{src:t.preview,class:"w-full h-20 object-cover rounded"},null,8,Je),e("button",{type:"button",onClick:g=>A(c),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1"},Pe,8,Oe)]))),128))])):f("",!0)]),e("div",Ge,[e("div",Qe,[We,$(e("select",{id:"status","onUpdate:modelValue":n[2]||(n[2]=t=>w.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400"},et,512),[[P,w.value]])]),e("div",tt,[e("button",{type:"submit",disabled:y.value||!_.value.trim(),class:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50"},r(y.value?"\u9001\u4FE1\u4E2D...":"\u8FD4\u4FE1\u3059\u308B"),9,st)])])],40,Ne)])])])])]),_:1}),k(H,{name:"modal"},{default:M(()=>[m.value?(l(),a("div",{key:0,class:"fixed inset-0 z-[9999]",onClick:S},[e("div",ot,[nt,e("div",lt,[at,e("div",it,r(d.value+1)+" / "+r(F()),1),e("div",rt,[e("button",{onClick:b(S,["stop"]),class:"p-3 bg-white rounded-full hover:bg-gray-100 transition-colors shadow-xl",type:"button",title:"\u9589\u3058\u308B"},ut,8,dt)])]),e("div",gt,[e("div",ht,[e("img",{src:`/images/support_questions/${m.value}`,alt:"\u62E1\u5927\u753B\u50CF",class:"max-w-full max-h-full w-auto h-auto object-contain rounded-lg shadow-2xl border-4 border-white",onClick:n[3]||(n[3]=b(()=>{},["stop"]))},null,8,mt)]),e("div",pt,[e("button",{onClick:b(T,["stop"]),disabled:d.value===0,class:j({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value>0,"bg-gray-300 cursor-not-allowed opacity-50":d.value===0}),type:"button",title:"\u524D\u3078"},_t,10,vt),e("button",{onClick:b(V,["stop"]),disabled:d.value>=o.question.images.length-1,class:j({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value<o.question.images.length-1,"bg-gray-300 cursor-not-allowed opacity-50":d.value>=o.question.images.length-1}),type:"button",title:"\u6B21\u3078"},yt,10,xt)])])])])):f("",!0)]),_:1})],64))}},jt=Y(wt,[["__scopeId","data-v-252799d4"]]);export{jt as default};
