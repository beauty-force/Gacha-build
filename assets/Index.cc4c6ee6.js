import{o as n,c as l,d as e,t as i,h as b,G as C,q as y,i as E,w,b as v,D as m,H,F as p,f as $,I as j,n as D,e as z,J as q,aa as G,a as O}from"./app.fabf4c73.js";import{A as R}from"./UserLayout.81ac6782.js";import{o as V,f as T,u as U}from"./useConfirm.590f8935.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.b46018b5.js";const K={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Q={class:"flex flex-col items-center"},W=e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-theme"},null,-1),X={class:"mt-2 text-white text-sm"},Y={__name:"Loading",props:{show:{type:Boolean,default:!1},message:{type:String,default:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."}},setup(s){return(x,g)=>s.show?(n(),l("div",K,[e("div",Q,[W,e("p",X,i(s.message),1)])])):b("",!0)}},Z={class:"py-4"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden"},se={class:"p-6 bg-white border-gray-200"},oe={key:0,class:"text-lg font-semibold mb-6"},ie={key:1,class:"mb-8 p-6 bg-blue-50 rounded-lg"},ne={class:"flex flex-wrap justify-between md:grid md:grid-cols-3 gap-4"},ae=e("p",{class:"text-sm text-blue-600"},"\u30D7\u30E9\u30F3\u540D",-1),le={class:"font-medium"},re=e("p",{class:"text-sm text-blue-600"},"\u958B\u59CB\u65E5",-1),ce={class:"font-medium"},de=e("p",{class:"text-sm text-blue-600"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),ue={class:"font-medium"},me={class:"flex flex-wrap items-end justify-between mt-3"},be={key:0,class:"flex items-center py-2"},fe={class:"flex items-center gap-1"},he=["src","alt"],_e={class:"font-medium"},ve={class:"text-sm text-gray-500"},pe={class:"text-xs text-gray-500"},xe=["disabled"],ge=e("h3",{class:"text-lg font-semibold mb-6"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),ye={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},we={class:"text-xl font-bold mb-2"},Se={class:"text-gray-600 mb-4"},ke={class:"mb-4"},Ce={class:"text-xl font-bold leading-8"},$e=e("span",{class:"text-sm font-normal"},"/\u6708",-1),je={class:"text-green-600 text-sm"},De={class:"text-rose-500 text-sm leading-7 font-bold"},Fe=["onSubmit"],Ne=["disabled"],Be={class:"py-3 px-1 text-center"},Le={class:"font-bold text-lg"},ze={class:"text-lg font-bold text-theme mt-1"},Ve=e("span",{class:"text-sm font-normal"},"/\u6708",-1),Ae={class:"p-2"},Ie={key:0,class:"text-sm text-gray-500 mb-2"},Me={key:1,class:"space-y-2"},Je=["onClick"],Pe=["id","value"],Ee=["for"],He={class:"flex items-center"},qe=["src","alt"],Ge={class:"font-medium"},Oe={class:"text-sm text-gray-500"},Re={class:"text-xs text-gray-500"},Te={key:2,class:"text-gray-500 mb-2"},Ue=e("hr",{class:"my-1"},null,-1),Ke={class:"flex justify-between p-2 gap-2"},Qe=["disabled"],tt={__name:"Index",props:{plans:Array,currentSubscription:Object,cards:Array},setup(s){const x=s,{confirm:g}=U(),S=C({}),k=y(!1),r=y(""),d=y(null),c=y(!1),f=t=>new Intl.NumberFormat("ja-JP").format(t),A=t=>new Date(t).toLocaleDateString("ja-JP"),F=t=>`/images/credit_cards/${t.toLowerCase()}.svg`,N=t=>t.replace(/(.{4})/g,"$1 ").trim(),B=t=>`${t.slice(0,2)}/${t.slice(2)}`,I=()=>{g("\u89E3\u7D04\u3057\u307E\u3059\u304B\uFF1F","\u89E3\u7D04\u5F8C\u30011\u30F6\u6708\u9593\u767B\u9332\u306F\u3067\u304D\u307E\u305B\u3093\u3002").then(t=>{t&&(c.value=!0,S.post(route("user.subscription.cancel",x.currentSubscription.id),{onFinish:()=>{c.value=!1}}))})},M=()=>{c.value=!0,O.get(route("user.point.card_register",{type:"subscription"})).then(t=>{c.value=!1,t.data.status==1&&(window.location.href=t.data.link_url)}).catch(()=>{c.value=!1})},J=t=>{d.value=t,k.value=!0},h=()=>{k.value=!1,r.value="",d.value=null},P=()=>{d.value&&r.value&&(x.currentSubscription?g("\u30D7\u30E9\u30F3\u3092\u5909\u66F4\u3057\u307E\u3059\u304B\uFF1F",'<div class="text-start space-y-2"><div>\u2022\u3000\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u306E\u5834\u5408\u3001\u73FE\u5728\u306E\u30D7\u30E9\u30F3\u3068\u306E\u5DEE\u984D\u304C\u3059\u3050\u306B\u8ACB\u6C42\u3055\u308C\u3001\u8ACB\u6C42\u65E5\u3082\u672C\u65E5\u306B\u66F4\u65B0\u3055\u308C\u307E\u3059\u3002</div><div>\u2022\u3000\u30C0\u30A6\u30F3\u30B0\u30EC\u30FC\u30C9\u307E\u305F\u306F\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u5909\u66F4\u3059\u308B\u5834\u5408\u3001\u8ACB\u6C42\u65E5\u306F\u5909\u308F\u3089\u305A\u3001\u6B21\u56DE\u306E\u8ACB\u6C42\u6642\u306B\u65B0\u3057\u3044\u30D7\u30E9\u30F3\u306E\u6599\u91D1\u304C\u9069\u7528\u3055\u308C\u307E\u3059\u3002</div></div>').then(t=>{t&&(c.value=!0,C({plan_id:d.value.id,card_id:r.value}).post(route("user.subscription.update",x.currentSubscription.id),{onFinish:()=>{c.value=!1,h()},preserveScroll:!0}))}):g("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u306B\u767B\u9332\u3057\u307E\u3059\u304B\uFF1F").then(t=>{t&&(c.value=!0,C({card_id:r.value}).post(route("user.subscription.subscribe",d.value.id),{onFinish:()=>{c.value=!1,h()},preserveScroll:!0}))}))};return(t,u)=>(n(),E(R,null,{default:w(()=>[v(m(H),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),v(Y,{show:c.value,message:"\u51E6\u7406\u4E2D..."},null,8,["show","message"]),e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[s.currentSubscription?(n(),l("h3",oe,"\u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3")):b("",!0),s.currentSubscription?(n(),l("div",ie,[e("div",ne,[e("div",null,[ae,e("p",le,i(s.currentSubscription.plan.name),1)]),e("div",null,[re,e("p",ce,i(A(s.currentSubscription.start_date)),1)]),e("div",null,[de,e("p",ue,i(f(s.currentSubscription.plan.point))+" pt",1)])]),e("div",me,[(n(!0),l(p,null,$(s.cards,o=>(n(),l(p,null,[s.currentSubscription.card_id===o.id?(n(),l("div",be,[e("div",fe,[e("img",{src:F(o.brand),alt:o.brand,class:"w-20 h-12 mr-2"},null,8,he),e("div",null,[e("p",_e,i(N(o.card_no)),1),e("p",ve,"\u6709\u52B9\u671F\u9650: "+i(B(o.expire)),1),e("p",pe,"\u540D\u7FA9\u4EBA: "+i(o.holder_name),1)])])])):b("",!0)],64))),256)),e("form",{onSubmit:u[0]||(u[0]=j(o=>I(),["prevent"])),class:"mt-4"},[e("button",{type:"submit",class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm",disabled:m(S).processing}," \u89E3\u7D04 ",8,xe)],32)])])):b("",!0),ge,e("div",ye,[(n(!0),l(p,null,$(s.plans,o=>{var _;return n(),l("div",{key:o.id,class:D(["border rounded-lg p-6",{"bg-yellow-50 border-yellow-500 border-2":((_=s.currentSubscription)==null?void 0:_.plan_id)===o.id}])},[e("h4",we,i(o.name),1),e("p",Se,i(o.description),1),e("div",ke,[e("p",Ce,[z("\xA5"+i(f(o.amount)),1),$e]),e("p",je,i(f(o.point))+" \u30DD\u30A4\u30F3\u30C8\u4ED8\u4E0E",1),e("p",De,i(f(o.point-o.amount))+" pt\u304A\u5F97!!",1)]),e("div",null,[e("form",{onSubmit:j(a=>J(o),["prevent"])},[e("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-4 rounded text-sm",disabled:m(S).processing},i(s.currentSubscription?s.currentSubscription.plan_id!=o.id?"\u30D7\u30E9\u30F3\u5909\u66F4":"\u30AB\u30FC\u30C9\u5909\u66F4":"\u30B5\u30D6\u30B9\u30AF\u30E9\u30A4\u30D6"),9,Ne)],40,Fe)])],2)}),128))])])])])]),v(m(T),{show:k.value,class:""},{default:w(()=>[v(m(V),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:w(()=>{var o,_;return[e("div",{class:"fixed inset-0 z-40",onClick:h},[e("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:u[2]||(u[2]=j(()=>{},["stop"]))},[e("div",Be,[e("div",Le,i((o=d.value)==null?void 0:o.name),1),e("div",ze,[z("\xA5 "+i(f((_=d.value)==null?void 0:_.amount)),1),Ve])]),e("div",Ae,[s.cards.length>0?(n(),l("div",Ie,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):b("",!0),s.cards.length>0?(n(),l("div",Me,[(n(!0),l(p,null,$(s.cards,a=>(n(),l(p,{key:a.id},[!s.currentSubscription||d.value&&d.value.id!=s.currentSubscription.plan_id||a.id!=s.currentSubscription.card_id?(n(),l("div",{key:0,class:D([{"border-yellow-500 bg-yellow-50 border-2":r.value===a.id,"hover:bg-gray-50 hover:border-gray-300":r.value!==a.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:L=>r.value=a.id},[q(e("input",{type:"radio",id:"card-"+a.id,value:a.id,"onUpdate:modelValue":u[1]||(u[1]=L=>r.value=L),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,Pe),[[G,r.value]]),e("label",{for:"card-"+a.id,class:"flex-1 cursor-pointer"},[e("div",He,[e("img",{src:F(a.brand),alt:a.brand,class:"w-20 h-12 mr-2"},null,8,qe),e("div",null,[e("p",Ge,i(N(a.card_no)),1),e("p",Oe,"\u6709\u52B9\u671F\u9650: "+i(B(a.expire)),1),e("p",Re,"\u540D\u7FA9\u4EBA: "+i(a.holder_name),1)])])],8,Ee)],10,Je)):b("",!0)],64))),128))])):(n(),l("div",Te," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),Ue,e("button",{onClick:M,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),e("div",Ke,[e("button",{onClick:h,class:"bg-gray-300 text-gray-700 flex-1 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),e("button",{onClick:P,class:D(["bg-theme text-white flex-1 py-2 rounded text-sm",{"opacity-50":!r.value}]),disabled:!r.value}," \u78BA\u8A8D ",10,Qe)])])])]}),_:1}),v(m(V),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:w(()=>[e("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:h})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{tt as default};
