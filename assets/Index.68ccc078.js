import{o as i,c as n,d as e,t as a,h as _,G as $,q as w,i as E,w as S,b as p,D as b,H,f as x,F as m,I as j,n as D,e as F,J as q,aa as G,a as O}from"./app.43138155.js";import{A as R}from"./UserLayout.f4d39f40.js";import{o as z,f as T,u as U}from"./useConfirm.9d3b096f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.466b7bcd.js";const K={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Q={class:"flex flex-col items-center"},W=e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-theme"},null,-1),X={class:"mt-2 text-white text-sm"},Y={__name:"Loading",props:{show:{type:Boolean,default:!1},message:{type:String,default:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."}},setup(s){return(g,y)=>s.show?(i(),n("div",K,[e("div",Q,[W,e("p",X,a(s.message),1)])])):_("",!0)}},Z={class:"md:py-2 md:px-4 bg-white"},ee={class:"space-y-6 mb-4"},te=["src"],se={class:"py-4 px-4 overflow-hidden"},oe={class:"bg-white border-gray-200"},ie={key:0,class:"text-lg font-semibold mb-6"},ne={key:1,class:"mb-8 p-6 bg-blue-50 rounded-lg"},ae={class:"flex flex-wrap justify-between md:grid md:grid-cols-3 gap-4"},le=e("p",{class:"text-sm text-blue-600"},"\u30D7\u30E9\u30F3\u540D",-1),re={class:"font-medium"},ce=e("p",{class:"text-sm text-blue-600"},"\u958B\u59CB\u65E5",-1),de={class:"font-medium"},ue=e("p",{class:"text-sm text-blue-600"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),me={class:"font-medium"},fe={class:"flex flex-wrap items-end justify-between mt-3"},be={key:0,class:"flex items-center py-2"},_e={class:"flex items-center gap-1"},he=["src","alt"],ve={class:"font-medium"},pe={class:"text-sm text-gray-500"},xe={class:"text-xs text-gray-500"},ge=["disabled"],ye=e("h3",{class:"text-lg font-semibold mb-6"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),we={class:"space-y-4"},Se=["src"],ke={class:"flex-1 flex flex-col md:flex-row md:justify-between md:items-center gap-3"},Ce={class:"space-y-1 text-end md:text-left px-2"},$e={class:"text-xl font-bold leading-8"},je=e("span",{class:"text-sm font-normal"},"/\u6708",-1),De={class:"text-green-600 text-sm"},Fe={class:"text-rose-500 text-sm leading-7 font-bold"},Ne=["onSubmit"],Ae=["disabled"],Be={class:"my-6 space-y-6"},Le=["src"],ze={class:"py-3 px-1 text-center"},Ve={class:"font-bold text-lg"},Ie={class:"text-lg font-bold text-theme mt-1"},Me=e("span",{class:"text-sm font-normal"},"/\u6708",-1),Je={class:"p-2"},Pe={key:0,class:"text-sm text-gray-500 mb-2"},Ee={key:1,class:"space-y-2"},He=["onClick"],qe=["id","value"],Ge=["for"],Oe={class:"flex items-center"},Re=["src","alt"],Te={class:"font-medium"},Ue={class:"text-sm text-gray-500"},Ke={class:"text-xs text-gray-500"},Qe={key:2,class:"text-gray-500 mb-2"},We=e("hr",{class:"my-1"},null,-1),Xe={class:"flex justify-between p-2 gap-2"},Ye=["disabled"],it={__name:"Index",props:{plans:Array,currentSubscription:Object,cards:Array,images:Array,top_images:Array},setup(s){const g=s,{confirm:y}=U(),k=$({}),C=w(!1),r=w(""),d=w(null),c=w(!1),h=o=>new Intl.NumberFormat("ja-JP").format(o),V=o=>new Date(o).toLocaleDateString("ja-JP"),N=o=>`/images/credit_cards/${o.toLowerCase()}.svg`,A=o=>o.replace(/(.{4})/g,"$1 ").trim(),B=o=>`${o.slice(0,2)}/${o.slice(2)}`,I=()=>{y("\u89E3\u7D04\u3057\u307E\u3059\u304B\uFF1F","\u89E3\u7D04\u5F8C\u30011\u30F6\u6708\u9593\u767B\u9332\u306F\u3067\u304D\u307E\u305B\u3093\u3002").then(o=>{o&&(c.value=!0,k.post(route("user.subscription.cancel",g.currentSubscription.id),{onFinish:()=>{c.value=!1}}))})},M=()=>{c.value=!0,O.get(route("user.point.card_register",{type:"subscription"})).then(o=>{c.value=!1,o.data.status==1&&(window.location.href=o.data.link_url)}).catch(()=>{c.value=!1})},J=o=>{d.value=o,C.value=!0},v=()=>{C.value=!1,r.value="",d.value=null},P=()=>{d.value&&r.value&&(g.currentSubscription?y("\u30D7\u30E9\u30F3\u3092\u5909\u66F4\u3057\u307E\u3059\u304B\uFF1F",'<div class="text-start space-y-2"><div>\u2022\u3000\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u306E\u5834\u5408\u3001\u73FE\u5728\u306E\u30D7\u30E9\u30F3\u3068\u306E\u5DEE\u984D\u304C\u3059\u3050\u306B\u8ACB\u6C42\u3055\u308C\u3001\u8ACB\u6C42\u65E5\u3082\u672C\u65E5\u306B\u66F4\u65B0\u3055\u308C\u307E\u3059\u3002</div><div>\u2022\u3000\u30C0\u30A6\u30F3\u30B0\u30EC\u30FC\u30C9\u307E\u305F\u306F\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u5909\u66F4\u3059\u308B\u5834\u5408\u3001\u8ACB\u6C42\u65E5\u306F\u5909\u308F\u3089\u305A\u3001\u6B21\u56DE\u306E\u8ACB\u6C42\u6642\u306B\u65B0\u3057\u3044\u30D7\u30E9\u30F3\u306E\u6599\u91D1\u304C\u9069\u7528\u3055\u308C\u307E\u3059\u3002</div></div>').then(o=>{o&&(c.value=!0,$({plan_id:d.value.id,card_id:r.value}).post(route("user.subscription.update",g.currentSubscription.id),{onFinish:()=>{c.value=!1,v()},preserveScroll:!0}))}):y("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u306B\u767B\u9332\u3057\u307E\u3059\u304B\uFF1F").then(o=>{o&&(c.value=!0,$({card_id:r.value}).post(route("user.subscription.subscribe",d.value.id),{onFinish:()=>{c.value=!1,v()},preserveScroll:!0}))}))};return(o,f)=>(i(),E(R,null,{default:S(()=>[p(b(H),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),p(Y,{show:c.value,message:"\u51E6\u7406\u4E2D..."},null,8,["show","message"]),e("div",Z,[e("div",ee,[(i(!0),n(m,null,x(s.top_images,(t,u)=>(i(),n("img",{key:u,src:t,class:"w-full"},null,8,te))),128))]),e("div",se,[e("div",oe,[s.currentSubscription?(i(),n("h3",ie,"\u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3")):_("",!0),s.currentSubscription?(i(),n("div",ne,[e("div",ae,[e("div",null,[le,e("p",re,a(s.currentSubscription.plan.name),1)]),e("div",null,[ce,e("p",de,a(V(s.currentSubscription.start_date)),1)]),e("div",null,[ue,e("p",me,a(h(s.currentSubscription.plan.point))+" pt",1)])]),e("div",fe,[(i(!0),n(m,null,x(s.cards,t=>(i(),n(m,null,[s.currentSubscription.card_id===t.id?(i(),n("div",be,[e("div",_e,[e("img",{src:N(t.brand),alt:t.brand,class:"w-20 h-12 mr-2"},null,8,he),e("div",null,[e("p",ve,a(A(t.card_no)),1),e("p",pe,"\u6709\u52B9\u671F\u9650: "+a(B(t.expire)),1),e("p",xe,"\u540D\u7FA9\u4EBA: "+a(t.holder_name),1)])])])):_("",!0)],64))),256)),e("form",{onSubmit:f[0]||(f[0]=j(t=>I(),["prevent"])),class:"mt-4"},[e("button",{type:"submit",class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm",disabled:b(k).processing}," \u89E3\u7D04 ",8,ge)],32)])])):_("",!0),ye,e("div",we,[(i(!0),n(m,null,x(s.plans,t=>{var u;return i(),n("div",{key:t.id,class:D(["border rounded-lg p-3 md:p-4 flex justify-between items-center gap-4 hover:bg-gray-50",{"bg-yellow-50 border-yellow-500 border-2":((u=s.currentSubscription)==null?void 0:u.plan_id)===t.id}])},[e("img",{src:t.image,class:"md:flex-1 w-40 md:max-w-48 object-contain"},null,8,Se),e("div",ke,[e("div",Ce,[e("p",$e,[F("\xA5"+a(h(t.amount)),1),je]),e("p",De,[e("strong",null,a(h(t.point)),1),F(" \u30DD\u30A4\u30F3\u30C8\u4ED8\u4E0E")]),e("p",Fe,a(h(t.point-t.amount))+" pt\u304A\u5F97!!",1)]),e("div",null,[e("form",{onSubmit:j(l=>J(t),["prevent"])},[e("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-3 rounded text-xs md:text-sm",disabled:b(k).processing},a(s.currentSubscription?s.currentSubscription.plan_id!=t.id?"\u30D7\u30E9\u30F3\u5909\u66F4":"\u30AB\u30FC\u30C9\u5909\u66F4":"\u53C2\u52A0\u3059\u308B!"),9,Ae)],40,Ne)])])],2)}),128))]),e("div",Be,[(i(!0),n(m,null,x(s.images,(t,u)=>(i(),n("img",{key:u,src:t,class:"w-full"},null,8,Le))),128))])])])]),p(b(T),{show:C.value,class:""},{default:S(()=>[p(b(z),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:S(()=>{var t,u;return[e("div",{class:"fixed inset-0 z-40",onClick:v},[e("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:f[2]||(f[2]=j(()=>{},["stop"]))},[e("div",ze,[e("div",Ve,a((t=d.value)==null?void 0:t.name),1),e("div",Ie,[F("\xA5 "+a(h((u=d.value)==null?void 0:u.amount)),1),Me])]),e("div",Je,[s.cards.length>0?(i(),n("div",Pe,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):_("",!0),s.cards.length>0?(i(),n("div",Ee,[(i(!0),n(m,null,x(s.cards,l=>(i(),n(m,{key:l.id},[!s.currentSubscription||d.value&&d.value.id!=s.currentSubscription.plan_id||l.id!=s.currentSubscription.card_id?(i(),n("div",{key:0,class:D([{"border-yellow-500 bg-yellow-50 border-2":r.value===l.id,"hover:bg-gray-50 hover:border-gray-300":r.value!==l.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:L=>r.value=l.id},[q(e("input",{type:"radio",id:"card-"+l.id,value:l.id,"onUpdate:modelValue":f[1]||(f[1]=L=>r.value=L),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,qe),[[G,r.value]]),e("label",{for:"card-"+l.id,class:"flex-1 cursor-pointer"},[e("div",Oe,[e("img",{src:N(l.brand),alt:l.brand,class:"w-20 h-12 mr-2"},null,8,Re),e("div",null,[e("p",Te,a(A(l.card_no)),1),e("p",Ue,"\u6709\u52B9\u671F\u9650: "+a(B(l.expire)),1),e("p",Ke,"\u540D\u7FA9\u4EBA: "+a(l.holder_name),1)])])],8,Ge)],10,He)):_("",!0)],64))),128))])):(i(),n("div",Qe," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),We,e("button",{onClick:M,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),e("div",Xe,[e("button",{onClick:v,class:"bg-gray-300 text-gray-700 flex-1 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),e("button",{onClick:P,class:D(["bg-theme text-white flex-1 py-2 rounded text-sm",{"opacity-50":!r.value}]),disabled:!r.value}," \u78BA\u8A8D ",10,Ye)])])])]}),_:1}),p(b(z),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:S(()=>[e("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:v})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{it as default};
