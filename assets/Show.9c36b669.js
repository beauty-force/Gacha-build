import{q as g,o as a,c as n,b as x,D as S,w as C,V as P,F as v,H as G,d as e,L as D,e as $,t as r,n as B,f as y,h as b,J as L,a1 as Q,I as w,K as W,a as V,E as T,a6 as X,a7 as Y}from"./app.edf371cb.js";import{A as Z}from"./Admin.93150493.js";import{h as M}from"./useConfirm.a65972a0.js";import{_ as ee}from"./_plugin-vue_export-helper.cdc0426e.js";const i=o=>(X("data-v-353213eb"),o=o(),Y(),o),te={class:"py-3"},se={class:"w-full"},oe={class:"px-4 sm:px-6 py-1"},le=i(()=>e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),ae={class:"bg-white shadow-sm sm:rounded-lg"},ne={class:"p-3 sm:p-6 text-gray-900"},ie={class:"mb-6 pb-6 border-b border-gray-200"},re={class:"flex items-start justify-between mb-4"},de={class:"space-y-1"},ce={class:"text-lg font-bold text-gray-900 mb-2"},ue={class:"flex items-center space-x-4 text-sm text-gray-500 px-2"},ge=i(()=>e("span",null,"\u2022",-1)),he={class:"bg-gray-50 rounded-lg p-4"},me={class:"text-gray-700 whitespace-pre-line mb-4"},pe={key:0,class:"mt-4"},fe={class:"text-sm font-semibold text-gray-700 mb-2"},ve={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},be=["onClick"],_e=["src","alt"],xe=i(()=>e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-opacity flex items-center justify-center pointer-events-none"},[e("svg",{class:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),ye={key:0,class:"space-y-4 mb-6"},we={class:"text-base font-bold text-gray-900 flex items-center border-b pb-2"},ke=i(()=>e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),qe={key:0,class:"flex-1 flex justify-end"},Ce={class:"max-w-[80%] bg-blue-50 border border-blue-200 rounded-lg p-3"},Me={class:"flex items-center gap-2 mb-2"},je=i(()=>e("svg",{class:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),Ie={class:"text-xs font-bold text-blue-700"},Se={class:"text-xs text-gray-500"},Be={class:"text-sm text-gray-800 whitespace-pre-line"},$e={key:0,class:"mt-2 grid grid-cols-3 gap-2"},ze=["src","onClick"],De={key:1,class:"flex-1"},Le={class:"max-w-[80%] bg-gray-100 border border-gray-300 rounded-lg p-3"},Ve={class:"flex items-center gap-2 mb-2"},Te=i(()=>e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),Ee={class:"text-xs font-bold text-gray-700"},Ae={class:"text-xs text-gray-500"},Fe={class:"text-sm text-gray-800 whitespace-pre-line"},Ne={key:0,class:"mt-2 grid grid-cols-3 gap-2"},Oe=["src","onClick"],Re={class:"space-y-4 border-t pt-4 mb-6"},Ue=i(()=>e("h3",{class:"text-base font-bold text-gray-900"},"\u30B9\u30C6\u30FC\u30BF\u30B9\u7BA1\u7406",-1)),He={class:"flex items-end gap-3"},Je={class:"flex-1"},Ke=i(()=>e("label",{for:"status-only",class:"block text-sm font-medium text-gray-700 mb-2"}," \u30B9\u30C6\u30FC\u30BF\u30B9 ",-1)),Pe=i(()=>e("option",{value:"pending"},"\u5BFE\u5FDC\u4E2D",-1)),Ge=i(()=>e("option",{value:"answered"},"\u5B8C\u4E86",-1)),Qe=i(()=>e("option",{value:"closed"},"\u30AF\u30ED\u30FC\u30BA",-1)),We=[Pe,Ge,Qe],Xe=["disabled"],Ye=["onSubmit"],Ze=i(()=>e("h3",{class:"text-base font-bold text-gray-900"},"\u8FD4\u4FE1\u3092\u9001\u4FE1",-1)),et=i(()=>e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[$(" \u753B\u50CF\u3092\u6DFB\u4ED8 "),e("span",{class:"text-gray-500 text-xs font-normal"},"(\u4EFB\u610F\u3001\u6700\u59273\u679A)")],-1)),tt={key:0,class:"mt-2 grid grid-cols-3 gap-2"},st=["src"],ot=["onClick"],lt=i(()=>e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),at=[lt],nt={class:"flex justify-end"},it=["disabled"],rt={class:"flex flex-col items-center justify-center h-screen p-4 gap-2"},dt=i(()=>e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-90 transition-opacity"},null,-1)),ct={class:"relative z-10 flex items-center justify-center gap-4 w-full max-w-6xl flex-shrink-0"},ut=i(()=>e("div",{class:"flex-1"},null,-1)),gt={class:"px-4 py-2 bg-white rounded-full text-gray-900 text-sm font-bold shadow-xl"},ht={class:"flex-1 flex justify-end"},mt=["onClick"],pt=i(()=>e("svg",{class:"w-6 h-6 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M6 18L18 6M6 6l12 12"})],-1)),ft=[pt],vt={class:"relative z-10 flex flex-col items-center w-full max-w-6xl flex-1 min-h-0 gap-2"},bt={class:"flex-1 flex items-center justify-center min-h-0 w-full"},_t=["src"],xt={class:"flex items-center justify-center gap-3 flex-shrink-0"},yt=["onClick","disabled"],wt=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M15 19l-7-7 7-7"})],-1)),kt=[wt],qt=["onClick","disabled"],Ct=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M9 5l7 7-7 7"})],-1)),Mt=[Ct],jt={__name:"Show",props:{question:Object},setup(o){const u=o,p=g(null),d=g(0),f=g(""),h=g([]),E=g(null),k=g(!1),_=g(u.question.status),q=g(!1),j=s=>{const l=[...u.question.images||[],...u.question.replies.flatMap(t=>t.images||[])];p.value=s,d.value=l.indexOf(s)},A=()=>{const s=[...u.question.images||[],...u.question.replies.flatMap(l=>l.images||[])];d.value<s.length-1&&(d.value++,p.value=s[d.value])},F=()=>{if(d.value>0){const s=[...u.question.images||[],...u.question.replies.flatMap(l=>l.images||[])];d.value--,p.value=s[d.value]}},z=()=>{p.value=null},N=s=>{const l=Array.from(s.target.files);if(h.value.length+l.length>3){alert("\u753B\u50CF\u306F\u6700\u59273\u679A\u307E\u3067\u3067\u3059");return}l.forEach(t=>{const c=new FileReader;c.onload=m=>{h.value.push({file:t,preview:m.target.result})},c.readAsDataURL(t)}),s.target.value=""},O=s=>{h.value.splice(s,1)},R=()=>{let s=(u.question.images||[]).length;return u.question.replies&&u.question.replies.forEach(l=>{s+=(l.images||[]).length}),s},U=async()=>{if(_.value!==u.question.status){q.value=!0;try{await V.post(route("admin.support-questions.update-status",u.question.id),{status:_.value,admin_response:""}),await M.fire({icon:"success",title:"\u30B9\u30C6\u30FC\u30BF\u30B9\u66F4\u65B0\u5B8C\u4E86",text:"\u30B9\u30C6\u30FC\u30BF\u30B9\u3092\u66F4\u65B0\u3057\u307E\u3057\u305F",confirmButtonColor:"#3b82f6"}),T.Inertia.reload()}catch{await M.fire({icon:"error",title:"\u30A8\u30E9\u30FC",text:"\u30B9\u30C6\u30FC\u30BF\u30B9\u306E\u66F4\u65B0\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}finally{q.value=!1}}},H=async()=>{if(!f.value.trim())return;k.value=!0;const s=new FormData;s.append("message",f.value),h.value.forEach((l,t)=>{s.append(`images[${t}]`,l.file)});try{await V.post(route("admin.support-questions.reply",u.question.id),s,{headers:{"Content-Type":"multipart/form-data"}}),await M.fire({icon:"success",title:"\u9001\u4FE1\u5B8C\u4E86",text:"\u8FD4\u4FE1\u3092\u9001\u4FE1\u3057\u307E\u3057\u305F",confirmButtonColor:"#3b82f6"}),f.value="",h.value=[],T.Inertia.reload()}catch{await M.fire({icon:"error",title:"\u30A8\u30E9\u30FC",text:"\u9001\u4FE1\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}finally{k.value=!1}},J=s=>({pending:"\u5BFE\u5FDC\u4E2D",answered:"\u5B8C\u4E86",closed:"\u30AF\u30ED\u30FC\u30BA"})[s]||s,I=s=>new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(s,l)=>(a(),n(v,null,[x(S(G),{title:"\u30B5\u30DD\u30FC\u30C8\u8CEA\u554F\u8A73\u7D30"}),x(Z,null,{default:C(()=>[e("div",te,[e("div",se,[e("div",oe,[x(S(D),{href:s.route("admin.support-questions.index"),class:"inline-flex items-center text-gray-600 hover:text-yellow-600 font-semibold"},{default:C(()=>[le,$(" \u8CEA\u554F\u4E00\u89A7\u306B\u623B\u308B ")]),_:1},8,["href"])]),e("div",ae,[e("div",ne,[e("div",ie,[e("div",re,[e("div",de,[e("h3",ce,r(o.question.subject),1),e("div",ue,[e("span",null,r(I(o.question.created_at)),1),ge,x(S(D),{href:s.route("admin.users.detail",o.question.user_id),class:"text-blue-600 hover:text-blue-800 underline"},{default:C(()=>[e("span",null,r(o.question.name)+" ("+r(o.question.email)+")",1)]),_:1},8,["href"])])]),e("span",{class:B({"my-1 px-3 py-1 text-xs font-semibold rounded-full text-nowrap":!0,"bg-yellow-100 text-yellow-800":o.question.status==="pending","bg-green-100 text-green-800":o.question.status==="answered","bg-gray-100 text-gray-800":o.question.status==="closed"})},r(J(o.question.status)),3)]),e("div",he,[e("p",me,r(o.question.question),1),o.question.images&&o.question.images.length>0?(a(),n("div",pe,[e("h4",fe,"\u6DFB\u4ED8\u753B\u50CF ("+r(o.question.images.length)+")",1),e("div",ve,[(a(!0),n(v,null,y(o.question.images,(t,c)=>(a(),n("div",{key:c,class:"relative group bg-white rounded-lg overflow-hidden border border-gray-200 hover:border-yellow-400 transition-all cursor-pointer",onClick:m=>j(t)},[e("img",{src:`/images/support_questions/${t}`,alt:`\u6DFB\u4ED8\u753B\u50CF ${c+1}`,class:"w-full h-full object-contain"},null,8,_e),xe],8,be))),128))])])):b("",!0)])]),o.question.replies&&o.question.replies.length>0?(a(),n("div",ye,[e("h3",we,[ke,$(" \u4F1A\u8A71\u5C65\u6B74 ("+r(o.question.replies.length)+") ",1)]),(a(!0),n(v,null,y(o.question.replies,t=>(a(),n("div",{key:t.id,class:"flex gap-3"},[t.is_admin?(a(),n("div",qe,[e("div",Ce,[e("div",Me,[je,e("span",Ie,"\u30B5\u30DD\u30FC\u30C8 ("+r(t.user.name)+")",1),e("span",Se,r(I(t.created_at)),1)]),e("p",Be,r(t.message),1),t.images&&t.images.length>0?(a(),n("div",$e,[(a(!0),n(v,null,y(t.images,(c,m)=>(a(),n("img",{key:m,src:`/images/support_questions/${c}`,class:"w-full h-20 object-cover rounded cursor-pointer",onClick:K=>j(c)},null,8,ze))),128))])):b("",!0)])])):(a(),n("div",De,[e("div",Le,[e("div",Ve,[Te,e("span",Ee,r(t.user.name),1),e("span",Ae,r(I(t.created_at)),1)]),e("p",Fe,r(t.message),1),t.images&&t.images.length>0?(a(),n("div",Ne,[(a(!0),n(v,null,y(t.images,(c,m)=>(a(),n("img",{key:m,src:`/images/support_questions/${c}`,class:"w-full h-20 object-cover rounded cursor-pointer",onClick:K=>j(c)},null,8,Oe))),128))])):b("",!0)])]))]))),128))])):b("",!0),e("div",Re,[Ue,e("div",He,[e("div",Je,[Ke,L(e("select",{id:"status-only","onUpdate:modelValue":l[0]||(l[0]=t=>_.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400"},We,512),[[Q,_.value]])]),e("button",{onClick:U,disabled:q.value||_.value===o.question.status,class:"px-6 py-2 bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},r(q.value?"\u66F4\u65B0\u4E2D...":"\u30B9\u30C6\u30FC\u30BF\u30B9\u66F4\u65B0"),9,Xe)])]),e("form",{onSubmit:w(H,["prevent"]),class:"space-y-4 border-t pt-4"},[Ze,e("div",null,[L(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=t=>f.value=t),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"\u8FD4\u4FE1\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044...",required:""},null,512),[[W,f.value]])]),e("div",null,[et,e("input",{type:"file",ref_key:"imageInput",ref:E,accept:"image/*",multiple:"",onChange:N,class:"hidden"},null,544),e("button",{type:"button",onClick:l[2]||(l[2]=t=>s.$refs.imageInput.click()),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50"}," \u753B\u50CF\u3092\u9078\u629E "),h.value.length>0?(a(),n("div",tt,[(a(!0),n(v,null,y(h.value,(t,c)=>(a(),n("div",{key:c,class:"relative"},[e("img",{src:t.preview,class:"w-full h-20 object-cover rounded"},null,8,st),e("button",{type:"button",onClick:m=>O(c),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1"},at,8,ot)]))),128))])):b("",!0)]),e("div",nt,[e("button",{type:"submit",disabled:k.value||!f.value.trim(),class:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50"},r(k.value?"\u9001\u4FE1\u4E2D...":"\u8FD4\u4FE1\u3059\u308B"),9,it)])],40,Ye)])])])])]),_:1}),x(P,{name:"modal"},{default:C(()=>[p.value?(a(),n("div",{key:0,class:"fixed inset-0 z-[9999]",onClick:z},[e("div",rt,[dt,e("div",ct,[ut,e("div",gt,r(d.value+1)+" / "+r(R()),1),e("div",ht,[e("button",{onClick:w(z,["stop"]),class:"p-3 bg-white rounded-full hover:bg-gray-100 transition-colors shadow-xl",type:"button",title:"\u9589\u3058\u308B"},ft,8,mt)])]),e("div",vt,[e("div",bt,[e("img",{src:`/images/support_questions/${p.value}`,alt:"\u62E1\u5927\u753B\u50CF",class:"max-w-full max-h-full w-auto h-auto object-contain rounded-lg shadow-2xl border-4 border-white",onClick:l[3]||(l[3]=w(()=>{},["stop"]))},null,8,_t)]),e("div",xt,[e("button",{onClick:w(F,["stop"]),disabled:d.value===0,class:B({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value>0,"bg-gray-300 cursor-not-allowed opacity-50":d.value===0}),type:"button",title:"\u524D\u3078"},kt,10,yt),e("button",{onClick:w(A,["stop"]),disabled:d.value>=o.question.images.length-1,class:B({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value<o.question.images.length-1,"bg-gray-300 cursor-not-allowed opacity-50":d.value>=o.question.images.length-1}),type:"button",title:"\u6B21\u3078"},Mt,10,qt)])])])])):b("",!0)]),_:1})],64))}},zt=ee(jt,[["__scopeId","data-v-353213eb"]]);export{zt as default};
