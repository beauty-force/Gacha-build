import{o as i,c as n,d as e,t as a,h,G as $,q as y,i as E,w,b as p,D as f,H,F as b,f as S,I as j,n as D,e as F,J as q,aa as G,a as O}from"./app.20b0bdc3.js";import{A as R}from"./UserLayout.7fdcf664.js";import{o as A,f as T,u as U}from"./useConfirm.4146c09f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.5eeab2b0.js";const K={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Q={class:"flex flex-col items-center"},W=e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-theme"},null,-1),X={class:"mt-2 text-white text-sm"},Y={__name:"Loading",props:{show:{type:Boolean,default:!1},message:{type:String,default:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."}},setup(t){return(x,g)=>t.show?(i(),n("div",K,[e("div",Q,[W,e("p",X,a(t.message),1)])])):h("",!0)}},Z={class:"py-4 px-4 md:px-8"},ee={class:"bg-white overflow-hidden"},te={class:"bg-white border-gray-200"},se={key:0,class:"text-lg font-semibold mb-6"},oe={key:1,class:"mb-8 p-6 bg-blue-50 rounded-lg"},ie={class:"flex flex-wrap justify-between md:grid md:grid-cols-3 gap-4"},ne=e("p",{class:"text-sm text-blue-600"},"\u30D7\u30E9\u30F3\u540D",-1),ae={class:"font-medium"},le=e("p",{class:"text-sm text-blue-600"},"\u958B\u59CB\u65E5",-1),re={class:"font-medium"},ce=e("p",{class:"text-sm text-blue-600"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),de={class:"font-medium"},ue={class:"flex flex-wrap items-end justify-between mt-3"},me={key:0,class:"flex items-center py-2"},fe={class:"flex items-center gap-1"},be=["src","alt"],he={class:"font-medium"},ve={class:"text-sm text-gray-500"},_e={class:"text-xs text-gray-500"},pe=["disabled"],xe=e("h3",{class:"text-lg font-semibold mb-6"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),ge={class:"space-y-4"},ye=["src"],we={class:"flex-1 flex flex-col md:flex-row md:justify-between md:items-center gap-3"},Se={class:"space-y-1"},ke={class:"text-xl font-bold leading-8"},Ce=e("span",{class:"text-sm font-normal"},"/\u6708",-1),$e={class:"text-green-600 text-sm"},je={class:"text-rose-500 text-sm leading-7 font-bold"},De=["onSubmit"],Fe=["disabled"],Ne={class:"my-6 space-y-6"},Be=["src"],Le={class:"py-3 px-1 text-center"},ze={class:"font-bold text-lg"},Ae={class:"text-lg font-bold text-theme mt-1"},Ve=e("span",{class:"text-sm font-normal"},"/\u6708",-1),Ie={class:"p-2"},Me={key:0,class:"text-sm text-gray-500 mb-2"},Je={key:1,class:"space-y-2"},Pe=["onClick"],Ee=["id","value"],He=["for"],qe={class:"flex items-center"},Ge=["src","alt"],Oe={class:"font-medium"},Re={class:"text-sm text-gray-500"},Te={class:"text-xs text-gray-500"},Ue={key:2,class:"text-gray-500 mb-2"},Ke=e("hr",{class:"my-1"},null,-1),Qe={class:"flex justify-between p-2 gap-2"},We=["disabled"],st={__name:"Index",props:{plans:Array,currentSubscription:Object,cards:Array,images:Array},setup(t){const x=t,{confirm:g}=U(),k=$({}),C=y(!1),r=y(""),d=y(null),c=y(!1),v=s=>new Intl.NumberFormat("ja-JP").format(s),V=s=>new Date(s).toLocaleDateString("ja-JP"),N=s=>`/images/credit_cards/${s.toLowerCase()}.svg`,B=s=>s.replace(/(.{4})/g,"$1 ").trim(),L=s=>`${s.slice(0,2)}/${s.slice(2)}`,I=()=>{g("\u89E3\u7D04\u3057\u307E\u3059\u304B\uFF1F","\u89E3\u7D04\u5F8C\u30011\u30F6\u6708\u9593\u767B\u9332\u306F\u3067\u304D\u307E\u305B\u3093\u3002").then(s=>{s&&(c.value=!0,k.post(route("user.subscription.cancel",x.currentSubscription.id),{onFinish:()=>{c.value=!1}}))})},M=()=>{c.value=!0,O.get(route("user.point.card_register",{type:"subscription"})).then(s=>{c.value=!1,s.data.status==1&&(window.location.href=s.data.link_url)}).catch(()=>{c.value=!1})},J=s=>{d.value=s,C.value=!0},_=()=>{C.value=!1,r.value="",d.value=null},P=()=>{d.value&&r.value&&(x.currentSubscription?g("\u30D7\u30E9\u30F3\u3092\u5909\u66F4\u3057\u307E\u3059\u304B\uFF1F",'<div class="text-start space-y-2"><div>\u2022\u3000\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u306E\u5834\u5408\u3001\u73FE\u5728\u306E\u30D7\u30E9\u30F3\u3068\u306E\u5DEE\u984D\u304C\u3059\u3050\u306B\u8ACB\u6C42\u3055\u308C\u3001\u8ACB\u6C42\u65E5\u3082\u672C\u65E5\u306B\u66F4\u65B0\u3055\u308C\u307E\u3059\u3002</div><div>\u2022\u3000\u30C0\u30A6\u30F3\u30B0\u30EC\u30FC\u30C9\u307E\u305F\u306F\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u5909\u66F4\u3059\u308B\u5834\u5408\u3001\u8ACB\u6C42\u65E5\u306F\u5909\u308F\u3089\u305A\u3001\u6B21\u56DE\u306E\u8ACB\u6C42\u6642\u306B\u65B0\u3057\u3044\u30D7\u30E9\u30F3\u306E\u6599\u91D1\u304C\u9069\u7528\u3055\u308C\u307E\u3059\u3002</div></div>').then(s=>{s&&(c.value=!0,$({plan_id:d.value.id,card_id:r.value}).post(route("user.subscription.update",x.currentSubscription.id),{onFinish:()=>{c.value=!1,_()},preserveScroll:!0}))}):g("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u306B\u767B\u9332\u3057\u307E\u3059\u304B\uFF1F").then(s=>{s&&(c.value=!0,$({card_id:r.value}).post(route("user.subscription.subscribe",d.value.id),{onFinish:()=>{c.value=!1,_()},preserveScroll:!0}))}))};return(s,m)=>(i(),E(R,null,{default:w(()=>[p(f(H),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),p(Y,{show:c.value,message:"\u51E6\u7406\u4E2D..."},null,8,["show","message"]),e("div",Z,[e("div",ee,[e("div",te,[t.currentSubscription?(i(),n("h3",se,"\u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3")):h("",!0),t.currentSubscription?(i(),n("div",oe,[e("div",ie,[e("div",null,[ne,e("p",ae,a(t.currentSubscription.plan.name),1)]),e("div",null,[le,e("p",re,a(V(t.currentSubscription.start_date)),1)]),e("div",null,[ce,e("p",de,a(v(t.currentSubscription.plan.point))+" pt",1)])]),e("div",ue,[(i(!0),n(b,null,S(t.cards,o=>(i(),n(b,null,[t.currentSubscription.card_id===o.id?(i(),n("div",me,[e("div",fe,[e("img",{src:N(o.brand),alt:o.brand,class:"w-20 h-12 mr-2"},null,8,be),e("div",null,[e("p",he,a(B(o.card_no)),1),e("p",ve,"\u6709\u52B9\u671F\u9650: "+a(L(o.expire)),1),e("p",_e,"\u540D\u7FA9\u4EBA: "+a(o.holder_name),1)])])])):h("",!0)],64))),256)),e("form",{onSubmit:m[0]||(m[0]=j(o=>I(),["prevent"])),class:"mt-4"},[e("button",{type:"submit",class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm",disabled:f(k).processing}," \u89E3\u7D04 ",8,pe)],32)])])):h("",!0),xe,e("div",ge,[(i(!0),n(b,null,S(t.plans,o=>{var u;return i(),n("div",{key:o.id,class:D(["border rounded-lg p-3 md:p-4 flex justify-between items-center gap-4 hover:bg-gray-50",{"bg-yellow-50 border-yellow-500 border-2":((u=t.currentSubscription)==null?void 0:u.plan_id)===o.id}])},[e("img",{src:o.image,class:"md:flex-1 w-40 md:max-w-48 object-contain"},null,8,ye),e("div",we,[e("div",Se,[e("p",ke,[F("\xA5"+a(v(o.amount)),1),Ce]),e("p",$e,[e("strong",null,a(v(o.point)),1),F(" \u30DD\u30A4\u30F3\u30C8\u4ED8\u4E0E")]),e("p",je,a(v(o.point-o.amount))+" pt\u304A\u5F97!!",1)]),e("div",null,[e("form",{onSubmit:j(l=>J(o),["prevent"])},[e("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-3 rounded text-xs md:text-sm",disabled:f(k).processing},a(t.currentSubscription?t.currentSubscription.plan_id!=o.id?"\u30D7\u30E9\u30F3\u5909\u66F4":"\u30AB\u30FC\u30C9\u5909\u66F4":"\u30B5\u30D6\u30B9\u30AF\u30E9\u30A4\u30D6"),9,Fe)],40,De)])])],2)}),128))]),e("div",Ne,[(i(!0),n(b,null,S(t.images,(o,u)=>(i(),n("img",{key:u,src:o,class:"w-full"},null,8,Be))),128))])])])]),p(f(T),{show:C.value,class:""},{default:w(()=>[p(f(A),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:w(()=>{var o,u;return[e("div",{class:"fixed inset-0 z-40",onClick:_},[e("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:m[2]||(m[2]=j(()=>{},["stop"]))},[e("div",Le,[e("div",ze,a((o=d.value)==null?void 0:o.name),1),e("div",Ae,[F("\xA5 "+a(v((u=d.value)==null?void 0:u.amount)),1),Ve])]),e("div",Ie,[t.cards.length>0?(i(),n("div",Me,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):h("",!0),t.cards.length>0?(i(),n("div",Je,[(i(!0),n(b,null,S(t.cards,l=>(i(),n(b,{key:l.id},[!t.currentSubscription||d.value&&d.value.id!=t.currentSubscription.plan_id||l.id!=t.currentSubscription.card_id?(i(),n("div",{key:0,class:D([{"border-yellow-500 bg-yellow-50 border-2":r.value===l.id,"hover:bg-gray-50 hover:border-gray-300":r.value!==l.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:z=>r.value=l.id},[q(e("input",{type:"radio",id:"card-"+l.id,value:l.id,"onUpdate:modelValue":m[1]||(m[1]=z=>r.value=z),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,Ee),[[G,r.value]]),e("label",{for:"card-"+l.id,class:"flex-1 cursor-pointer"},[e("div",qe,[e("img",{src:N(l.brand),alt:l.brand,class:"w-20 h-12 mr-2"},null,8,Ge),e("div",null,[e("p",Oe,a(B(l.card_no)),1),e("p",Re,"\u6709\u52B9\u671F\u9650: "+a(L(l.expire)),1),e("p",Te,"\u540D\u7FA9\u4EBA: "+a(l.holder_name),1)])])],8,He)],10,Pe)):h("",!0)],64))),128))])):(i(),n("div",Ue," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),Ke,e("button",{onClick:M,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),e("div",Qe,[e("button",{onClick:_,class:"bg-gray-300 text-gray-700 flex-1 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),e("button",{onClick:P,class:D(["bg-theme text-white flex-1 py-2 rounded text-sm",{"opacity-50":!r.value}]),disabled:!r.value}," \u78BA\u8A8D ",10,We)])])])]}),_:1}),p(f(A),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:w(()=>[e("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:_})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{st as default};
