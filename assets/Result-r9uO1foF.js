import{d as b,r as p,c as a,o as d,a as k,w as _,b as e,i as h,n as m,e as c,t as g,F as w,f as C,j as S,m as P}from"./app-DsZT8ZFb.js";import{A as j}from"./Admin-DmD77vfe.js";import{u as L}from"./useConfirm-IV4jvDvB.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as V}from"./PlayIcon-RB-dxF5E.js";const{confirm:x,alert:v}=L(),A={components:{Head:b.Head,AppLayout:j,Link:b.Link,PlayIcon:V},props:{errors:Object,auth:Object,category_share:Object,products:Object,token:String,show_review:Boolean,rank:Object,delivery_limit:Number},data(){return{isCheckAll:!1,showRankDialog:!1,isClosing:!1,isListView:!1,coinSortOrder:localStorage.getItem("gacha-result-coin-sort")||"asc"}},computed:{sortedProducts(){let s=[...this.products.data];const t=s.filter(n=>n.rare==="ã‚¢ã‚¤ãƒ†ãƒ "),i=s.filter(n=>n.rare!=="ã‚¢ã‚¤ãƒ†ãƒ ");return this.coinSortOrder!=="none"&&i.sort((n,r)=>{const l=parseInt(n.point)||0,f=parseInt(r.point)||0;return this.coinSortOrder==="asc"?l-f:f-l}),[...t,...i]},selectedPoints(){let s=0;for(let t=0;t<this.sortedProducts.length;t++)this.form.checks["id"+this.sortedProducts[t].id]&&(s+=parseInt(this.sortedProducts[t].point));return s},selectedCount(){let s=0;for(let t=0;t<this.sortedProducts.length;t++)this.form.checks["id"+this.sortedProducts[t].id]&&s++;return s}},mounted(){this.rank&&(this.showRankDialog=!0)},setup(s){let t={},i;for(i=0;i<s.products.data.length;i++)t["id"+s.products.data[i].id]=!1;return{form:b.useForm({checks:t,token:s.token})}},methods:{closeRankDialog(){this.isClosing=!0,setTimeout(()=>{this.showRankDialog=!1,this.isClosing=!1},300)},format_number(s){return String(s).replace(/(.)(?=(\d{3})+$)/g,"$1,")},submit(){let s,t=0;var i=0;for(s=0;s<this.sortedProducts.length;s++)this.form.checks["id"+this.sortedProducts[s].id]&&(t++,i=i+parseInt(this.sortedProducts[s].point));if(i>0){let n="<p>é¸æŠã—ãŸ"+t+"ç‚¹ã®å•†å“ã‚’"+i+'ptã¨äº¤æ›ã—ã¾ã™ã€‚</p><div class="bg-gray-50 rounded-lg p-4 flex items-center justify-center mt-4"><div class="flex items-center space-x-2"><img src="/images/icon_cash.png" class="w-6 h-6" alt="coin icon" /><span class="text-base font-bold text-gray-900">'+this.auth.user.point.toLocaleString()+'</span></div><div class="mx-4 text-xl text-gray-400">></div><div class="flex items-center space-x-2"><img src="/images/icon_cash.png" class="w-6 h-6" alt="coin icon" /><span class="text-base font-bold text-green-600">'+(this.auth.user.point+i).toLocaleString()+"</span></div></div>";x("ãƒã‚¤ãƒ³ãƒˆäº¤æ›",n,"","ãƒã‚¤ãƒ³ãƒˆã«äº¤æ›ã™ã‚‹","ã‚­ãƒ£ãƒ³ã‚»ãƒ«").then(r=>{r&&this.form.post(route("user.gacha.result.exchange"),{onFinish:()=>{}})})}else x("ãƒã‚¤ãƒ³ãƒˆäº¤æ›","å…¨ã¦ã®å•†å“ãŒã€Œç²å¾—æ¸ˆã¿å•†å“ä¸€è¦§ã€ã«ç§»å‹•ã—ã¾ã™ã€‚","").then(r=>{r&&this.form.post(route("user.gacha.result.exchange"),{onFinish:()=>{}})})},delivery(){let s,t=0;var i=0;let n=0;for(s=0;s<this.sortedProducts.length;s++)this.form.checks["id"+this.sortedProducts[s].id]&&(t++,i=i+parseInt(this.sortedProducts[s].point),this.sortedProducts[s].rare=="ãƒã‚¤ãƒ³ãƒˆ"&&n++);if(n>0){v("ãƒã‚¤ãƒ³ãƒˆã¯ç™ºé€ã§ãã¾ã›ã‚“");return}let r="";if(t>0){if(r="é¸æŠã—ãŸ"+t+"ç‚¹ã®å•†å“ã‚’ç™ºé€ä¾é ¼ã—ã¾ã™ã€‚",i<this.delivery_limit){v("ç™ºé€ä¾é ¼ãŒã§ãã‚‹æœ€ä½ãƒã‚¤ãƒ³ãƒˆã¯"+this.format_number(this.delivery_limit)+"ptã§ã™ã€‚");return}}else r="å…¨ã¦ã®å•†å“ãŒã€Œç²å¾—æ¸ˆã¿å•†å“ä¸€è¦§ã€ã«ç§»å‹•ã—ã¾ã™ã€‚";x(r).then(l=>{l&&this.form.post(route("user.gacha.result.delivery"),{onFinish:()=>{}})})},checkall(){let s;for(s=0;s<this.products.data.length;s++)this.form.checks["id"+this.products.data[s].id]=this.isCheckAll&&this.products.data[s].status!=3&&this.products.data[s].rare!="ã‚¢ã‚¤ãƒ†ãƒ "},checkone(){this.isCheckAll=this.sortedProducts.length>0,this.sortedProducts.forEach(s=>{this.form.checks["id"+s.id]!=!0&&(this.isCheckAll=!1)})},toggleSelectAll(){this.isCheckAll=!this.isCheckAll,this.checkall()},toggleListView(){this.isListView=!this.isListView,localStorage.setItem("gacha-result-list-view",this.isListView)},toggleCoinSort(){this.coinSortOrder==="asc"?this.coinSortOrder="desc":this.coinSortOrder="asc",localStorage.setItem("gacha-result-coin-sort",this.coinSortOrder)}}},I={class:"h-full flex flex-col justify-start"},M={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},D={class:"flex items-center justify-center min-h-screen pt-4 px-4 text-center sm:block sm:p-0"},R={class:"bg-gradient-to-r from-amber-500 to-amber-600 px-4 pt-6 pb-4 text-white"},B={class:"text-center"},z={class:"inline-block"},F=["src"],N={class:"bg-white"},E={class:"text-center"},H={class:"text-left text-gray-800 space-y-3 text-sm md:text-base bg-amber-50 p-4"},T={class:"flex items-center gap-2"},U={class:"text-amber-700"},q={class:"flex items-center gap-2"},G={class:"text-amber-700"},J={class:"flex items-center gap-2"},K={class:"text-amber-700"},Q={class:"bg-white px-4 py-4 sm:px-6 sm:flex sm:flex-row-reverse justify-center border-t-2 border-amber-200"},W={class:"sticky top-0 z-30 bg-gradient-to-r from-amber-400 via-amber-500 to-amber-400 shadow-lg"},X={class:"mx-auto flex justify-between items-center py-3 px-4"},Y=["href"],Z={class:"m-auto px-2 py-2 flex-1 w-full"},$=["href"],tt={class:"px-3 md:px-4 py-2 flex gap-2 items-center sticky top-20 z-10"},et={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},st={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},ot=["for"],it=["src"],rt=["src","alt"],nt={class:"flex-1 p-3 flex flex-col justify-around items-start"},lt=["id","onUpdate:modelValue"],at=["src"],dt={class:"text-gray-800 text-base font-bold line-clamp-2"},ct={class:"inline-block px-2 py-0.5 bg-amber-100 text-amber-800 text-xs font-bold rounded-full"},mt={key:2,class:"flex items-center gap-1"},ht={class:"text-sm font-bold text-amber-700"},gt={key:3,class:"text-xs text-rose-600 font-semibold rounded-full"},ft={class:"sticky bottom-0 z-30 w-full bg-white border-t border-gray-200 shadow-lg"},ut={class:"mx-auto px-4 py-2"},bt={class:"flex items-center justify-between mb-2"},xt={class:"flex items-center gap-1 text-gray-700 text-base"},pt={class:"font-semibold"},kt={class:"flex gap-2"},wt=["disabled"],vt=["disabled"];function yt(s,t,i,n,r,l){const f=p("Head"),y=p("AppLayout");return d(),a(w,null,[k(f,{title:"ã‚¬ãƒãƒ£â€“çµæœ"}),k(y,{hide_header:!0},{default:_(()=>[e("div",I,[r.showRankDialog?(d(),a("div",M,[e("div",D,[e("div",{class:m(["fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",{"animate-[fadeIn_0.3s_ease-out]":!r.isClosing,"animate-[fadeOut_0.3s_ease-out]":r.isClosing}]),"aria-hidden":"true"},null,2),t[20]||(t[20]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),e("div",{class:m(["inline-block align-bottom bg-gradient-to-br from-amber-50 via-white to-amber-50 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full border-4 border-amber-400",{"animate-[bounceIn_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":!r.isClosing,"animate-[bounceOut_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":r.isClosing}])},[e("div",R,[e("div",B,[t[6]||(t[6]=e("h3",{class:"text-lg leading-6 font-bold mb-2 flex items-center justify-center gap-2"},[e("span",{class:"text-xl"},"ğŸ‰"),c("ä¼šå“¡ãƒ©ãƒ³ã‚¯å¤‰æ›´ã®ãŠçŸ¥ã‚‰ã›ï¼"),e("span",{class:"text-xl"},"ğŸ‰")],-1)),t[7]||(t[7]=e("p",{class:"text-amber-50 mb-4 text-base"},"ã‚ãªãŸã®ãƒ©ãƒ³ã‚¯ãŒã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸğŸ‘âœ¨",-1)),e("div",z,[e("img",{src:i.rank.badge,alt:"Rank Image",class:"w-full max-w-80 h-32"},null,8,F)])])]),e("div",N,[e("div",E,[e("div",H,[t[17]||(t[17]=e("p",{class:"font-bold text-lg mb-3 text-amber-700"},"ğŸ“¦ç¾åœ¨å—ã‘ã‚‰ã‚Œã‚‹ç‰¹å…¸ä¸€è¦§ğŸ“¦",-1)),e("p",T,[t[10]||(t[10]=c("ğŸ”¹ ",-1)),e("span",null,[t[8]||(t[8]=c("ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ãƒœãƒ¼ãƒŠã‚¹ï¼š",-1)),e("strong",U,g(i.rank.bonus.toLocaleString())+"PT",1),t[9]||(t[9]=c("ä»˜ä¸ï¼",-1))])]),e("p",q,[t[13]||(t[13]=c("ğŸ”¹ ",-1)),e("span",null,[t[11]||(t[11]=c("è³¼å…¥é‡‘é¡ã«å¿œã˜ã¦ï¼š",-1)),e("strong",G,g(i.rank.pt_rate)+"%",1),t[12]||(t[12]=c("ã®ãƒœãƒ¼ãƒŠã‚¹ãƒã‚¤ãƒ³ãƒˆé‚„å…ƒï¼",-1))])]),e("p",J,[t[16]||(t[16]=c("ğŸ”¹ ",-1)),e("span",null,[t[14]||(t[14]=c("EPé‚„å…ƒç‡ï¼š",-1)),e("strong",K,g(i.rank.dp_rate)+"%",1),t[15]||(t[15]=c("ï¼ˆé€šå¸¸ã‚ˆã‚ŠãŠå¾—ã«è²¯ã¾ã‚‹ï¼ï¼‰",-1))])]),t[18]||(t[18]=e("p",{class:"flex items-center gap-2"},[c("ğŸ”¹ "),e("span",null,"ãƒ©ãƒ³ã‚¯é™å®šï¼šç‰¹åˆ¥ã‚¬ãƒãƒ£ãŒè§£æ”¾ã•ã‚Œã¾ã—ãŸï¼")],-1))]),t[19]||(t[19]=e("p",{class:"text-gray-600 my-4 font-semibold"},"ğŸ’¡ç‰¹å…¸ã‚’æ´»ã‹ã—ã¦ã€ã•ã‚‰ã«ãŠå¾—ã«ã‚¤ãƒ–ã‚¬ãƒãƒ£ã‚’æ¥½ã—ã‚‚ã†ï¼",-1))])]),e("div",Q,[e("button",{type:"button",onClick:t[0]||(t[0]=(...o)=>l.closeRankDialog&&l.closeRankDialog(...o)),class:"w-full inline-flex justify-center rounded-lg border-2 border-amber-500 bg-gradient-to-r from-amber-500 to-amber-600 shadow-lg px-6 py-3 text-base font-semibold text-white hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 sm:ml-3 sm:w-auto transition-all"}," é–‰ã˜ã‚‹ ")])],2)])])):h("",!0),e("div",W,[e("div",X,[t[21]||(t[21]=e("h1",{class:"text-white text-lg font-bold text-center"}," ã‚¬ãƒãƒ£çµæœ ",-1)),e("a",{class:"px-4 py-2 bg-white text-amber-600 rounded-lg font-semibold hover:bg-amber-50 transition-colors shadow-md",href:s.route("user.gacha.end",{token:i.token})}," ã‚¹ã‚­ãƒƒãƒ— ",8,Y)])]),e("div",Z,[i.show_review?(d(),a("a",{key:0,class:"w-full px-3 md:px-6",href:s.route("user.gacha.video",{token:i.token})},[...t[22]||(t[22]=[e("div",{class:"bg-theme bg-theme-hover px-3 py-2 rounded-md text-center text-white"},[e("img",{src:"/images/video_review.png",class:"w-full",alt:"ã‚¬ãƒãƒ£æ¼”å‡ºã‚’ã‚‚ã†ä¸€åº¦è¦‹ã‚‹"})],-1)])],8,$)):h("",!0),e("div",tt,[e("button",{onClick:t[1]||(t[1]=(...o)=>l.toggleCoinSort&&l.toggleCoinSort(...o)),class:m([{"bg-amber-500 text-white":r.coinSortOrder!=="none","bg-white text-gray-700 border border-gray-300":r.coinSortOrder==="none"},"px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1"])},[r.coinSortOrder==="asc"?(d(),a("svg",et,[...t[23]||(t[23]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12.75"},null,-1)])])):r.coinSortOrder==="desc"?(d(),a("svg",st,[...t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4.5h14.25M3 9h9.75M3 13.5h9.75m4.5-4.5v12.75m0 0l-3.75-3.75M17.25 21L21 17.25m0 0h-12.75m12.75 0v-12.75"},null,-1)])])):h("",!0),c(" "+g(r.coinSortOrder==="asc"?"ã‚³ã‚¤ãƒ³ãŒä½ã„é †":r.coinSortOrder==="desc"?"ã‚³ã‚¤ãƒ³ãŒé«˜ã„é †":"â†‘â†“ã‚³ã‚¤ãƒ³ãŒä½ã„é †"),1)],2)]),e("div",null,[e("div",{class:m(r.isListView?"p-3 md:p-4 flex flex-col gap-2 md:gap-3":"p-3 md:p-4 grid grid-cols-1 sm:grid-cols-2 gap-2 md:gap-3")},[(d(!0),a(w,null,C(l.sortedProducts,(o,_t)=>(d(),a("div",{class:m(["relative border-2 rounded-lg overflow-hidden shadow-md transition-all hover:shadow-xl",{"border-amber-500 shadow-amber-200 bg-amber-50":n.form.checks["id"+o.id],"bg-white border-gray-200":!n.form.checks["id"+o.id]}])},[e("label",{for:"checkbox"+o.id,class:m(["flex cursor-pointer",r.isListView?"flex-row":""])},[e("div",{class:m(["relative flex-shrink-0 bg-gradient-to-br from-amber-50 to-yellow-50 flex justify-center items-center",r.isListView?"h-24 w-20":"h-44 w-36"])},[e("img",{class:"max-h-full max-w-full object-contain p-1.5",src:o.image},null,8,it),o.badge?(d(),a("img",{key:0,src:o.badge,class:"absolute bottom-2 right-2 w-[30%] drop-shadow-lg",alt:o.badge},null,8,rt)):h("",!0)],2),e("div",nt,[o.status==1&&o.rare!="ã‚¢ã‚¤ãƒ†ãƒ "?S((d(),a("input",{key:0,id:"checkbox"+o.id,type:"checkbox","onUpdate:modelValue":u=>n.form.checks["id"+o.id]=u,onChange:t[2]||(t[2]=(...u)=>l.checkone&&l.checkone(...u)),class:"hidden"},null,40,lt)),[[P,n.form.checks["id"+o.id]]]):h("",!0),o.rank>0?(d(),a("img",{key:1,src:`/images/no${o.rank}.png`,class:m(["object-contain",{"w-full max-w-40":o.rank==1,"w-full max-w-32":o.rank!=1}])},null,10,at)):h("",!0),e("div",dt,g(o.name),1),e("div",ct,g(o.rare),1),o.rare!="ã‚¢ã‚¤ãƒ†ãƒ "?(d(),a("div",mt,[t[25]||(t[25]=e("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1)),e("span",ht,g(l.format_number(o.point)),1)])):h("",!0),o.status==3?(d(),a("div",gt," ç™ºé€ä¾é ¼æ¸ˆã¿ ")):h("",!0)])],10,ot),o.status==1&&o.rare!="ã‚¢ã‚¤ãƒ†ãƒ "?(d(),a("div",{key:0,class:m(["absolute bottom-2 right-2 rounded-full p-1 shadow-lg transition-all duration-100 opacity-75",{"bg-theme":n.form.checks["id"+o.id],"bg-gray-300":!n.form.checks["id"+o.id]}])},[...t[26]||(t[26]=[e("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1)])],2)):h("",!0)],2))),256))],2)])]),e("div",ft,[e("div",ut,[e("div",bt,[e("div",xt,[e("span",null,"é¸æŠä¸­ "+g(l.selectedCount)+"æš Â /Â ",1),t[27]||(t[27]=e("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1)),e("span",pt,g(l.format_number(l.selectedPoints)),1)]),e("button",{type:"button",onClick:t[3]||(t[3]=o=>l.toggleSelectAll()),class:"px-4 py-2 text-sm font-semibold bg-amber-500 hover:bg-amber-600 text-white rounded-lg transition"}," å…¨ã¦é¸æŠ ")]),e("div",kt,[e("button",{type:"button",onClick:t[4]||(t[4]=o=>l.submit()),class:m([{"opacity-50":n.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 shadow-md transition"]),disabled:n.form.processing}," ãƒã‚¤ãƒ³ãƒˆã«äº¤æ› ",10,wt),e("button",{type:"button",onClick:t[5]||(t[5]=o=>l.delivery()),class:m([{"opacity-50":n.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gray-600 hover:bg-gray-700 shadow-md transition"]),disabled:n.form.processing}," ç™ºé€ä¾é ¼ ",10,vt)])]),t[28]||(t[28]=e("div",{class:"pb-2 text-center text-xs text-gray-500"}," â€»é¸æŠã•ã‚Œãªã‹ã£ãŸå•†å“ã¯ã€Œç²å¾—æ¸ˆã¿å•†å“ä¸€è¦§ã€ã«ç§»å‹•ã•ã‚Œã¾ã™ã€‚ ",-1))])])]),_:1})],64)}const Ot=O(A,[["render",yt]]);export{Ot as default};
