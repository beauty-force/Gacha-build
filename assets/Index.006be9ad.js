import{H as S,L as T,G as f,E as U,r as l,o as c,c as d,b as n,w as r,F as h,d as e,J as g,K as x,f as y,e as w,t as _,n as L,I as N,h as E}from"./app.25c64fee.js";import{A}from"./Admin.8678dea2.js";import{P as M}from"./Pagination.2297c7f3.js";import{N as H,e as z,U as B,o as R,f as X,r as G,u as J}from"./useConfirm.9f693f18.js";import{_ as K}from"./_plugin-vue_export-helper.cdc0426e.js";import"./ChevronRightIcon.635dc128.js";import"./EllipsisHorizontalIcon.9c1af585.js";const{confirm:q}=J(),Q={components:{Head:S,AppLayout:A,Link:T,Pagination:M,useForm:f,Dialog:H,DialogPanel:z,DialogTitle:B,TransitionChild:R,TransitionRoot:X,XMarkIcon:G},props:{errors:Object,auth:Object,category_share:Object,products:Object,search_cond:Object,total:Number},data(){return{csvDialogOpen:!1,csvFile:null,imageFiles:[],csvUploading:!1}},methods:{format_number(o){return String(o).replace(/(.)(?=(\d{3})+$)/g,"$1,")},destroyDp(o){q("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F","","error").then(s=>{s&&U.Inertia.delete(route("admin.dp.destroy",{id:o}),{preserveScroll:!0})})},search(){this.form_search.get(route("admin.dp"))},clear(){this.form_search.name="",this.form_search.min="",this.form_search.max="",this.search()},onCsvFileChange(o){this.csvFile=o.target.files[0]},onImageFilesChange(o){this.imageFiles=Array.from(o.target.files)},removeImageFile(o){this.imageFiles.splice(o,1)},submitCsv(){if(!this.csvFile){alert("CSV\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044");return}this.csvUploading=!0;try{f({csv:this.csvFile,category_id:this.category_share.cat_id,images:this.imageFiles}).post(route("admin.dp.upload_csv"),{preserveScroll:!0,onFinish:()=>{this.csvUploading=!1,this.csvDialogOpen=!1,this.csvFile=null,this.imageFiles=[]}})}catch{alert("\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),this.csvUploading=!1}}},setup(o){return{form_search:f(o.search_cond)}}},W={class:"py-4 md:px-6 px-4"},Y={class:"flex justify-between items-center mb-3 gap-2"},Z=e("h1",{class:"text-lg font-bold"},"EP \u8A2D\u5B9A",-1),$={class:"flex items-center gap-2 w-full flex-wrap mb-2 justify-between border p-2 text-sm"},ee={class:"flex flex-col gap-2 flex-1"},te={class:"flex items-center gap-2"},se=e("label",{class:"w-16 text-right"},"\u540D\u524D",-1),oe={class:"flex items-center gap-2"},ae=e("label",{class:"w-16 text-right"},"EP",-1),ne=e("span",null,"~",-1),le={class:"flex flex-col gap-2"},re=e("hr",{class:"my-4"},null,-1),ie={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2"},ce=e("div",{class:"rounded-full bg-green-500 text-3xl text-neutral-100 h-10 w-10"}," + ",-1),de={class:"bg-white text-center relative rounded-lg shadow-md"},me={class:"flex justify-between p-1"},ue=["onClick"],_e={class:"text-center pt-2 px-4 flex justify-center"},pe=["src"],fe={class:"text-sm pt-1 px-3 flex items-center justify-center font-bold"},he={class:"p-1"},ge={class:"rounded-full py-0.5 bg-neutral-800 text-neutral-100 w-[100px] text-sm"},xe={class:"flex bg-white justify-center"},be=e("span",{class:"text-sm leading-relaxed"},"\u6B8B\u308A\xA0",-1),ve=e("span",{class:"text-sm leading-relaxed"},"\xA0\u679A",-1),ye=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),we={class:"fixed inset-0 z-40 overflow-y-auto"},Ce={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},ke=e("div",{class:"mb-4"},[e("a",{href:"/gacha_csv/ep.csv",download:"",class:"text-blue-600 underline"},"CSV\u30C6\u30F3\u30D7\u30EC\u30FC\u30C8\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9")],-1),Fe={class:"mb-4"},De=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CSV\u30D5\u30A1\u30A4\u30EB",-1),je={class:"mb-4"},Ve=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u753B\u50CF\u30D5\u30A1\u30A4\u30EB",-1),Ie=e("p",{class:"text-sm text-gray-500 mt-1"}," \u753B\u50CF\u30D5\u30A1\u30A4\u30EB\u306F\u4EFB\u610F\u3067\u3059\u3002CSV\u306B\u8A18\u8F09\u3055\u308C\u305F\u753B\u50CF\u540D\u3068\u4E00\u81F4\u3059\u308B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002",-1),Oe={key:0,class:"mt-2"},Pe=e("p",{class:"text-sm font-medium text-gray-700"},"\u9078\u629E\u3055\u308C\u305F\u753B\u50CF:",-1),Se={class:"mt-1 text-sm text-gray-500"},Te=["onClick"],Ue={class:"flex gap-2 justify-end"},Le=["disabled"],Ne={key:0},Ee={key:1};function Ae(o,s,u,m,i,a){const C=l("Head"),k=l("Pagination"),b=l("Link"),v=l("TransitionChild"),F=l("DialogTitle"),D=l("XMarkIcon"),j=l("DialogPanel"),V=l("Dialog"),I=l("TransitionRoot"),O=l("AppLayout");return c(),d(h,null,[n(C,{title:"EP \u8A2D\u5B9A"}),n(O,null,{default:r(()=>[e("div",W,[e("div",Y,[Z,e("button",{type:"button",onClick:s[0]||(s[0]=t=>i.csvDialogOpen=!0),class:"inline-block px-4 py-2 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700 transition-colors"}," CSV\u3067\u767B\u9332 ")]),e("div",$,[e("div",ee,[e("div",te,[se,g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>m.form_search.name=t),type:"text",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[x,m.form_search.name]])]),e("div",oe,[ae,g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>m.form_search.min=t),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[x,m.form_search.min]]),ne,g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>m.form_search.max=t),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[x,m.form_search.max]])])]),e("div",le,[e("button",{type:"button",onClick:s[4]||(s[4]=(...t)=>a.clear&&a.clear(...t)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"\u521D\u671F\u5316"),e("button",{type:"button",onClick:s[5]||(s[5]=(...t)=>a.search&&a.search(...t)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"\u691C\u7D22")])]),n(k,{search_cond:u.search_cond,route_name:"admin.dp",total:u.total},null,8,["search_cond","total"]),re,e("div",ie,[n(b,{href:o.route("admin.dp.create")+u.category_share.cat_route_appendix,class:"bg-white text-center relative rounded-lg shadow-md flex justify-center items-center"},{default:r(()=>[ce]),_:1},8,["href"]),(c(!0),d(h,null,y(u.products.data,(t,p)=>(c(),d("div",de,[e("div",me,[n(b,{href:o.route("admin.dp.edit",{id:t.id})+u.category_share.cat_route_appendix,class:"rounded px-4 py-2 bg-green-500 text-xs text-neutral-50"},{default:r(()=>[w(" \u7DE8\u96C6\u3059\u308B ")]),_:2},1032,["href"]),e("button",{onClick:P=>a.destroyDp(t.id),class:"rounded px-4 py-2 bg-red-500 text-xs text-neutral-50"}," \u524A\u9664 ",8,ue)]),e("div",_e,[e("img",{class:"inline-block object-contain",src:t.image},null,8,pe)]),e("div",fe,_(t.name),1),e("div",he,[e("button",ge,_(a.format_number(t.dp))+"EP ",1)]),e("div",xe,[be,e("span",{class:L(["font-semibold text-base",{"text-rose-500":t.marks<=5}])},_(t.marks),3),ve])]))),256))])]),e("template",null,[n(I,{as:"template",show:i.csvDialogOpen},{default:r(()=>[n(V,{as:"div",class:"relative z-30",onClose:s[10]||(s[10]=t=>i.csvDialogOpen=!1)},{default:r(()=>[n(v,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[ye]),_:1}),e("div",we,[e("div",Ce,[n(v,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:r(()=>[n(j,{class:"p-4 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md"},{default:r(()=>[n(F,{class:"text-lg font-bold mb-2"},{default:r(()=>[w("CSV\u3067\u30AB\u30FC\u30C9\u767B\u9332")]),_:1}),ke,e("form",{onSubmit:s[9]||(s[9]=N((...t)=>a.submitCsv&&a.submitCsv(...t),["prevent"]))},[e("div",Fe,[De,e("input",{type:"file",accept:".csv",onChange:s[6]||(s[6]=(...t)=>a.onCsvFileChange&&a.onCsvFileChange(...t)),class:"w-full"},null,32)]),e("div",je,[Ve,e("input",{type:"file",multiple:"",accept:"image/*",onChange:s[7]||(s[7]=(...t)=>a.onImageFilesChange&&a.onImageFilesChange(...t)),class:"w-full"},null,32),Ie,i.imageFiles.length>0?(c(),d("div",Oe,[Pe,e("ul",Se,[(c(!0),d(h,null,y(i.imageFiles,(t,p)=>(c(),d("li",{key:p,class:"flex items-center gap-2"},[e("span",null,_(t.name),1),e("button",{type:"button",onClick:P=>a.removeImageFile(p),class:"text-red-500 hover:text-red-700"},[n(D,{class:"h-4 w-4"})],8,Te)]))),128))])])):E("",!0)]),e("div",Ue,[e("button",{type:"button",onClick:s[8]||(s[8]=t=>i.csvDialogOpen=!1),class:"px-4 py-2 bg-neutral-300 text-neutral-700 rounded hover:bg-neutral-400"},"\u30AD\u30E3\u30F3\u30BB\u30EB"),e("button",{type:"submit",disabled:i.csvUploading,class:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed"},[i.csvUploading?(c(),d("span",Ne,"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D...")):(c(),d("span",Ee,"\u767B\u9332"))],8,Le)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1})],64)}const Je=K(Q,[["render",Ae]]);export{Je as default};
