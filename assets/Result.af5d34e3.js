import{H as y,L as w,G as C,r as b,o as c,c as d,b as g,w as j,F as _,d as t,n as m,e as r,t as h,h as f,f as A,J as L,a2 as R}from"./app.b7b512c0.js";import{A as D}from"./Admin.e0c6452f.js";import{u as S}from"./useConfirm.1bfee7d1.js";import{_ as I}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as O}from"./PlayIcon.37f76a44.js";const{confirm:p,alert:x}=S(),z={components:{Head:y,AppLayout:D,Link:w,PlayIcon:O},props:{errors:Object,auth:Object,category_share:Object,products:Object,token:String,show_review:Boolean,rank:Object,delivery_limit:Number},data(){return{isCheckAll:!1,showRankDialog:!1,isClosing:!1}},computed:{selectedPoints(){let e=0;for(let s=0;s<this.products.data.length;s++)this.form.checks["id"+this.products.data[s].id]&&(e+=parseInt(this.products.data[s].point));return e},selectedCount(){let e=0;for(let s=0;s<this.products.data.length;s++)this.form.checks["id"+this.products.data[s].id]&&e++;return e}},mounted(){this.rank&&(this.showRankDialog=!0)},setup(e){let s={},o;for(o=0;o<e.products.data.length;o++)s["id"+e.products.data[o].id]=!1;return{form:C({checks:s,token:e.token})}},methods:{closeRankDialog(){this.isClosing=!0,setTimeout(()=>{this.showRankDialog=!1,this.isClosing=!1},300)},format_number(e){return String(e).replace(/(.)(?=(\d{3})+$)/g,"$1,")},submit(){let e,s=0;var o=0;for(e=0;e<this.products.data.length;e++)this.form.checks["id"+this.products.data[e].id]&&(s++,o=o+parseInt(this.products.data[e].point));let a="\u30DD\u30A4\u30F3\u30C8\u4EA4\u63DB",l="";o>0?l="<p>\u9078\u629E\u3057\u305F"+s+"\u70B9\u306E\u5546\u54C1\u3092"+o+'pt\u3068\u4EA4\u63DB\u3057\u307E\u3059\u3002</p><div class="bg-amber-50 p-2 rounded-md flex gap-1 items-center justify-center mt-2"><img src="/images/icon_cash.png" class="w-4 h-4" alt="coin icon" /><span class="font-semibold">'+this.auth.user.point.toLocaleString()+'pt</span><span class="mx-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></span><img src="/images/icon_cash.png" class="w-4 h-4" alt="coin icon" /><span class="font-semibold">'+(this.auth.user.point+o).toLocaleString()+"pt</span></div>":l="\u5168\u3066\u306E\u5546\u54C1\u304C\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3057\u307E\u3059\u3002",p(a,l).then(n=>{n&&this.form.post(route("user.gacha.result.exchange"),{onFinish:()=>{}})})},delivery(){let e,s=0;var o=0;let a=0;for(e=0;e<this.products.data.length;e++)this.form.checks["id"+this.products.data[e].id]&&(s++,o=o+parseInt(this.products.data[e].point),this.products.data[e].rare=="\u30DD\u30A4\u30F3\u30C8"&&a++);if(a>0){x("\u30DD\u30A4\u30F3\u30C8\u306F\u767A\u9001\u3067\u304D\u307E\u305B\u3093");return}let l="";if(s>0){if(l="\u9078\u629E\u3057\u305F"+s+"\u70B9\u306E\u5546\u54C1\u3092\u767A\u9001\u4F9D\u983C\u3057\u307E\u3059\u3002",o<this.delivery_limit){x("\u767A\u9001\u4F9D\u983C\u304C\u3067\u304D\u308B\u6700\u4F4E\u30DD\u30A4\u30F3\u30C8\u306F"+this.format_number(this.delivery_limit)+"pt\u3067\u3059\u3002");return}}else l="\u5168\u3066\u306E\u5546\u54C1\u304C\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3057\u307E\u3059\u3002";p(l).then(n=>{n&&this.form.post(route("user.gacha.result.delivery"),{onFinish:()=>{}})})},checkall(){let e;for(e=0;e<this.products.data.length;e++)this.form.checks["id"+this.products.data[e].id]=this.isCheckAll&&this.products.data[e].status!=3},checkone(){this.isCheckAll=this.products.data.length>0,this.products.data.forEach(e=>{this.form.checks["id"+e.id]!=!0&&(this.isCheckAll=!1)})},toggleSelectAll(){this.isCheckAll=!this.isCheckAll,this.checkall()}}},B={class:"h-full flex flex-col justify-start"},V={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},F={class:"flex items-center justify-center min-h-screen pt-4 px-4 text-center sm:block sm:p-0"},N=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),P={class:"bg-gradient-to-r from-amber-500 to-amber-600 px-4 pt-6 pb-4 text-white"},H={class:"text-center"},E=t("h3",{class:"text-lg leading-6 font-bold mb-2 flex items-center justify-center gap-2"},[t("span",{class:"text-xl"},"\u{1F389}"),r("\u4F1A\u54E1\u30E9\u30F3\u30AF\u5909\u66F4\u306E\u304A\u77E5\u3089\u305B\uFF01"),t("span",{class:"text-xl"},"\u{1F389}")],-1),M=t("p",{class:"text-amber-50 mb-4 text-base"},"\u3042\u306A\u305F\u306E\u30E9\u30F3\u30AF\u304C\u30A2\u30C3\u30D7\u3057\u307E\u3057\u305F\u{1F44F}\u2728",-1),T={class:"inline-block"},U=["src"],G={class:"bg-white"},J={class:"text-center"},q={class:"text-left text-gray-800 space-y-3 text-sm md:text-base bg-amber-50 p-4"},K=t("p",{class:"font-bold text-lg mb-3 text-amber-700"},"\u{1F4E6}\u73FE\u5728\u53D7\u3051\u3089\u308C\u308B\u7279\u5178\u4E00\u89A7\u{1F4E6}",-1),Q={class:"flex items-center gap-2"},W={class:"text-amber-700"},X={class:"flex items-center gap-2"},Y={class:"text-amber-700"},Z={class:"flex items-center gap-2"},$={class:"text-amber-700"},tt=t("p",{class:"flex items-center gap-2"},[r("\u{1F539} "),t("span",null,"\u30E9\u30F3\u30AF\u9650\u5B9A\uFF1A\u7279\u5225\u30AC\u30C1\u30E3\u304C\u89E3\u653E\u3055\u308C\u307E\u3057\u305F\uFF01")],-1),et=t("p",{class:"text-gray-600 my-4 font-semibold"},"\u{1F4A1}\u7279\u5178\u3092\u6D3B\u304B\u3057\u3066\u3001\u3055\u3089\u306B\u304A\u5F97\u306B\u30A4\u30D6\u30AC\u30C1\u30E3\u3092\u697D\u3057\u3082\u3046\uFF01",-1),st={class:"bg-white px-4 py-4 sm:px-6 sm:flex sm:flex-row-reverse justify-center border-t-2 border-amber-200"},ot={class:"sticky top-0 z-30 bg-gradient-to-r from-amber-400 via-amber-500 to-amber-400 shadow-lg"},it={class:"max-w-4xl mx-auto flex justify-between items-center py-3 px-4"},at=t("h1",{class:"text-white text-lg font-bold text-center"}," \u30AC\u30C1\u30E3\u7D50\u679C ",-1),nt=["href"],lt={class:"m-auto items-center px-2 py-2 flex-1 w-full"},rt=["href"],ct=t("div",{class:"bg-theme bg-theme-hover px-3 py-2 rounded-md text-center text-white"},[t("img",{src:"/images/video_review.png",class:"w-full",alt:"\u30AC\u30C1\u30E3\u6F14\u51FA\u3092\u3082\u3046\u4E00\u5EA6\u898B\u308B"})],-1),dt=[ct],ht={class:"p-2 md:p-3 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 md:gap-3"},mt=["for"],ft={class:"relative h-32 w-24 flex-shrink-0 bg-gradient-to-br from-amber-50 to-yellow-50 flex justify-center items-center"},ut=["src"],bt=["src","alt"],gt={class:"flex-1 px-2 py-3 flex flex-col justify-around items-start"},_t=["id","onUpdate:modelValue"],pt={class:"text-gray-800 text-xs font-bold line-clamp-2"},xt={class:"inline-block px-2 py-0.5 bg-amber-100 text-amber-800 text-xs font-bold rounded-full"},kt={class:"flex items-center gap-1"},vt=t("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1),yt={class:"text-xs font-bold text-amber-700"},wt={key:1,class:"text-xs text-rose-600 font-semibold rounded-full"},Ct=t("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1),jt=[Ct],At={class:"sticky bottom-0 z-30 w-full bg-white border-t border-gray-200 shadow-lg"},Lt={class:"mx-auto px-4 py-2"},Rt={class:"flex items-center justify-between mb-2"},Dt={class:"flex items-center gap-1 text-gray-700 text-base"},St=t("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1),It={class:"font-semibold"},Ot={class:"flex gap-2"},zt=["disabled"],Bt=["disabled"],Vt=t("div",{class:"pb-2 text-center text-xs text-gray-500"}," \u203B\u9078\u629E\u3055\u308C\u306A\u304B\u3063\u305F\u5546\u54C1\u306F\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3055\u308C\u307E\u3059\u3002 ",-1);function Ft(e,s,o,a,l,n){const k=b("Head"),v=b("AppLayout");return c(),d(_,null,[g(k,{title:"\u30AC\u30C1\u30E3\u2013\u7D50\u679C"}),g(v,{hide_header:!0},{default:j(()=>[t("div",B,[l.showRankDialog?(c(),d("div",V,[t("div",F,[t("div",{class:m(["fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",{"animate-[fadeIn_0.3s_ease-out]":!l.isClosing,"animate-[fadeOut_0.3s_ease-out]":l.isClosing}]),"aria-hidden":"true"},null,2),N,t("div",{class:m(["inline-block align-bottom bg-gradient-to-br from-amber-50 via-white to-amber-50 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full border-4 border-amber-400",{"animate-[bounceIn_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":!l.isClosing,"animate-[bounceOut_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":l.isClosing}])},[t("div",P,[t("div",H,[E,M,t("div",T,[t("img",{src:o.rank.badge,alt:"Rank Image",class:"w-full max-w-80 h-32"},null,8,U)])])]),t("div",G,[t("div",J,[t("div",q,[K,t("p",Q,[r("\u{1F539} "),t("span",null,[r("\u30E9\u30F3\u30AF\u30A2\u30C3\u30D7\u30DC\u30FC\u30CA\u30B9\uFF1A"),t("strong",W,h(o.rank.bonus.toLocaleString())+"PT",1),r("\u4ED8\u4E0E\uFF01")])]),t("p",X,[r("\u{1F539} "),t("span",null,[r("\u8CFC\u5165\u91D1\u984D\u306B\u5FDC\u3058\u3066\uFF1A"),t("strong",Y,h(o.rank.pt_rate)+"%",1),r("\u306E\u30DC\u30FC\u30CA\u30B9\u30DD\u30A4\u30F3\u30C8\u9084\u5143\uFF01")])]),t("p",Z,[r("\u{1F539} "),t("span",null,[r("EP\u9084\u5143\u7387\uFF1A"),t("strong",$,h(o.rank.dp_rate)+"%",1),r("\uFF08\u901A\u5E38\u3088\u308A\u304A\u5F97\u306B\u8CAF\u307E\u308B\uFF01\uFF09")])]),tt]),et])]),t("div",st,[t("button",{type:"button",onClick:s[0]||(s[0]=(...i)=>n.closeRankDialog&&n.closeRankDialog(...i)),class:"w-full inline-flex justify-center rounded-lg border-2 border-amber-500 bg-gradient-to-r from-amber-500 to-amber-600 shadow-lg px-6 py-3 text-base font-semibold text-white hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 sm:ml-3 sm:w-auto transition-all"}," \u9589\u3058\u308B ")])],2)])])):f("",!0),t("div",ot,[t("div",it,[at,t("a",{class:"px-4 py-2 bg-white text-amber-600 rounded-lg font-semibold hover:bg-amber-50 transition-colors shadow-md",href:e.route("user.gacha.end",{token:o.token})}," \u30B9\u30AD\u30C3\u30D7 ",8,nt)])]),t("div",lt,[o.show_review?(c(),d("a",{key:0,class:"w-full px-3 md:px-6 my-2",href:e.route("user.gacha.video",{token:o.token})},dt,8,rt)):f("",!0),t("div",null,[t("div",ht,[(c(!0),d(_,null,A(o.products.data,(i,Nt)=>(c(),d("div",{class:m(["relative border-2 rounded-lg overflow-hidden shadow-md transition-all hover:shadow-xl",{"border-amber-500 shadow-amber-200 bg-amber-50":a.form.checks["id"+i.id],"bg-white border-gray-200":!a.form.checks["id"+i.id]}])},[t("label",{for:"checkbox"+i.id,class:"flex cursor-pointer"},[t("div",ft,[t("img",{class:"max-h-full max-w-full object-contain p-1.5",src:i.image},null,8,ut),i.badge?(c(),d("img",{key:0,src:i.badge,class:"absolute bottom-2 right-2 w-[30%] drop-shadow-lg",alt:i.badge},null,8,bt)):f("",!0)]),t("div",gt,[i.status==1?L((c(),d("input",{key:0,id:"checkbox"+i.id,type:"checkbox","onUpdate:modelValue":u=>a.form.checks["id"+i.id]=u,onChange:s[1]||(s[1]=(...u)=>n.checkone&&n.checkone(...u)),class:"hidden"},null,40,_t)),[[R,a.form.checks["id"+i.id]]]):f("",!0),t("div",pt,h(i.name),1),t("div",xt,h(i.rare),1),t("div",kt,[vt,t("span",yt,h(n.format_number(i.point)),1)]),i.status==3?(c(),d("div",wt," \u767A\u9001\u4F9D\u983C\u6E08\u307F ")):f("",!0)])],8,mt),i.status==1?(c(),d("div",{key:0,class:m(["absolute bottom-2 right-2 rounded-full p-1 shadow-lg transition-all duration-100 opacity-75",{"bg-theme":a.form.checks["id"+i.id],"bg-gray-300":!a.form.checks["id"+i.id]}])},jt,2)):f("",!0)],2))),256))])])]),t("div",At,[t("div",Lt,[t("div",Rt,[t("div",Dt,[t("span",null,"\u9078\u629E\u4E2D "+h(n.selectedCount)+"\u679A \xA0/\xA0",1),St,t("span",It,h(n.format_number(n.selectedPoints)),1)]),t("button",{type:"button",onClick:s[2]||(s[2]=i=>n.toggleSelectAll()),class:"px-4 py-2 text-sm font-semibold bg-amber-500 hover:bg-amber-600 text-white rounded-lg transition"}," \u5168\u3066\u9078\u629E ")]),t("div",Ot,[t("button",{type:"button",onClick:s[3]||(s[3]=i=>n.submit()),class:m([{"opacity-50":a.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 shadow-md transition"]),disabled:a.form.processing}," \u30DD\u30A4\u30F3\u30C8\u306B\u4EA4\u63DB ",10,zt),t("button",{type:"button",onClick:s[4]||(s[4]=i=>n.delivery()),class:m([{"opacity-50":a.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gray-600 hover:bg-gray-700 shadow-md transition"]),disabled:a.form.processing}," \u767A\u9001\u4F9D\u983C ",10,Bt)])]),Vt])])]),_:1})],64)}const Ut=I(z,[["render",Ft]]);export{Ut as default};
