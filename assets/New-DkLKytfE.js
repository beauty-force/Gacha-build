import{d as x,r as b,c as l,o as i,a as p,w as h,b as e,h as M,j as c,i as a,v as f,e as u,t as d,F as _,f as y,k as N}from"./app-CT1Wwlkh.js";import{A as O}from"./Admin-DF8nCgVH.js";import{B as j}from"./main-CbxYf_IB.js";import{s as D}from"./vue-multiselect-D2pTmNL2.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useConfirm-DQO9RPtQ.js";import"./isNativeReflectConstruct-zdezgZUv.js";const B={components:{Head:x.Head,AppLayout:O,Link:x.Link,VueDatePicker:j,Multiselect:D},props:{errors:Object,auth:Object,coupon:Object,editing:Object,types:Object,points:Array,ranks:Array},data(){return{rank_selection:[]}},methods:{submit(){this.rank_selection&&this.rank_selection.length>0?(this.form.rank_limit=this.rank_selection.map(o=>o.rank).reduce((o,t)=>o|1<<t,0),this.ranks.forEach(o=>{this.form.rank_limit^=1<<o.rank})):(this.form.rank_limit=this.ranks.reduce((o,t)=>o|1<<t.rank,0),this.ranks.forEach(o=>{this.form.rank_limit^=1<<o.rank})),this.form.post(route("admin.coupon.store"))}},computed:{flash(){return x.usePage().props.value.flash}},watch:{flash:function(o,t){o.data&&(this.form.title=o.data.title,this.form.type=o.data.type,this.form.code=o.data.code,this.form.point=o.data.point,this.form.discount_rate=o.data.discount_rate,this.form.expiration=o.data.expiration,this.form.count=o.data.count,this.form.user_limit=o.data.user_limit,this.form.rank_limit=o.data.rank_limit??0)}},mounted(){this.coupon.rank_limit!==void 0&&this.coupon.rank_limit!==null?this.ranks.forEach(o=>{(this.coupon.rank_limit<0||!(this.coupon.rank_limit&1<<o.rank))&&this.rank_selection.push(o)}):this.rank_selection=[...this.ranks]},setup(o){return{form:x.useForm({id:o.coupon.id,title:o.coupon.title,type:o.coupon.type,code:o.coupon.code,point:o.coupon.point,discount_rate:o.coupon.discount_rate.map(r=>r.rate),expiration:o.coupon.expiration,count:o.coupon.count,user_limit:o.coupon.user_limit,rank_limit:o.coupon.rank_limit??0})}}},E={class:"pt-6 md:px-6 px-4"},P={key:0,class:"mb-2 text-lg font-bold"},C={key:1,class:"mb-2 text-lg font-bold"},S={class:"mb-6"},F={key:0,class:"text-red-500 text-sm mt-1"},T={class:"mb-6"},I={key:0,class:"text-red-500 text-sm mt-1"},J={class:"mb-6"},R=["value"],q={key:0,class:"mb-6"},z={key:0,class:"text-red-500 text-sm mt-1"},G={key:1,class:"text-red-500 text-sm mt-1"},K={class:"mb-6"},Q=["for"],W=["onUpdate:modelValue","id"],X={key:0,class:"text-red-500 text-sm mt-1"},Y={class:"mb-6"},Z={key:0,class:"text-red-500 text-sm mt-1"},$={class:"mb-6"},tt={key:0,class:"text-red-500 text-sm mt-1"},et={class:"mb-6"},ot={key:0,class:"text-red-500 text-sm mt-1"},rt={class:"mb-6"},st={key:0,class:"text-red-500 text-sm mt-1"},nt={class:"flex gap-4 mb-4"},lt={class:"w-1/2"};function it(o,t,r,n,k,g){const v=b("Head"),w=b("VueDatePicker"),V=b("multiselect"),L=b("Link"),U=b("AppLayout");return i(),l(_,null,[p(v,{title:r.editing?"クーポン編集":"クーポン追加"},null,8,["title"]),p(U,null,{default:h(()=>[e("div",E,[r.editing?(i(),l("h1",P,"クーポン編集")):(i(),l("h1",C,"クーポン追加")),t[21]||(t[21]=e("hr",{class:"mb-8"},null,-1)),e("form",{onSubmit:t[9]||(t[9]=M(s=>g.submit(),["prevent"]))},[c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.form.id=s),class:"hidden"},null,512),[[f,n.form.id]]),e("div",S,[t[10]||(t[10]=e("label",{for:"title",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("お名前 (テキスト) "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.form.title=s),id:"title",type:"text",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,512),[[f,n.form.title]]),r.errors.title?(i(),l("div",F,d(r.errors.title),1)):a("",!0)]),e("div",T,[t[11]||(t[11]=e("label",{for:"code",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("コード(テキスト) "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.form.code=s),id:"code",type:"text",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,512),[[f,n.form.code]]),r.errors.code?(i(),l("div",I,d(r.errors.code),1)):a("",!0)]),e("div",J,[t[12]||(t[12]=e("label",{for:"type",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("種類 "),e("span",{class:"text-red-500"},"*")],-1)),c(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.form.type=s),id:"type",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},[(i(!0),l(_,null,y(r.types,(s,m)=>(i(),l("option",{value:m},d(s),9,R))),256))],512),[[N,n.form.type]])]),n.form.type=="NORMAL"?(i(),l("div",q,[t[13]||(t[13]=e("label",{for:"point",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("ポイント (半角数字) "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.form.point=s),id:"point",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,512),[[f,n.form.point]]),r.errors.point?(i(),l("div",z,d(r.errors.point),1)):a("",!0)])):a("",!0),r.errors.discount_rate?(i(),l("div",G,d(r.errors.discount_rate),1)):a("",!0),n.form.type=="DISCOUNT"?(i(!0),l(_,{key:2},y(r.points,(s,m)=>(i(),l("div",K,[e("label",{for:"discount_rate"+m,class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u(d(s.point)+" pt - 割引率 (半角数字) ",1),t[14]||(t[14]=e("span",{class:"text-red-500"},"*",-1))],8,Q),c(e("input",{"onUpdate:modelValue":A=>n.form.discount_rate[m]=A,id:"discount_rate"+m,type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,8,W),[[f,n.form.discount_rate[m]]]),r.errors[`discount_rate.${m}`]?(i(),l("div",X,d(r.errors[`discount_rate.${m}`]),1)):a("",!0)]))),256)):a("",!0),e("div",Y,[t[15]||(t[15]=e("label",{for:"expiration",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("有効期限 "),e("span",{class:"text-red-500"},"*")],-1)),p(w,{modelValue:n.form.expiration,"onUpdate:modelValue":t[5]||(t[5]=s=>n.form.expiration=s),format:"yyyy-MM-dd HH:mm"},null,8,["modelValue"]),r.errors.expiration?(i(),l("div",Z,d(r.errors.expiration),1)):a("",!0)]),e("div",$,[t[16]||(t[16]=e("label",{for:"count",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("点数 (半角数字) "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.form.count=s),id:"count",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,512),[[f,n.form.count]]),r.errors.count?(i(),l("div",tt,d(r.errors.count),1)):a("",!0)]),e("div",et,[t[17]||(t[17]=e("label",{for:"user_limit",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},[u("一人当上限 (半角数字) "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>n.form.user_limit=s),id:"user_limit",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください"},null,512),[[f,n.form.user_limit]]),r.errors.user_limit?(i(),l("div",ot,d(r.errors.user_limit),1)):a("",!0)]),e("div",rt,[t[18]||(t[18]=e("label",{for:"rank_limit",class:"block font-medium text-sm text-neutral-700 mb-2 ml-1"},"ランク制限",-1)),p(V,{modelValue:k.rank_selection,"onUpdate:modelValue":t[8]||(t[8]=s=>k.rank_selection=s),options:r.ranks,multiple:!0,"close-on-select":!1,"clear-on-select":!1,label:"title","track-by":"title",searchable:!1,language:"JP",taggable:!0,selectedLabel:"選択済み",deselectLabel:"",selectLabel:"",placeholder:"ランクを選択してください"},null,8,["modelValue","options"]),r.errors.rank_limit?(i(),l("div",st,d(r.errors.rank_limit),1)):a("",!0)]),e("div",nt,[t[20]||(t[20]=e("div",{class:"w-1/2"},[e("button",{type:"submit",class:"inline-block items-center w-full py-2.5 bg-teal-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-teal-700 active:bg-green-700 transition ease-in-out duration-150"}," 保存 ")],-1)),e("div",lt,[p(L,{href:o.route("admin.coupon"),class:"text-center inline-block items-center w-full py-2.5 bg-cyan-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-cyan-700 transition ease-in-out duration-150",as:"button"},{default:h(()=>[...t[19]||(t[19]=[u(" 戻る ",-1)])]),_:1},8,["href"])])])],32)])]),_:1})],64)}const pt=H(B,[["render",it]]);export{pt as default};
