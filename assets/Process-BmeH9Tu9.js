import{d as u,r as p,c as a,o as d,a as c,w as f,b as t,j as b,e as r,v as x,t as o,h as y,i as w,F as v}from"./app-d5gBoxw1.js";import{U as j}from"./UserLayout-CjNOU91w.js";import{u as S}from"./useConfirm-BCJmOtE9.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-aVb63ak4.js";const{confirm:A}=S(),C={components:{Head:u.Head,AppLayout:j,Link:u.Link},props:{errors:Object,auth:Object,checkout:Object,point:Object,bank_info:Object,link_url:String,amount:Number,coupon_id:Number,merchant_id:String,public_key_id:String,payload:Object,signature:String,checkoutSessionId:String},data(){return{purchase_bank_uri:"user.point.purchase_bank",purchase_uri:"user.point",is_processing:!0}},mounted(){if(this.checkout)window.location.replace(this.checkout.url);else if(this.link_url)window.location.replace(this.link_url);else{const e=document.createElement("script");e.src="https://static-fe.payments-amazon.com/checkout.js",e.onload=this.renderAmazonPayButton,document.head.appendChild(e)}this.auth.user&&this.auth.user.type==1&&(this.is_admin=!0,this.purchase_bank_uri="test.user.point.purchase_bank",this.purchase_uri="test.user.point")},methods:{format_number(e){return String(e).replace(/(.)(?=(\d{3})+$)/g,"$1,")},makeBankPayment(){A("銀行口座情報を正確に入力しましたか？").then(e=>{e&&this.form.post(route(this.purchase_bank_uri,{id:this.point.id,coupon_id:this.coupon_id}),{preserveScroll:!0,onFinish:()=>{}})})},back(){window.history.back()},renderAmazonPayButton(){this.is_processing=!1,amazon.Pay.renderButton("#AmazonPayButton",{merchantId:this.merchant_id,publicKeyId:this.public_key_id,ledgerCurrency:"JPY",checkoutLanguage:"ja_JP",productType:"PayOnly",placement:"Checkout",buttonColor:"Gold",buttonWidth:"300px",buttonHeight:"50px",createCheckoutSessionConfig:{payloadJSON:JSON.stringify(this.payload),signature:this.signature,algorithm:"AMZN-PAY-RSASSA-PSS-V2"}})}},setup(e){return{form:u.useForm({point_id:e.point.id,account:"",bank_name:""})}}},B={key:0,class:"w-max max-w-full mx-auto flex flex-col items-center px-4"},L={class:"border p-5 rounded-lg w-full flex flex-col items-center gap-4"},N={class:"flex flex-col gap-2"},O={class:"form-group flex items-center gap-2"},V={class:"form-group flex items-center gap-2"},z={class:"border p-5 rounded-lg w-full flex flex-col items-center gap-4"},H={class:"text-center w-full flex flex-col gap-1"},F={class:"flex justify-start"},J={class:"flex justify-start"},U={class:"flex justify-start"},E={class:"flex justify-start"},I={class:"flex justify-start"},M={class:""},T={class:"flex justify-start"},D={class:"flex justify-start"},Y={class:"mb-6 flex flex-wrap justify-center gap-2"},G={key:1,class:"text-center rounded-md flex justify-center"},K={key:0,class:"mt-8 mb-8 text-center"};function R(e,s,n,l,_,m){const g=p("Head"),k=p("Link"),h=p("AppLayout");return d(),a(v,null,[c(g,{title:"決済"}),c(h,null,{default:f(()=>[n.bank_info?(d(),a("div",B,[s[17]||(s[17]=t("h3",{class:"text-center my-5 font-bold text-lg underline underline-offset-4"},"銀行振り込みの流れ",-1)),t("div",L,[s[5]||(s[5]=t("div",{class:"flex w-full"},[t("span",null,[t("strong",null,"1")]),t("p",{class:"ml-3 indent-1"},"振り込み元口座情報の入力")],-1)),t("form",N,[t("div",O,[s[3]||(s[3]=t("label",{for:"account",class:"w-20 block text-right"},[r("口座名義 "),t("span",{class:"text-red-500"},"*")],-1)),b(t("input",{type:"text",class:"rounded-md",id:"account",placeholder:"口座名義","onUpdate:modelValue":s[0]||(s[0]=i=>l.form.account=i)},null,512),[[x,l.form.account]])]),t("div",V,[s[4]||(s[4]=t("label",{for:"bank_name",class:"w-20 block text-right"},[r("銀行名 "),t("span",{class:"text-red-500"},"*")],-1)),b(t("input",{type:"text",class:"rounded-md",id:"bank_name",placeholder:"銀行名","onUpdate:modelValue":s[1]||(s[1]=i=>l.form.bank_name=i)},null,512),[[x,l.form.bank_name]])])])]),s[18]||(s[18]=t("div",{class:"text-center"},[t("img",{src:"/images/arrow_down.png",class:"h-10"})],-1)),t("div",z,[s[13]||(s[13]=t("div",{class:"flex w-full"},[t("span",null,[t("strong",null,"2")]),t("p",{class:"ml-3 indent-1"},"銀行振り込み")],-1)),t("div",H,[t("div",F,[s[6]||(s[6]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"銀行名",-1)),t("span",null,o(n.bank_info.bank_name),1)]),t("div",J,[s[7]||(s[7]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"支店コード",-1)),t("span",null,o(n.bank_info.branch_code),1)]),t("div",U,[s[8]||(s[8]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"支店名",-1)),t("span",null,o(n.bank_info.branch_name),1)]),t("div",E,[s[9]||(s[9]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"口座種類",-1)),t("span",null,o(n.bank_info.account_type),1)]),t("div",I,[s[10]||(s[10]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"口座名義",-1)),t("span",M,o(n.bank_info.holder_name),1)]),t("div",T,[s[11]||(s[11]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"口座番号",-1)),t("span",null,o(n.bank_info.account_number),1)]),t("div",D,[s[12]||(s[12]=t("span",{class:"font-bold text-right pr-8 w-2/5"},"金額",-1)),t("span",null,"¥ "+o(m.format_number(n.amount)),1)])])]),s[19]||(s[19]=t("div",{class:"text-center"},[t("img",{src:"/images/arrow_down.png",class:"h-10"})],-1)),s[20]||(s[20]=t("div",{class:"border p-5 rounded-lg w-full flex"},[t("span",null,[t("strong",null,"3")]),t("p",{class:"ml-3 indent-1"},[r("運営が振り込み確認後、 ポイントの購入完了"),t("br"),r("ポイント反映までお時間がかかる場合がございます。")])],-1)),s[21]||(s[21]=t("br",null,null,-1)),t("div",Y,[t("button",{class:"px-8 py-2 rounded-md hover:bg-sky-100 border border-yellow-500 text-sky-600",onClick:s[2]||(s[2]=y(i=>m.makeBankPayment(),["prevent"]))},[...s[14]||(s[14]=[t("span",null,"完了",-1)])]),s[16]||(s[16]=t("br",null,null,-1)),c(k,{href:e.route(_.purchase_uri),class:"px-8 py-2 rounded-md hover:bg-rose-100 border border-rose-500 text-rose-600"},{default:f(()=>[...s[15]||(s[15]=[r(" 戻る ",-1)])]),_:1},8,["href"])])])):(d(),a("div",G,[n.merchant_id?w("",!0):(d(),a("div",K," 処理中です。 ")),s[22]||(s[22]=t("div",{id:"AmazonPayButton",class:"mt-8"},null,-1))]))]),_:1})],64)}const $=P(C,[["render",R]]);export{$ as default};
