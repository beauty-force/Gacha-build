import{d as m,r as p,c as r,o as l,a as g,w as y,b as t,i as u,t as n,e as h,F as b,j as c,v as _,k as L,n as f,f as v,y as k,m as T}from"./app-DmV7iNwK.js";import{A as j}from"./Admin-Dv_fQ8mr.js";import{u as V}from"./useConfirm-BSIoXbf_.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{confirm:P}=V(),D={components:{Head:m.Head,AppLayout:j,Link:m.Link},props:{errors:Object,user:Object,profile:Object,rank:String,auth:Object,subscription:Object,allTags:Array},methods:{submit(){this.form.post(route("admin.users.update"),{preserveScroll:!0,onFinish:()=>{}})},add_point(d){m.useForm({id:this.user.id,point:d}).post(route("admin.users.add_point"),{preserveScroll:!0,onFinish:()=>{this.form.point=this.user.point}})},updateStatus(d,e){let s="",i="";e==1?(s="アカウントをアクティブにしますか？",i="アカウントが通常状態に戻ります。"):e==0&&(s="アカウントを停止しますか？",i="獲得した商品と発送依頼中の商品は全て回収されます。"),P(s,i,e==0?"warning":"info").then(w=>{w&&m.useForm({id:d,status:e}).post(route("admin.users.update"))})},isTagSelected(d){return this.tagForm.tag_ids.includes(d)},assignTags(){this.tagForm.post(route("admin.users.assign_tags"),{preserveScroll:!0,onFinish:()=>{}})},format_number(d){return String(d).replace(/(.)(?=(\d{3})+$)/g,"$1,")}},setup(d){const e=m.useForm({id:d.user.id,point:d.user.point,dp:d.user.dp,type:d.user.type}),s=m.useForm({user_id:d.user.id,tag_ids:d.user.tags?d.user.tags.map(i=>i.id):[]});return{form:e,tagForm:s}}},A={class:"md:px-4 px-2"},B={class:"border-b w-full p-2 my-2 font-semibold flex justify-between items-center"},H={class:"flex gap-2"},O={class:"w-full text-sm"},N={class:"p-1 w-3/5"},U={class:"p-1 w-3/5"},E={class:"p-1 w-3/5"},J={key:0,class:"p-1 w-3/5"},z={class:"flex gap-2 mt-2"},I={key:1,class:"p-1 w-3/5"},Y={key:0,class:"p-1 w-3/5"},q={key:1,class:"p-1 w-3/5"},G={class:"p-1 w-3/5"},K={class:"p-1 w-3/5"},Q={class:"p-1 w-3/5"},R={class:"p-1 w-3/5"},W={class:"p-1 w-3/5"},X={class:"p-1 w-3/5"},Z={class:"p-1 w-3/5"},$={key:0},tt={class:"p-1 w-3/5"},et={class:"p-1 w-3/5"},st={key:2},ot={class:"p-1 w-3/5"},nt={key:3},rt={class:"p-1 w-3/5"},lt={class:"mb-2"},dt={key:0},it={key:1},at={key:2},ut={key:3},mt={key:4},bt={class:"flex flex-wrap gap-2"},ft={class:"p-1 w-3/5"},gt={class:"space-y-2"},ct={class:"flex flex-wrap gap-2 mb-2"},pt={key:0,class:"text-gray-400 text-sm"},yt={class:"flex flex-wrap gap-2"},wt=["value"],xt={class:"text-sm"},ht={key:0,class:"text-xs text-gray-500"},_t=["disabled"],vt={key:0,class:"my-6 text-center border border-yellow-500 rounded-full p-0.5 w-fit mx-auto text-sm"},kt=["disabled"];function St(d,e,s,i,w,a){const S=p("Head"),x=p("Link"),C=p("AppLayout");return l(),r(b,null,[g(S,{title:"ユーザー管理"}),g(C,null,{default:y(()=>[t("div",A,[t("div",B,[t("h3",null,"ユーザー詳細 (ID-"+n(s.user.id)+")",1),t("div",H,[g(x,{href:d.route("admin.users.history",{id:s.user.id}),class:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 text-sm"},{default:y(()=>[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),h(" 履歴を表示 ",-1)])]),_:1},8,["href"]),g(x,{href:d.route("admin.users"),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-normal text-white bg-red-500 hover:bg-red-400 rounded-md transition-colors"},{default:y(()=>[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),h(" 戻る ",-1)])]),_:1},8,["href"])])]),t("table",O,[t("tbody",null,[s.user?(l(),r(b,{key:0},[t("tr",null,[e[12]||(e[12]=t("td",{class:"p-1 w-2/5 font-bold"},"メールアドレス",-1)),t("td",N,n(s.user.email),1)]),t("tr",null,[e[13]||(e[13]=t("td",{class:"p-1 w-2/5 font-bold"},"電話番号",-1)),t("td",U,n(s.profile?s.profile.phone:s.user.phone),1)]),t("tr",null,[e[14]||(e[14]=t("td",{class:"p-1 w-2/5 font-bold"},"生年月日",-1)),t("td",E,n(s.user.birthday?new Date(s.user.birthday).toLocaleDateString("ja-JP"):"-"),1)]),t("tr",null,[e[15]||(e[15]=t("td",{class:"p-1 w-2/5 font-bold"},"ポイント",-1)),s.auth.user.type==1||s.auth.user.type==2?(l(),r("td",J,[c(t("input",{class:"bg-white/90 w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400",type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>i.form.point=o)},null,512),[[_,i.form.point]]),t("div",z,[t("button",{type:"button",onClick:e[1]||(e[1]=o=>a.add_point(500)),class:"px-4 py-2 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-md shadow-md hover:from-green-500 hover:to-blue-600 transition duration-300 ease-in-out transform hover:scale-105"}," +500 PT "),t("button",{type:"button",onClick:e[2]||(e[2]=o=>a.add_point(1e3)),class:"px-4 py-2 bg-gradient-to-r from-purple-400 to-pink-500 text-white rounded-md shadow-md hover:from-purple-500 hover:to-pink-600 transition duration-300 ease-in-out transform hover:scale-105"}," +1,000 PT ")])])):(l(),r("td",I,n(s.user.point.toLocaleString()),1))]),t("tr",null,[e[16]||(e[16]=t("td",{class:"p-1 w-2/5 font-bold"},"EP",-1)),s.auth.user.type==1||s.auth.user.type==2?(l(),r("td",Y,[c(t("input",{class:"bg-white/90 w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400",type:"number","onUpdate:modelValue":e[3]||(e[3]=o=>i.form.dp=o)},null,512),[[_,i.form.dp]])])):(l(),r("td",q,n(s.user.dp.toLocaleString()),1))]),t("tr",null,[e[17]||(e[17]=t("td",{class:"p-1 w-2/5 font-bold"},"消費PT",-1)),t("td",G,n(s.user.consume_point.toLocaleString()),1)])],64)):u("",!0),s.profile?(l(),r(b,{key:1},[t("tr",null,[e[18]||(e[18]=t("td",{class:"p-1 w-2/5 font-bold"},"名前",-1)),t("td",K,n(s.profile.first_name)+" "+n(s.profile.last_name),1)]),t("tr",null,[e[19]||(e[19]=t("td",{class:"p-1 w-2/5 font-bold"},"名前(カナ)",-1)),t("td",Q,n(s.profile.first_name_gana)+" "+n(s.profile.last_name_gana),1)]),t("tr",null,[e[20]||(e[20]=t("td",{class:"p-1 w-2/5 font-bold"},"郵便番号",-1)),t("td",R,n(s.profile.postal_code),1)]),t("tr",null,[e[21]||(e[21]=t("td",{class:"p-1 w-2/5 font-bold"},"都道府県",-1)),t("td",W,n(s.profile.prefecture),1)]),t("tr",null,[e[22]||(e[22]=t("td",{class:"p-1 w-2/5 font-bold"},"住所",-1)),t("td",X,n(s.profile.city)+n(s.profile.street)+"　"+n(s.profile.building),1)]),t("tr",null,[e[23]||(e[23]=t("td",{class:"p-1 w-2/5 font-bold"},"ランク",-1)),t("td",Z,n(s.rank),1)]),s.subscription?(l(),r("tr",$,[e[24]||(e[24]=t("td",{class:"p-1 w-2/5 font-bold"},"サブスクリプション",-1)),t("td",tt,n(s.subscription.plan.name)+" ("+n(s.subscription.plan.amount.toLocaleString("jp-JP",{style:"currency",currency:"JPY"}))+", "+n(s.subscription.plan.point)+" pt)     "+n(s.subscription.starting_date)+" 登録 ",1)])):u("",!0),t("tr",null,[e[25]||(e[25]=t("td",{class:"p-1 w-2/5 font-bold"},"招待コード",-1)),t("td",et,n(s.user.invite_code),1)])],64)):u("",!0),s.auth.user.type==1?(l(),r("tr",st,[e[27]||(e[27]=t("td",{class:"p-1 w-2/5 font-bold"},"アカウント種別",-1)),t("td",ot,[c(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>i.form.type=o),class:"w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400"},[...e[26]||(e[26]=[t("option",{value:"0"},"ユーザー",-1),t("option",{value:"2"},"管理スタッフ",-1),t("option",{value:"3"},"発送スタッフ",-1)])],512),[[L,i.form.type]])])])):u("",!0),s.auth.user.type==1&&s.user.type!=1||s.auth.user.type==2&&s.user.type==0?(l(),r("tr",nt,[e[29]||(e[29]=t("td",{class:"p-1 w-2/5 font-bold"},"アカウント承認",-1)),t("td",rt,[t("div",lt,[e[28]||(e[28]=t("span",{class:"text-sm font-semibold"},"現在のステータス: ",-1)),t("span",{class:f(["px-2 py-1 rounded text-xs font-medium",s.user.status==1?"bg-green-100 text-green-700":s.user.status==0?"bg-orange-100 text-orange-700":s.user.status==2?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"])},[s.user.status==1?(l(),r("span",dt,"アカウントアクティブ")):s.user.status==0?(l(),r("span",it,"アカウント停止")):s.user.status==2?(l(),r("span",at,"アカウント削除")):s.user.status==3?(l(),r("span",ut,"完全削除")):(l(),r("span",mt,"不明"))],2)]),t("div",bt,[t("button",{onClick:e[5]||(e[5]=o=>a.updateStatus(s.user.id,1)),class:f(["px-3 py-1 rounded-md border text-sm font-medium transition-colors",s.user.status==1?"bg-green-500 text-white border-green-500":"bg-white text-green-600 border-green-500 hover:bg-green-50"])}," アクティブにする ",2),t("button",{onClick:e[6]||(e[6]=o=>a.updateStatus(s.user.id,0)),class:f(["px-3 py-1 rounded-md border text-sm font-medium transition-colors",s.user.status==0?"bg-orange-500 text-white border-orange-500":"bg-white text-orange-600 border-orange-500 hover:bg-orange-50"])}," 停止する ",2)])])])):u("",!0),t("tr",null,[e[30]||(e[30]=t("td",{class:"p-1 w-2/5 font-bold"},"タグ",-1)),t("td",ft,[t("div",gt,[t("div",ct,[(l(!0),r(b,null,v(s.user.tags||[],o=>(l(),r("span",{key:o.id,class:"px-3 py-1 rounded-full text-sm font-medium text-white",style:k({backgroundColor:o.color_theme})},n(o.name),5))),128)),!s.user.tags||s.user.tags.length===0?(l(),r("span",pt,"タグなし")):u("",!0)]),t("div",yt,[(l(!0),r(b,null,v(s.allTags,o=>(l(),r("label",{key:o.id,class:f(["flex items-center gap-2 px-3 py-1 border rounded cursor-pointer hover:bg-gray-50",{"bg-blue-50 border-blue-300":a.isTagSelected(o.id)}])},[c(t("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[7]||(e[7]=F=>i.tagForm.tag_ids=F),class:"rounded"},null,8,wt),[[T,i.tagForm.tag_ids]]),t("div",{class:"w-4 h-4 rounded border",style:k({backgroundColor:o.color_theme})},null,4),t("span",xt,n(o.name),1),o.type==="auto"?(l(),r("span",ht," (自動: "+n(a.format_number(o.purchase_amount_limit))+"円) ",1)):u("",!0)],2))),128))]),t("button",{onClick:e[8]||(e[8]=(...o)=>a.assignTags&&a.assignTags(...o)),disabled:i.tagForm.processing,class:"mt-2 px-4 py-2 bg-blue-500 hover:bg-blue-700 text-white rounded-md disabled:opacity-50 text-sm"}," タグを更新 ",8,_t)])])])])]),s.auth.user.type==1?(l(),r("div",vt,[t("button",{type:"button",onClick:e[9]||(e[9]=(...o)=>a.submit&&a.submit(...o)),class:f([{"opacity-25":i.form.processing},"inline-block items-center px-10 py-1 rounded-full font-semibold text-white uppercase bg-theme bg-theme-hover"]),disabled:i.form.processing}," 保存 ",10,kt)])):u("",!0)])]),_:1})],64)}const jt=M(D,[["render",St]]);export{jt as default};
