import{c as i,o as r,b as s,d as h,r as a,a as d,w as x,n as c,e as b,h as _,F as v,f as I,t as f,i as g}from"./app-d5gBoxw1.js";import{A as M}from"./Admin-B_Dl1c39.js";import{r as B,a as H,V as D}from"./ArrowLongUpIcon-DM2N-8vz.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useConfirm-BCJmOtE9.js";function j(e,t){return r(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})])}const S={components:{Head:h.Head,AppLayout:M,Link:h.Link,draggable:D,ArrowLongUpIcon:H,ArrowLongDownIcon:B,PaperAirplaneIcon:j},props:{errors:Object,auth:Object,gachas:Object,category_share:Object,shuffle_mode:Boolean},data(){return{enabled:!0,list:this.gachas.data.map(e=>({...e,fixed:e.order_level>1e6})),dragging:!1,reinitializeLazyLoadingFn:null}},methods:{setReinitializeLazyLoading(e){this.reinitializeLazyLoadingFn=e},log(e){this.refresh_list()},refresh_list(){this.list=[...this.list.filter(e=>e.fixed),...this.list.filter(e=>!e.fixed)],this.$nextTick(()=>{this.reinitializeLazyLoadingFn&&this.reinitializeLazyLoadingFn()})},levelUp(e){let t;for(t=1;t<this.list.length&&this.list[t].id!=e;t++);t<this.list.length&&this.arrayMove(t,t-1),this.refresh_list()},arrayMove(e,t){this.list.splice(t,0,this.list.splice(e,1)[0]),this.refresh_list()},levelDown(e){let t;for(t=0;t<this.list.length-1&&this.list[t].id!=e;t++);t<this.list.length-1&&this.arrayMove(t,t+1),this.refresh_list()},submit(){this.form.gachas=this.list,this.form.post(route("admin.gacha.sorting.store"),{onFinish:()=>{}})},shuffle(){this.list=this.list.map(e=>({value:e,sort:Math.random()})).sort((e,t)=>e.sort-t.sort).map(({value:e})=>e),this.refresh_list()},toggle_shuffle(e){this.form_shuffle_mode.shuffle_mode=e,this.form_shuffle_mode.post(route("admin.gacha.shuffle_mode"),{onFinish:()=>{}})},toggle_fix(e){let t;for(t=0;t<this.list.length;t++)if(this.list[t].id==e){this.list[t].fixed^=!0;break}this.refresh_list()}},setup(e){const t=h.useForm({gachas:[]}),u=h.useForm({shuffle_mode:e.shuffle_mode});return{form:t,form_shuffle_mode:u}},mounted(){}},N=["data-reinit"],U={class:"p-2 justify-end flex gap-3 items-center mb-2"},O=["disabled"],P=["disabled"],T=["disabled"],E={class:"flex mb-4"},R={class:"flex items-center gap-4"},Z=["data-src"],q={class:"flex-1"},G={class:"text-neutral-900 text-sm md:text-base font-semibold mb-1"},J={class:"space-y-0.5"},K={class:"flex items-center"},Q={key:0,class:"text-emerald-600 text-xs"},W={key:1,class:"text-neutral-600 text-xs"},X={class:"text-neutral-700 text-xs md:text-sm"},Y={key:0},$={key:1},tt={key:2,class:"text-rose-600 ml-2"},et={class:"text-neutral-700 text-xs md:text-sm"},st={class:"flex items-center gap-1"},ot=["onClick"],it={key:0,class:"h-4 w-4",viewBox:"0 0 1024 1024",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},rt={key:1,class:"h-4 w-4",viewBox:"-150 -150 1324 1324",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},nt=["onClick"],lt=["onClick"];function at(e,t,u,l,m,n){const w=a("Head"),L=a("PaperAirplaneIcon"),y=a("ArrowLongUpIcon"),k=a("ArrowLongDownIcon"),C=a("draggable"),z=a("AppLayout");return r(),i(v,null,[d(w,{title:"ガチャ並び替え"}),d(z,null,{default:x(({reinitializeLazyLoading:A})=>[s("div",{class:"mt-2 px-2 md:px-6","data-reinit":n.setReinitializeLazyLoading(A)},[s("div",U,[u.shuffle_mode?(r(),i("button",{key:1,type:"button",onClick:t[1]||(t[1]=o=>n.toggle_shuffle(0)),class:c([{"opacity-50":l.form_shuffle_mode.processing},"inline-flex items-center px-4 h-9 bg-neutral-600 text-white text-sm font-medium rounded hover:bg-neutral-700 transition-colors"]),disabled:l.form_shuffle_mode.processing},[...t[3]||(t[3]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),b(" ランダム設定解除 ",-1)])],10,P)):(r(),i("button",{key:0,type:"button",onClick:t[0]||(t[0]=o=>n.toggle_shuffle(1)),class:c([{"opacity-50":l.form_shuffle_mode.processing},"inline-flex items-center px-4 h-9 bg-emerald-500 text-white text-sm font-medium rounded hover:bg-emerald-600 transition-colors"]),disabled:l.form_shuffle_mode.processing}," ランダム設定 ",10,O)),s("button",{onClick:t[2]||(t[2]=_(o=>n.submit(),["prevent"])),class:c([{"opacity-50":l.form.processing},"inline-flex items-center px-4 h-9 bg-cyan-600 text-white text-sm font-medium rounded hover:bg-cyan-700 transition-colors"]),disabled:l.form.processing},[d(L,{class:"w-4 h-4 mr-2"}),t[4]||(t[4]=b(" 保存 ",-1))],10,T)]),s("div",E,[d(C,{class:"dragArea list-group w-full",list:m.list,onChange:n.log},{default:x(()=>[(r(!0),i(v,null,I(m.list,(o,F)=>(r(),i("div",{class:c(["list-group-item m-0 p-2 rounded text-left cursor-move relative border-b border-neutral-700",{"border-l-4 border-b-1 border-emerald-600 bg-neutral-50":o.fixed}]),key:F},[s("div",R,[s("img",{"data-src":o.thumbnail,class:"w-20 md:w-32 h-15 md:h-24 object-contain rounded lazy"},null,8,Z),s("div",q,[s("div",G,f(o.title),1),s("div",J,[s("div",K,[o.status==1?(r(),i("span",Q,"公開")):g("",!0),o.status==0?(r(),i("span",W,"非公開")):g("",!0)]),s("div",X,[o.count_card>0?(r(),i("span",Y,"残: "+f(o.count_rest.toLocaleString())+"/"+f(o.count_card.toLocaleString()),1)):(r(),i("span",$,"残: - / -")),o.count_rest==0?(r(),i("span",tt,"Soldout")):g("",!0)]),s("div",et,[s("span",null,"1回: "+f(o.point.toLocaleString())+" PT",1)])])]),s("div",st,[s("button",{onClick:p=>n.toggle_fix(o.id),class:c(["p-1.5 rounded transition-colors",{"text-neutral-600 bg-neutral-200 hover:bg-neutral-300":!o.fixed,"text-white bg-rose-600 hover:bg-rose-500":o.fixed}])},[o.fixed?(r(),i("svg",it,[...t[5]||(t[5]=[s("path",{d:"M726.646154 466.707692h-9.846154L649.846154 155.569231h17.723077c31.507692 0 57.107692-25.6 57.107692-57.107693s-25.6-57.107692-57.107692-57.107692H356.430769c-31.507692 0-57.107692 25.6-57.107692 57.107692s25.6 57.107692 57.107692 57.107693h17.723077l-64.984615 311.138461h-9.846154c-31.507692 0-57.107692 25.6-57.107692 57.107693s25.6 57.107692 57.107692 57.107692h165.415385v342.646154c0 31.507692 25.6 59.076923 59.076923 59.076923s59.076923-25.6 59.076923-59.076923V582.892308H728.615385c31.507692 0 57.107692-25.6 57.107692-57.107693s-27.569231-59.076923-59.076923-59.076923z"},null,-1)])])):(r(),i("svg",rt,[...t[6]||(t[6]=[s("path",{d:"M974.769231 303.261538L708.923077 37.415385c-27.569231-27.569231-70.892308-27.569231-98.461539 0s-27.569231 70.892308 0 98.461538l13.784616 13.784615-319.015385 210.707693-9.846154-9.846154c-27.569231-27.569231-70.892308-27.569231-98.461538 0s-27.569231 70.892308 0 98.461538l141.784615 141.784616L47.261538 882.215385c-27.569231 27.569231-27.569231 72.861538 0 100.430769 27.569231 27.569231 72.861538 27.569231 100.43077 0L439.138462 689.230769l124.061538 124.061539c27.569231 27.569231 70.892308 27.569231 98.461538 0s27.569231-70.892308 0-98.461539l-9.846153-9.846154 208.738461-320.984615 13.784616 13.784615c27.569231 27.569231 70.892308 27.569231 98.461538 0 27.569231-23.630769 27.569231-66.953846 1.969231-94.523077z"},null,-1)])]))],10,ot),s("button",{onClick:_(p=>n.levelUp(o.id),["prevent"]),class:"p-1.5 rounded bg-neutral-200 hover:bg-neutral-300 transition-colors text-neutral-600"},[d(y,{class:"w-4 h-4"})],8,nt),s("button",{onClick:_(p=>n.levelDown(o.id),["prevent"]),class:"p-1.5 rounded bg-neutral-200 hover:bg-neutral-300 transition-colors text-neutral-600"},[d(k,{class:"w-4 h-4"})],8,lt)])])],2))),128))]),_:1},8,["list","onChange"])])],8,N)]),_:1})],64)}const _t=V(S,[["render",at]]);export{_t as default};
