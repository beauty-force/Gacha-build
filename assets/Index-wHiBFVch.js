import{d as v,r as f,c as d,o as u,a as n,w as c,b as e,t as m,j as p,v as _,F as x,f as y,k as V,h as D,e as g,i as O,n as T}from"./app-eVUcwuVE.js";import{A as P}from"./Admin-CinMh7--.js";import{d as L}from"./index-D0DxAhHq.js";import{P as M}from"./Pagination-CBrLiz7U.js";import{S as z,h as A,V as N,G as R,Y as E,u as H}from"./useConfirm-DuLyikpD.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const{confirm:B}=H(),G={components:{Head:v.Head,AppLayout:P,Dialog:E,DialogPanel:R,DialogTitle:N,TransitionChild:A,TransitionRoot:z,Pagination:M},props:{errors:Object,category_share:Object,products:Object,products_status:Object,search_cond:Object,total:Number,lost_types:Object},data(){return{url2:null,open:!1,csvDialogOpen:!1,csvFile:null,imageFiles:[],csvUploading:!1,point_value:0}},methods:{get_product_status(){let o=this.products_status.map(l=>parseInt(l.products_lost_count)<parseInt(l.gacha_products_count)?` ${l.point.toLocaleString()} ポイントのカードが ${l.gacha_products_count} つ必要です。   現在の在庫数は ${l.products_lost_count}つです。
`:""),t="";return o.forEach(l=>{t=t+l}),t!=""&&(t+=`
`),t},destroy_product_last(o){B("削除してもいいですか？","","error").then(t=>{t&&L.Inertia.delete(route("admin.gacha.product_last.destroy",{id:o}))})},modalProductOpen(o){o?(this.form_last.last_id=o.id,this.form_last.last_name=o.name,this.form_last.last_point=o.point,this.form_last.last_rare=o.rare,this.form_last.last_marks=o.marks,this.form_last.last_lost_type=o.lost_type,this.form_last.last_image="",this.form_last.is_update=1,this.url2=o.image):(this.form_last.last_id="",this.form_last.last_name="",this.form_last.last_point="",this.form_last.last_rare="",this.form_last.last_marks="",this.form_last.last_lost_type="",this.form_last.last_image="",this.form_last.is_update=0,this.url2=""),this.open=!0},submit_last(){this.$refs.photo2.files[0]&&(this.form_last.last_image=this.$refs.photo2.files[0]),this.form_last.post(route("admin.lost_product.create"),{onFinish:()=>{}})},closeModal(){this.open=!1},previewImage2(o){const t=o.target.files[0];this.url2=URL.createObjectURL(t)},search(){this.form_search.get(route("admin.lost_product"))},clear(){this.form_search.rare="",this.form_search.name="",this.form_search.min="",this.form_search.max="",this.search()},onCsvFileChange(o){this.csvFile=o.target.files[0]},onImageFilesChange(o){this.imageFiles=Array.from(o.target.files)},removeImageFile(o){this.imageFiles.splice(o,1)},submitCsv(){if(!this.csvFile){alert("CSVファイルを選択してください");return}this.csvUploading=!0;try{v.useForm({csv:this.csvFile,category_id:this.category_share.cat_id,images:this.imageFiles}).post(route("admin.lost_product.upload_csv"),{preserveScroll:!0,onFinish:()=>{this.csvUploading=!1,this.csvDialogOpen=!1,this.csvFile=null,this.imageFiles=[]}})}catch{alert("アップロードに失敗しました"),this.csvUploading=!1}}},setup(o){let t={last_id:"",last_name:"",last_point:"",last_rare:"",last_marks:"",last_lost_type:"",last_image:"",is_update:0,category_id:o.category_share.cat_id};const l=v.useForm(t),a=v.useForm(o.search_cond);return{form_last:l,form_search:a}},mounted(){}},Y={class:"mt-3 px-5"},J={class:"text-red-600",style:{"white-space":"break-spaces"}},K={class:"flex justify-between items-center mb-2"},Q={class:"text-center flex gap-2"},W={class:"flex items-center gap-2 w-full flex-wrap mb-2 justify-between border p-2 text-sm"},X={class:"flex flex-col gap-2 flex-1"},Z={class:"flex flex-wrap gap-y-2"},$={class:"flex-1 flex items-center gap-2 min-w-[16rem]"},tt={class:"flex-1 flex items-center gap-2 min-w-[16rem]"},et=["value"],st={class:"flex items-center gap-2"},ot={class:"flex flex-col gap-2"},lt={class:"border-neutral-200 border-b flex flex-wrap justify-between items-center gap-2"},at={class:"flex border-neutral-200 items-center"},rt=["src"],nt={class:"flex-1 inline-block text-sm py-1 px-2"},it={class:"text-red-500"},dt={class:"text-center flex flex-wrap gap-2"},ut=["onClick"],mt=["onClick"],ct={class:"fixed inset-0 z-20 overflow-y-auto"},ft={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},pt={class:"mb-4"},_t={class:"text-red-500 text-sm mt-1"},gt={class:"mb-4"},bt={class:"text-red-500 text-sm mt-1"},xt={class:"mb-4"},ht=["value"],vt={class:"text-red-500 text-sm mt-1"},yt={class:"mb-4"},wt={class:"text-red-500 text-sm mt-1"},kt={class:"mb-4"},Ct={class:"text-center w-full"},Ft=["src"],Vt={class:"text-red-500 text-sm mt-1"},Dt={class:"mb-6 text-center"},Ot=["disabled"],St={class:"fixed inset-0 z-40 overflow-y-auto"},Ut={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},jt={class:"mb-4"},It={class:"mb-4"},Tt={key:0,class:"mt-2"},Pt={class:"mt-1 text-sm text-gray-500"},Lt=["onClick"],Mt={class:"flex gap-2 justify-end"},zt=["disabled"],At={key:0},Nt={key:1};function Rt(o,t,l,a,i,r){const S=f("Head"),U=f("Pagination"),h=f("TransitionChild"),w=f("DialogPanel"),k=f("Dialog"),C=f("TransitionRoot"),j=f("DialogTitle"),I=f("AppLayout");return u(),d(x,null,[n(S,{title:"カード設定"}),n(I,{closeModal:r.closeModal},{default:c(()=>[e("div",Y,[e("div",J,m(r.get_product_status()),1),e("div",K,[t[21]||(t[21]=e("h1",{class:"text-lg font-bold"},"カード設定",-1)),e("div",Q,[e("button",{type:"button",onClick:t[0]||(t[0]=s=>i.csvDialogOpen=!0),class:"inline-block px-4 py-2 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700 transition-colors"}," CSVで登録 "),e("button",{type:"button",onClick:t[1]||(t[1]=s=>r.modalProductOpen(0)),class:"inline-block items-center px-10 py-2.5 bg-cyan-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-cyan-700 active:bg-cyan-700 focus:outline-none focus:border-cyan-700 focus:shadow-outline-cyan transition ease-in-out duration-150"}," 追加 ")])]),t[27]||(t[27]=e("hr",{class:"mb-2"},null,-1)),e("div",W,[e("div",X,[e("div",Z,[e("div",$,[t[22]||(t[22]=e("label",{class:"w-16 text-right"},"名前",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.form_search.name=s),type:"text",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[_,a.form_search.name]])]),e("div",tt,[t[24]||(t[24]=e("label",{class:"w-16 text-right"},"レア度",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.form_search.rare=s),id:"last_rare",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm py-0 text-sm"},[t[23]||(t[23]=e("option",{value:""},"全て",-1)),(u(!0),d(x,null,y(l.lost_types,(s,b)=>(u(),d("option",{value:s},m(s),9,et))),256))],512),[[V,a.form_search.rare]])])]),e("div",st,[t[25]||(t[25]=e("label",{class:"w-16 text-right"},"ポイント",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.form_search.min=s),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[_,a.form_search.min]]),t[26]||(t[26]=e("span",null,"~",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.form_search.max=s),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[_,a.form_search.max]])])]),e("div",ot,[e("button",{type:"button",onClick:t[6]||(t[6]=(...s)=>r.clear&&r.clear(...s)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"初期化"),e("button",{type:"button",onClick:t[7]||(t[7]=(...s)=>r.search&&r.search(...s)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"検索")])]),n(U,{search_cond:l.search_cond,route_name:"admin.lost_product",total:l.total},null,8,["search_cond","total"]),(u(!0),d(x,null,y(l.products.data,(s,b)=>(u(),d("div",lt,[e("div",at,[e("img",{src:s.image,class:"w-16 h-16 inline-block object-contain"},null,8,rt),e("div",nt,[e("div",null,m(s.name),1),e("div",null,m(s.rare),1),e("div",null,m(s.marks.toLocaleString()),1),e("div",it,m(s.point.toLocaleString())+"pt",1)])]),e("div",dt,[e("button",{type:"button",onClick:F=>r.modalProductOpen(s),class:"inline-block items-center px-8 py-2 bg-green-500 rounded-md text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150"}," 編集 ",8,ut),e("button",{type:"button",onClick:F=>r.destroy_product_last(s.id),class:"inline-block items-center px-8 py-2 bg-red-500 rounded-md text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150"}," 削除 ",8,mt)])]))),256))]),e("template",null,[n(C,{as:"template",show:i.open},{default:c(()=>[n(k,{as:"div",class:"relative z-20",onClose:t[15]||(t[15]=s=>i.open=!1)},{default:c(()=>[n(h,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>[...t[28]||(t[28]=[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])]),_:1}),e("div",ct,[e("div",ft,[n(h,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:c(()=>[n(w,{class:"p-3 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},{default:c(()=>[e("form",{onSubmit:t[14]||(t[14]=D(s=>r.submit_last(),["prevent"]))},[e("div",pt,[t[29]||(t[29]=e("label",{for:"text1-1",class:"block font-medium text-sm text-neutral-700 mb-1"},[g("名前"),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.form_last.last_name=s),id:"text1-1",type:"text",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください",required:""},null,512),[[_,a.form_last.last_name]]),e("div",_t,m(l.errors.last_name),1)]),e("div",gt,[t[30]||(t[30]=e("label",{for:"text1-2",class:"block font-medium text-sm text-neutral-700 mb-1"},[g("変換ポイント（半角数字）"),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.form_last.last_point=s),id:"text1-2",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください",required:""},null,512),[[_,a.form_last.last_point]]),e("div",bt,m(l.errors.last_point),1)]),e("div",xt,[t[31]||(t[31]=e("label",{for:"text1-3",class:"block font-medium text-sm text-neutral-700 mb-1"},[g("レア度"),e("span",{class:"text-red-500"},"*")],-1)),p(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>a.form_last.last_rare=s),id:"last_rare",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm"},[(u(!0),d(x,null,y(l.lost_types,(s,b)=>(u(),d("option",{value:s},m(s),9,ht))),256))],512),[[V,a.form_last.last_rare]]),e("div",vt,m(l.errors.last_rare),1)]),e("div",yt,[t[32]||(t[32]=e("label",{for:"text1-3",class:"block font-medium text-sm text-neutral-700 mb-1"},[g("点数（半角数字）"),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>a.form_last.last_marks=s),id:"text1-3",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"入力してください",required:""},null,512),[[_,a.form_last.last_marks]]),e("div",wt,m(l.errors.last_marks),1)]),e("div",kt,[t[33]||(t[33]=e("label",{for:"file1-1",class:"block font-medium text-sm text-neutral-700 mb-1"},[g("画像アップロード "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ct,[i.url2?(u(),d("img",{key:0,src:i.url2,class:"inline-block mt-4 h-24"},null,8,Ft)):O("",!0)]),e("input",{onChange:t[12]||(t[12]=(...s)=>r.previewImage2&&r.previewImage2(...s)),ref:"photo2",id:"file1-1",type:"file",class:"w-full"},null,544),e("div",Vt,m(l.errors.last_image),1)]),e("div",Dt,[e("button",{type:"submit",class:T([{"opacity-25":a.form_last.processing},"inline-block items-center px-8 py-2.5 bg-green-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150 mr-2"]),disabled:a.form_last.processing}," 保存 ",10,Ot),e("button",{type:"button",onClick:t[13]||(t[13]=s=>i.open=!1),class:"inline-block items-center px-8 py-2.5 bg-red-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150"}," キャンセル ")])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])]),e("template",null,[n(C,{as:"template",show:i.csvDialogOpen},{default:c(()=>[n(k,{as:"div",class:"relative z-30",onClose:t[20]||(t[20]=s=>i.csvDialogOpen=!1)},{default:c(()=>[n(h,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>[...t[34]||(t[34]=[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])]),_:1}),e("div",St,[e("div",Ut,[n(h,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:c(()=>[n(w,{class:"p-4 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md"},{default:c(()=>[n(j,{class:"text-lg font-bold mb-2"},{default:c(()=>[...t[35]||(t[35]=[g("CSVでカード登録",-1)])]),_:1}),t[40]||(t[40]=e("div",{class:"mb-4"},[e("a",{href:"/gacha_csv/lost_product.csv",download:"",class:"text-blue-600 underline"},"CSVテンプレートをダウンロード")],-1)),e("form",{onSubmit:t[19]||(t[19]=D((...s)=>r.submitCsv&&r.submitCsv(...s),["prevent"]))},[e("div",jt,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CSVファイル",-1)),e("input",{type:"file",accept:".csv",onChange:t[16]||(t[16]=(...s)=>r.onCsvFileChange&&r.onCsvFileChange(...s)),class:"w-full"},null,32)]),e("div",It,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"画像ファイル",-1)),e("input",{type:"file",multiple:"",accept:"image/*",onChange:t[17]||(t[17]=(...s)=>r.onImageFilesChange&&r.onImageFilesChange(...s)),class:"w-full"},null,32),t[39]||(t[39]=e("p",{class:"text-sm text-gray-500 mt-1"}," 画像ファイルは任意です。CSVに記載された画像名と一致するファイルを選択してください。",-1)),i.imageFiles.length>0?(u(),d("div",Tt,[t[37]||(t[37]=e("p",{class:"text-sm font-medium text-gray-700"},"選択された画像:",-1)),e("ul",Pt,[(u(!0),d(x,null,y(i.imageFiles,(s,b)=>(u(),d("li",{key:b,class:"flex items-center gap-2"},[e("span",null,m(s.name),1),e("button",{type:"button",onClick:F=>r.removeImageFile(b),class:"text-red-500 hover:text-red-700"}," × ",8,Lt)]))),128))])])):O("",!0)]),e("div",Mt,[e("button",{type:"button",onClick:t[18]||(t[18]=s=>i.csvDialogOpen=!1),class:"px-4 py-2 bg-neutral-300 text-neutral-700 rounded hover:bg-neutral-400"},"キャンセル"),e("button",{type:"submit",disabled:i.csvUploading,class:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed"},[i.csvUploading?(u(),d("span",At,"アップロード中...")):(u(),d("span",Nt,"登録"))],8,zt)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1},8,["closeModal"])],64)}const Kt=q(G,[["render",Rt]]);export{Kt as default};
