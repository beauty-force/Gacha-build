import{q as f,o as n,c as a,b,D,w as C,V as $,F as x,H as K,d as e,L as O,e as y,t as u,n as q,f as p,h as g,I as _,J as G,K as Q,a as W,E as X,a6 as Y,a7 as Z}from"./app.6a0dd5ab.js";import{U as ee}from"./UserLayout.689a8ce9.js";import{h as L}from"./useConfirm.d4a8d6d1.js";import{_ as te}from"./_plugin-vue_export-helper.cdc0426e.js";import"./index.b9ea8fd5.js";const i=o=>(Y("data-v-ae6494be"),o=o(),Z(),o),se={class:"py-3 md:py-4"},oe={class:"max-w-4xl mx-auto px-4 lg:px-8"},le={class:"mb-4"},ne=i(()=>e("svg",{class:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),ae={class:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden mb-4"},ie={class:"p-4 bg-gradient-to-r from-yellow-50 to-amber-50 border-b border-gray-200"},re={class:"flex items-start justify-between mb-2"},de={class:"font-bold text-gray-900 text-lg flex-1"},ce={class:"text-xs text-gray-500"},ue={class:"p-4 bg-gray-50 border-b border-gray-200"},he=i(()=>e("h4",{class:"text-xs font-semibold text-gray-700 mb-2 flex items-center"},[e("svg",{class:"w-4 h-4 mr-1 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),y(" \u3042\u306A\u305F\u306E\u8CEA\u554F ")],-1)),ge={class:"text-sm text-gray-700 whitespace-pre-line"},me={key:0,class:"mt-3"},ve={class:"grid grid-cols-3 gap-2"},fe=["onClick"],xe=["src","alt"],be={key:0,class:"p-4"},pe={class:"text-sm font-bold text-gray-900 mb-4 flex items-center"},_e=i(()=>e("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),ye={class:"space-y-4"},we={key:0,class:"flex justify-end"},ke={class:"max-w-[85%] bg-blue-50 border border-blue-200 rounded-lg p-3"},Ce={class:"flex items-center gap-1.5 mb-1.5"},je=i(()=>e("svg",{class:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)),Me=i(()=>e("span",{class:"text-xs font-bold text-blue-700"},"\u30B5\u30DD\u30FC\u30C8",-1)),qe={class:"text-xs text-gray-500"},Ie={class:"text-sm text-gray-800 whitespace-pre-line"},Be={key:0,class:"mt-2 grid grid-cols-3 gap-1.5"},Se=["src","onClick"],ze={key:1,class:"flex justify-start"},De={class:"max-w-[85%] bg-white border border-gray-300 rounded-lg p-3"},$e={class:"flex items-center gap-1.5 mb-1.5"},Le=i(()=>e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),Re=i(()=>e("span",{class:"text-xs font-bold text-gray-700"},"\u3042\u306A\u305F",-1)),Ve={class:"text-xs text-gray-500"},Ee={class:"text-sm text-gray-800 whitespace-pre-line"},Fe={key:0,class:"mt-2 grid grid-cols-3 gap-1.5"},Te=["src","onClick"],Ne=i(()=>e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1)),Ue={key:1,class:"p-4"},Ae=i(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start"},[e("svg",{class:"w-6 h-6 text-yellow-600 mr-3 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",null,[e("p",{class:"text-sm font-semibold text-yellow-800 mb-1"},"\u56DE\u7B54\u3092\u304A\u5F85\u3061\u304F\u3060\u3055\u3044"),e("p",{class:"text-xs text-yellow-700"},"\u901A\u5E381-2\u55B6\u696D\u65E5\u4EE5\u5185\u306B\u3054\u56DE\u7B54\u3044\u305F\u3057\u307E\u3059")])],-1)),Je=[Ae],He={class:"flex flex-col items-center justify-center h-screen p-4 gap-2"},Pe=i(()=>e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-90 transition-opacity"},null,-1)),Ke={class:"relative z-10 flex items-center justify-center gap-4 w-full max-w-6xl flex-shrink-0"},Oe=i(()=>e("div",{class:"flex-1"},null,-1)),Ge={class:"px-4 py-2 bg-white rounded-full text-gray-900 text-sm font-bold shadow-xl"},Qe={class:"flex-1 flex justify-end"},We=["onClick"],Xe=i(()=>e("svg",{class:"w-6 h-6 text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M6 18L18 6M6 6l12 12"})],-1)),Ye=[Xe],Ze={class:"relative z-10 flex flex-col items-center w-full max-w-6xl flex-1 min-h-0 gap-2"},et={class:"flex-1 flex items-center justify-center min-h-0 w-full"},tt=["src"],st={key:0,class:"flex items-center justify-center gap-3 flex-shrink-0"},ot=["onClick","disabled"],lt=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M15 19l-7-7 7-7"})],-1)),nt=[lt],at=["onClick","disabled"],it=i(()=>e("svg",{class:"w-6 h-6 text-gray-800 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M9 5l7 7-7 7"})],-1)),rt=[it],dt={key:0,class:"fixed inset-0 z-[9999]"},ct={class:"flex items-center justify-center min-h-screen px-4 py-4"},ut=i(()=>e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-75"},null,-1)),ht={class:"relative bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 z-10"},gt=i(()=>e("h3",{class:"text-lg font-bold text-gray-900"},"\u8FD4\u4FE1\u3092\u9001\u4FE1",-1)),mt=i(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),vt=[mt],ft=["onSubmit"],xt={class:"mb-4"},bt={class:"mb-4"},pt=i(()=>e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[y(" \u753B\u50CF\u3092\u6DFB\u4ED8 "),e("span",{class:"text-gray-500 text-xs font-normal"},"(\u4EFB\u610F\u3001\u6700\u59273\u679A)")],-1)),_t={key:0,class:"mt-2 grid grid-cols-3 gap-2"},yt=["src"],wt=["onClick"],kt=i(()=>e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Ct=[kt],jt={class:"flex gap-3 justify-end"},Mt=["disabled"],qt={__name:"Show",props:{question:Object},setup(o){const R=o,h=f(null),d=f(0),j=f(!1),v=f(""),m=f([]),V=f(null),w=f(!1),M=(s,l)=>{h.value=s,d.value=l},I=()=>{h.value=null,d.value=0},E=()=>{d.value<h.value.length-1&&d.value++},F=()=>{d.value>0&&d.value--},B=s=>{let l=[...s.images||[]];return s.replies&&s.replies.forEach(t=>{l=l.concat(t.images||[])}),l},S=(s,l,t)=>{let r=(s.images||[]).length;for(let c of s.replies){if(c.id===l.id)return r+t;r+=(c.images||[]).length}return 0},T=()=>{v.value="",m.value=[],j.value=!0},k=()=>{j.value=!1,v.value="",m.value=[]},N=s=>{const l=Array.from(s.target.files);if(m.value.length+l.length>3){alert("\u753B\u50CF\u306F\u6700\u59273\u679A\u307E\u3067\u3067\u3059");return}l.forEach(t=>{const r=new FileReader;r.onload=c=>{m.value.push({file:t,preview:c.target.result})},r.readAsDataURL(t)}),s.target.value=""},U=s=>{m.value.splice(s,1)},A=async()=>{if(!v.value.trim())return;w.value=!0;const s=new FormData;s.append("message",v.value),m.value.forEach((l,t)=>{s.append(`images[${t}]`,l.file)});try{const l=await W.post(route("user.support-question.reply",R.question.id),s,{headers:{"Content-Type":"multipart/form-data"}});k(),await L.fire({icon:"success",title:"\u9001\u4FE1\u5B8C\u4E86",text:l.data.message,confirmButtonColor:"#3b82f6"}),X.Inertia.reload()}catch{k(),await L.fire({icon:"error",title:"\u30A8\u30E9\u30FC",text:"\u9001\u4FE1\u306B\u5931\u6557\u3057\u307E\u3057\u305F"})}finally{w.value=!1}},z=s=>new Date(s).toLocaleDateString("ja-JP",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),J=s=>({pending:"\u5BFE\u5FDC\u4E2D",answered:"\u5B8C\u4E86",closed:"\u30AF\u30ED\u30FC\u30BA"})[s]||s,H=s=>new Date(s).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(s,l)=>(n(),a(x,null,[b(D(K),{title:"\u304A\u554F\u3044\u5408\u308F\u305B\u8A73\u7D30"}),b(ee,null,{default:C(()=>[e("div",se,[e("div",oe,[e("div",le,[b(D(O),{href:s.route("user.support-question.index"),class:"inline-flex items-center text-gray-600 hover:text-yellow-600 font-semibold text-sm"},{default:C(()=>[ne,y(" \u304A\u554F\u3044\u5408\u308F\u305B\u4E00\u89A7\u306B\u623B\u308B ")]),_:1},8,["href"])]),e("div",ae,[e("div",ie,[e("div",re,[e("h1",de,u(o.question.subject),1),e("span",{class:q({"px-3 py-1 text-xs font-semibold rounded-full ml-2 whitespace-nowrap":!0,"bg-yellow-100 text-yellow-700":o.question.status==="pending","bg-green-100 text-green-700":o.question.status==="answered","bg-gray-100 text-gray-700":o.question.status==="closed"})},u(J(o.question.status)),3)]),e("div",ce,u(H(o.question.created_at)),1)]),e("div",ue,[he,e("p",ge,u(o.question.question),1),o.question.images&&o.question.images.length>0?(n(),a("div",me,[e("div",ve,[(n(!0),a(x,null,p(o.question.images,(t,r)=>(n(),a("div",{key:r,class:"relative bg-white rounded-lg overflow-hidden border border-gray-200 cursor-pointer hover:border-yellow-400 transition-all",onClick:c=>M(o.question.images,r)},[e("img",{src:`/images/support_questions/${t}`,alt:`\u6DFB\u4ED8\u753B\u50CF ${r+1}`,class:"w-full h-full object-contain"},null,8,xe)],8,fe))),128))])])):g("",!0)]),o.question.replies&&o.question.replies.length>0?(n(),a("div",be,[e("h3",pe,[_e,y(" \u4F1A\u8A71\u5C65\u6B74 ("+u(o.question.replies.length)+") ",1)]),e("div",ye,[(n(!0),a(x,null,p(o.question.replies,t=>(n(),a("div",{key:t.id},[t.is_admin?(n(),a("div",we,[e("div",ke,[e("div",Ce,[je,Me,e("span",qe,u(z(t.created_at)),1)]),e("p",Ie,u(t.message),1),t.images&&t.images.length>0?(n(),a("div",Be,[(n(!0),a(x,null,p(t.images,(r,c)=>(n(),a("img",{key:c,src:`/images/support_questions/${r}`,class:"w-full h-16 object-cover rounded cursor-pointer border border-blue-100",onClick:P=>M(B(o.question),S(o.question,t,c))},null,8,Se))),128))])):g("",!0)])])):(n(),a("div",ze,[e("div",De,[e("div",$e,[Le,Re,e("span",Ve,u(z(t.created_at)),1)]),e("p",Ee,u(t.message),1),t.images&&t.images.length>0?(n(),a("div",Fe,[(n(!0),a(x,null,p(t.images,(r,c)=>(n(),a("img",{key:c,src:`/images/support_questions/${r}`,class:"w-full h-16 object-cover rounded cursor-pointer border border-gray-200",onClick:P=>M(B(o.question),S(o.question,t,c))},null,8,Te))),128))])):g("",!0)])]))]))),128))]),e("div",{class:"mt-4 pt-4 border-t border-gray-200"},[e("button",{onClick:T,class:"w-full px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold text-sm rounded-lg transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2"},[Ne,y(" \u8FD4\u4FE1\u3059\u308B ")])])])):g("",!0),!o.question.replies||o.question.replies.length===0?(n(),a("div",Ue,Je)):g("",!0)])])])]),_:1}),b($,{name:"modal"},{default:C(()=>[h.value?(n(),a("div",{key:0,class:"fixed inset-0 z-[9999]",onClick:I},[e("div",He,[Pe,e("div",Ke,[Oe,e("div",Ge,u(d.value+1)+" / "+u(h.value.length),1),e("div",Qe,[e("button",{onClick:_(I,["stop"]),class:"p-3 bg-white rounded-full hover:bg-gray-100 transition-colors shadow-xl",type:"button",title:"\u9589\u3058\u308B"},Ye,8,We)])]),e("div",Ze,[e("div",et,[e("img",{src:`/images/support_questions/${h.value[d.value]}`,alt:"\u62E1\u5927\u753B\u50CF",class:"max-w-full max-h-full w-auto h-auto object-contain rounded-lg shadow-2xl border-4 border-white",onClick:l[0]||(l[0]=_(()=>{},["stop"]))},null,8,tt)]),h.value.length>1?(n(),a("div",st,[e("button",{onClick:_(F,["stop"]),disabled:d.value===0,class:q({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value>0,"bg-gray-300 cursor-not-allowed opacity-50":d.value===0}),type:"button",title:"\u524D\u3078"},nt,10,ot),e("button",{onClick:_(E,["stop"]),disabled:d.value>=h.value.length-1,class:q({"p-3 rounded-full transition-all shadow-xl group":!0,"bg-white hover:bg-gray-100":d.value<h.value.length-1,"bg-gray-300 cursor-not-allowed opacity-50":d.value>=h.value.length-1}),type:"button",title:"\u6B21\u3078"},rt,10,at)])):g("",!0)])])])):g("",!0)]),_:1}),b($,{name:"modal"},{default:C(()=>[j.value?(n(),a("div",dt,[e("div",ct,[ut,e("div",ht,[e("div",{class:"flex items-center justify-between mb-4"},[gt,e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600"},vt)]),e("form",{onSubmit:_(A,["prevent"])},[e("div",xt,[G(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=t=>v.value=t),rows:"5",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"\u8FD4\u4FE1\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044...",required:""},null,512),[[Q,v.value]])]),e("div",bt,[pt,e("input",{type:"file",ref_key:"replyImageInput",ref:V,accept:"image/*",multiple:"",onChange:N,class:"hidden"},null,544),e("button",{type:"button",onClick:l[2]||(l[2]=t=>s.$refs.replyImageInput.click()),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50"}," \u753B\u50CF\u3092\u9078\u629E "),m.value.length>0?(n(),a("div",_t,[(n(!0),a(x,null,p(m.value,(t,r)=>(n(),a("div",{key:r,class:"relative"},[e("img",{src:t.preview,class:"w-full h-20 object-cover rounded"},null,8,yt),e("button",{type:"button",onClick:c=>U(r),class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1"},Ct,8,wt)]))),128))])):g("",!0)]),e("div",jt,[e("button",{type:"button",onClick:k,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-lg"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),e("button",{type:"submit",disabled:w.value||!v.value.trim(),class:"px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg disabled:opacity-50"},u(w.value?"\u9001\u4FE1\u4E2D...":"\u9001\u4FE1"),9,Mt)])],40,ft)])])])):g("",!0)]),_:1})],64))}},$t=te(qt,[["__scopeId","data-v-ae6494be"]]);export{$t as default};
