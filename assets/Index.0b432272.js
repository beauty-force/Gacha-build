import{H as T,E as P,G as y,r as _,o as d,c,b as n,w as m,F as b,d as e,t as u,J as f,K as p,a1 as U,f as v,I as V,h as D,n as L,e as h}from"./app.0eb71d99.js";import{A as M}from"./Admin.e0ad1771.js";import{P as N}from"./Pagination.68726eb5.js";import{N as z,e as A,U as R,o as H,f as q,u as B}from"./useConfirm.2f2cdaff.js";import{_ as E}from"./_plugin-vue_export-helper.cdc0426e.js";import"./ChevronRightIcon.b31d053e.js";import"./EllipsisHorizontalIcon.6713afab.js";const{confirm:G}=B(),J={components:{Head:T,AppLayout:M,Dialog:z,DialogPanel:A,DialogTitle:R,TransitionChild:H,TransitionRoot:q,Pagination:N},props:{errors:Object,category_share:Object,products:Object,products_status:Object,search_cond:Object,total:Number,lost_types:Object},data(){return{url2:null,open:!1,csvDialogOpen:!1,csvFile:null,imageFiles:[],csvUploading:!1,point_value:0}},methods:{get_product_status(){let o=this.products_status.map(a=>parseInt(a.products_lost_count)<parseInt(a.gacha_products_count)?` ${a.point.toLocaleString()} \u30DD\u30A4\u30F3\u30C8\u306E\u30AB\u30FC\u30C9\u304C ${a.gacha_products_count} \u3064\u5FC5\u8981\u3067\u3059\u3002   \u73FE\u5728\u306E\u5728\u5EAB\u6570\u306F ${a.products_lost_count}\u3064\u3067\u3059\u3002
`:""),t="";return o.forEach(a=>{t=t+a}),t!=""&&(t+=`
`),t},destroy_product_last(o){G("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F","","error").then(t=>{t&&P.Inertia.delete(route("admin.gacha.product_last.destroy",{id:o}))})},modalProductOpen(o){o?(this.form_last.last_id=o.id,this.form_last.last_name=o.name,this.form_last.last_point=o.point,this.form_last.last_rare=o.rare,this.form_last.last_marks=o.marks,this.form_last.last_lost_type=o.lost_type,this.form_last.last_image="",this.form_last.is_update=1,this.url2=o.image):(this.form_last.last_id="",this.form_last.last_name="",this.form_last.last_point="",this.form_last.last_rare="",this.form_last.last_marks="",this.form_last.last_lost_type="",this.form_last.last_image="",this.form_last.is_update=0,this.url2=""),this.open=!0},submit_last(){this.$refs.photo2.files[0]&&(this.form_last.last_image=this.$refs.photo2.files[0]),this.form_last.post(route("admin.lost_product.create"),{onFinish:()=>{}})},closeModal(){this.open=!1},previewImage2(o){const t=o.target.files[0];this.url2=URL.createObjectURL(t)},search(){this.form_search.get(route("admin.lost_product"))},clear(){this.form_search.rare="",this.form_search.name="",this.form_search.min="",this.form_search.max="",this.search()},onCsvFileChange(o){this.csvFile=o.target.files[0]},onImageFilesChange(o){this.imageFiles=Array.from(o.target.files)},removeImageFile(o){this.imageFiles.splice(o,1)},submitCsv(){if(!this.csvFile){alert("CSV\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044");return}this.csvUploading=!0;try{y({csv:this.csvFile,category_id:this.category_share.cat_id,images:this.imageFiles}).post(route("admin.lost_product.upload_csv"),{preserveScroll:!0,onFinish:()=>{this.csvUploading=!1,this.csvDialogOpen=!1,this.csvFile=null,this.imageFiles=[]}})}catch{alert("\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F"),this.csvUploading=!1}}},setup(o){let t={last_id:"",last_name:"",last_point:"",last_rare:"",last_marks:"",last_lost_type:"",last_image:"",is_update:0,category_id:o.category_share.cat_id};const a=y(t),l=y(o.search_cond);return{form_last:a,form_search:l}},mounted(){}},K={class:"mt-3 px-5"},Q={class:"text-red-600",style:{"white-space":"break-spaces"}},W={class:"flex justify-between items-center mb-2"},X=e("h1",{class:"text-lg font-bold"},"\u30AB\u30FC\u30C9\u8A2D\u5B9A",-1),Y={class:"text-center flex gap-2"},Z=e("hr",{class:"mb-2"},null,-1),$={class:"flex items-center gap-2 w-full flex-wrap mb-2 justify-between border p-2 text-sm"},ee={class:"flex flex-col gap-2 flex-1"},te={class:"flex flex-wrap gap-y-2"},se={class:"flex-1 flex items-center gap-2 min-w-[16rem]"},oe=e("label",{class:"w-16 text-right"},"\u540D\u524D",-1),ae={class:"flex-1 flex items-center gap-2 min-w-[16rem]"},le=e("label",{class:"w-16 text-right"},"\u30EC\u30A2\u5EA6",-1),re=e("option",{value:""},"\u5168\u3066",-1),ne=["value"],ie={class:"flex items-center gap-2"},de=e("label",{class:"w-16 text-right"},"\u30DD\u30A4\u30F3\u30C8",-1),ce=e("span",null,"~",-1),ue={class:"flex flex-col gap-2"},me={class:"border-neutral-200 border-b flex flex-wrap justify-between items-center gap-2"},_e={class:"flex border-neutral-200 items-center"},fe=["src"],pe={class:"flex-1 inline-block text-sm py-1 px-2"},he={class:"text-red-500"},ge={class:"text-center flex flex-wrap gap-2"},be=["onClick"],xe=["onClick"],ve=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),ye={class:"fixed inset-0 z-20 overflow-y-auto"},we={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},ke={class:"mb-4"},Ce=e("label",{for:"text1-1",class:"block font-medium text-sm text-neutral-700 mb-1"},[h("\u540D\u524D"),e("span",{class:"text-red-500"},"*")],-1),Fe={class:"text-red-500 text-sm mt-1"},Ue={class:"mb-4"},Ve=e("label",{for:"text1-2",class:"block font-medium text-sm text-neutral-700 mb-1"},[h("\u5909\u63DB\u30DD\u30A4\u30F3\u30C8\uFF08\u534A\u89D2\u6570\u5B57\uFF09"),e("span",{class:"text-red-500"},"*")],-1),De={class:"text-red-500 text-sm mt-1"},Oe={class:"mb-4"},je=e("label",{for:"text1-3",class:"block font-medium text-sm text-neutral-700 mb-1"},[h("\u30EC\u30A2\u5EA6"),e("span",{class:"text-red-500"},"*")],-1),Se=["value"],Ie={class:"text-red-500 text-sm mt-1"},Te={class:"mb-4"},Pe=e("label",{for:"text1-3",class:"block font-medium text-sm text-neutral-700 mb-1"},[h("\u70B9\u6570\uFF08\u534A\u89D2\u6570\u5B57\uFF09"),e("span",{class:"text-red-500"},"*")],-1),Le={class:"text-red-500 text-sm mt-1"},Me={class:"mb-4"},Ne=e("label",{for:"file1-1",class:"block font-medium text-sm text-neutral-700 mb-1"},[h("\u753B\u50CF\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9 "),e("span",{class:"text-red-500"},"*")],-1),ze={class:"text-center w-full"},Ae=["src"],Re={class:"text-red-500 text-sm mt-1"},He={class:"mb-6 text-center"},qe=["disabled"],Be=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Ee={class:"fixed inset-0 z-40 overflow-y-auto"},Ge={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},Je=e("div",{class:"mb-4"},[e("a",{href:"/gacha_csv/lost_product.csv",download:"",class:"text-blue-600 underline"},"CSV\u30C6\u30F3\u30D7\u30EC\u30FC\u30C8\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9")],-1),Ke={class:"mb-4"},Qe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CSV\u30D5\u30A1\u30A4\u30EB",-1),We={class:"mb-4"},Xe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u753B\u50CF\u30D5\u30A1\u30A4\u30EB",-1),Ye=e("p",{class:"text-sm text-gray-500 mt-1"}," \u753B\u50CF\u30D5\u30A1\u30A4\u30EB\u306F\u4EFB\u610F\u3067\u3059\u3002CSV\u306B\u8A18\u8F09\u3055\u308C\u305F\u753B\u50CF\u540D\u3068\u4E00\u81F4\u3059\u308B\u30D5\u30A1\u30A4\u30EB\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044\u3002",-1),Ze={key:0,class:"mt-2"},$e=e("p",{class:"text-sm font-medium text-gray-700"},"\u9078\u629E\u3055\u308C\u305F\u753B\u50CF:",-1),et={class:"mt-1 text-sm text-gray-500"},tt=["onClick"],st={class:"flex gap-2 justify-end"},ot=["disabled"],at={key:0},lt={key:1};function rt(o,t,a,l,i,r){const O=_("Head"),j=_("Pagination"),x=_("TransitionChild"),w=_("DialogPanel"),k=_("Dialog"),C=_("TransitionRoot"),S=_("DialogTitle"),I=_("AppLayout");return d(),c(b,null,[n(O,{title:"\u30AB\u30FC\u30C9\u8A2D\u5B9A"}),n(I,{closeModal:r.closeModal},{default:m(()=>[e("div",K,[e("div",Q,u(r.get_product_status()),1),e("div",W,[X,e("div",Y,[e("button",{type:"button",onClick:t[0]||(t[0]=s=>i.csvDialogOpen=!0),class:"inline-block px-4 py-2 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700 transition-colors"}," CSV\u3067\u767B\u9332 "),e("button",{type:"button",onClick:t[1]||(t[1]=s=>r.modalProductOpen(0)),class:"inline-block items-center px-10 py-2.5 bg-cyan-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-cyan-700 active:bg-cyan-700 focus:outline-none focus:border-cyan-700 focus:shadow-outline-cyan transition ease-in-out duration-150"}," \u8FFD\u52A0 ")])]),Z,e("div",$,[e("div",ee,[e("div",te,[e("div",se,[oe,f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.form_search.name=s),type:"text",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[p,l.form_search.name]])]),e("div",ae,[le,f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.form_search.rare=s),id:"last_rare",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm py-0 text-sm"},[re,(d(!0),c(b,null,v(a.lost_types,(s,g)=>(d(),c("option",{value:s},u(s),9,ne))),256))],512),[[U,l.form_search.rare]])])]),e("div",ie,[de,f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.form_search.min=s),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[p,l.form_search.min]]),ce,f(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.form_search.max=s),type:"number",class:"h-9 flex-1 w-16 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[p,l.form_search.max]])])]),e("div",ue,[e("button",{type:"button",onClick:t[6]||(t[6]=(...s)=>r.clear&&r.clear(...s)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"\u521D\u671F\u5316"),e("button",{type:"button",onClick:t[7]||(t[7]=(...s)=>r.search&&r.search(...s)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"\u691C\u7D22")])]),n(j,{search_cond:a.search_cond,route_name:"admin.lost_product",total:a.total},null,8,["search_cond","total"]),(d(!0),c(b,null,v(a.products.data,(s,g)=>(d(),c("div",me,[e("div",_e,[e("img",{src:s.image,class:"w-16 h-16 inline-block object-contain"},null,8,fe),e("div",pe,[e("div",null,u(s.name),1),e("div",null,u(s.rare),1),e("div",null,u(s.marks.toLocaleString()),1),e("div",he,u(s.point.toLocaleString())+"pt",1)])]),e("div",ge,[e("button",{type:"button",onClick:F=>r.modalProductOpen(s),class:"inline-block items-center px-8 py-2 bg-green-500 rounded-md text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150"}," \u7DE8\u96C6 ",8,be),e("button",{type:"button",onClick:F=>r.destroy_product_last(s.id),class:"inline-block items-center px-8 py-2 bg-red-500 rounded-md text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150"}," \u524A\u9664 ",8,xe)])]))),256))]),e("template",null,[n(C,{as:"template",show:i.open},{default:m(()=>[n(k,{as:"div",class:"relative z-20",onClose:t[15]||(t[15]=s=>i.open=!1)},{default:m(()=>[n(x,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[ve]),_:1}),e("div",ye,[e("div",we,[n(x,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:m(()=>[n(w,{class:"p-3 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},{default:m(()=>[e("form",{onSubmit:t[14]||(t[14]=V(s=>r.submit_last(),["prevent"]))},[e("div",ke,[Ce,f(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.form_last.last_name=s),id:"text1-1",type:"text",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",required:""},null,512),[[p,l.form_last.last_name]]),e("div",Fe,u(a.errors.last_name),1)]),e("div",Ue,[Ve,f(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.form_last.last_point=s),id:"text1-2",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",required:""},null,512),[[p,l.form_last.last_point]]),e("div",De,u(a.errors.last_point),1)]),e("div",Oe,[je,f(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>l.form_last.last_rare=s),id:"last_rare",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm"},[(d(!0),c(b,null,v(a.lost_types,(s,g)=>(d(),c("option",{value:s},u(s),9,Se))),256))],512),[[U,l.form_last.last_rare]]),e("div",Ie,u(a.errors.last_rare),1)]),e("div",Te,[Pe,f(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>l.form_last.last_marks=s),id:"text1-3",type:"number",class:"w-full border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300",placeholder:"\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",required:""},null,512),[[p,l.form_last.last_marks]]),e("div",Le,u(a.errors.last_marks),1)]),e("div",Me,[Ne,e("div",ze,[i.url2?(d(),c("img",{key:0,src:i.url2,class:"inline-block mt-4 h-24"},null,8,Ae)):D("",!0)]),e("input",{onChange:t[12]||(t[12]=(...s)=>r.previewImage2&&r.previewImage2(...s)),ref:"photo2",id:"file1-1",type:"file",class:"w-full"},null,544),e("div",Re,u(a.errors.last_image),1)]),e("div",He,[e("button",{type:"submit",class:L([{"opacity-25":l.form_last.processing},"inline-block items-center px-8 py-2.5 bg-green-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150 mr-2"]),disabled:l.form_last.processing}," \u4FDD\u5B58 ",10,qe),e("button",{type:"button",onClick:t[13]||(t[13]=s=>i.open=!1),class:"inline-block items-center px-8 py-2.5 bg-red-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150"}," \u30AD\u30E3\u30F3\u30BB\u30EB ")])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])]),e("template",null,[n(C,{as:"template",show:i.csvDialogOpen},{default:m(()=>[n(k,{as:"div",class:"relative z-30",onClose:t[20]||(t[20]=s=>i.csvDialogOpen=!1)},{default:m(()=>[n(x,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[Be]),_:1}),e("div",Ee,[e("div",Ge,[n(x,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:m(()=>[n(w,{class:"p-4 relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-md"},{default:m(()=>[n(S,{class:"text-lg font-bold mb-2"},{default:m(()=>[h("CSV\u3067\u30AB\u30FC\u30C9\u767B\u9332")]),_:1}),Je,e("form",{onSubmit:t[19]||(t[19]=V((...s)=>r.submitCsv&&r.submitCsv(...s),["prevent"]))},[e("div",Ke,[Qe,e("input",{type:"file",accept:".csv",onChange:t[16]||(t[16]=(...s)=>r.onCsvFileChange&&r.onCsvFileChange(...s)),class:"w-full"},null,32)]),e("div",We,[Xe,e("input",{type:"file",multiple:"",accept:"image/*",onChange:t[17]||(t[17]=(...s)=>r.onImageFilesChange&&r.onImageFilesChange(...s)),class:"w-full"},null,32),Ye,i.imageFiles.length>0?(d(),c("div",Ze,[$e,e("ul",et,[(d(!0),c(b,null,v(i.imageFiles,(s,g)=>(d(),c("li",{key:g,class:"flex items-center gap-2"},[e("span",null,u(s.name),1),e("button",{type:"button",onClick:F=>r.removeImageFile(g),class:"text-red-500 hover:text-red-700"}," \xD7 ",8,tt)]))),128))])])):D("",!0)]),e("div",st,[e("button",{type:"button",onClick:t[18]||(t[18]=s=>i.csvDialogOpen=!1),class:"px-4 py-2 bg-neutral-300 text-neutral-700 rounded hover:bg-neutral-400"},"\u30AD\u30E3\u30F3\u30BB\u30EB"),e("button",{type:"submit",disabled:i.csvUploading,class:"px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed"},[i.csvUploading?(d(),c("span",at,"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D...")):(d(),c("span",lt,"\u767B\u9332"))],8,ot)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])]),_:1},8,["closeModal"])],64)}const ft=E(J,[["render",rt]]);export{ft as default};
