import{z as O,l as j,L as B,u as E,E as G,r as w,o as s,c as a,d as e,b as u,w as _,h as l,t as c,e as m,n as k,F as p,Y as F}from"./app.61d61bea.js";import{G as A}from"./GachaButtons.57c7e7f6.js";import{u as H}from"./useConfirm.f452735d.js";import{_ as q}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as R}from"./PlayIcon.b1ab9d55.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const f=1e3,g=60*f,x=60*g,L=24*x,I="abort",N="end",z="progress",T="start",D="visibilitychange";var P=O({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:n=>n>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:n=>n>=0},transform:{type:Function,default:n=>n}},emits:[I,N,z,T],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/L)},hours(){return Math.floor(this.totalMilliseconds%L/x)},minutes(){return Math.floor(this.totalMilliseconds%x/g)},seconds(){return Math.floor(this.totalMilliseconds%g/f)},milliseconds(){return Math.floor(this.totalMilliseconds%f)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/x)},totalMinutes(){return Math.floor(this.totalMilliseconds/g)},totalSeconds(){return Math.floor(this.totalMilliseconds/f)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(D,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(D,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(T),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const n=Math.min(this.totalMilliseconds,this.interval);if(n>0){let i,t;const h=r=>{i||(i=r),t||(t=r);const o=r-i;o>=n||o+(r-t)/2>=n?this.progress():this.requestId=requestAnimationFrame(h),t=r};this.requestId=requestAnimationFrame(h)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){!this.counting||(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(z,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(I))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(N))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return j(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const{confirm:U}=H(),Y={components:{Link:B,PlayIcon:R,VueCountdown:P,GachaButtons:A},props:{gacha:Object,url_edit:String,openCopyModal:Function,reinitializeLazyLoading:Function},data(){return{category_share:E().props.value.category_share,url_10gacha:"",url_1gacha:"",str_gacha10:"",point_10gacha:0,countdown:!0,user:E().props.value.auth.user}},computed:{progress_value(){return Math.round(this.gacha.count_rest*100/this.gacha.count_card)+"%"},progress_background_width(){return this.gacha.count_rest==0?"100%":Math.round(this.gacha.count_card*100/this.gacha.count_rest)+"%"},url_card(){return route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix}},methods:{format_number(n){return String(n).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getImageClass(n){return"url('"+n+"')"},clickCard(){this.url_edit||(window.location.href=this.url_card)},destroyGacha(n){U("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F","","error").then(i=>{i&&G.Inertia.delete(route("admin.gacha.destroy",n),{onSuccess:()=>{this.reinitializeLazyLoading&&this.reinitializeLazyLoading()}})})},transform(n){return Object.entries(n).forEach(([i,t])=>{const h=t<10&&i!="days"?`0${t}`:t;t<2&&i.replace(/s$/,""),n[i]=`${h}`}),n},saveScroll(){sessionStorage.setItem("eve-gacha-top-scroll",window.scrollY)}},mounted(){this.gacha.count_rest<10?(this.str_gacha10="\u5168\u3066",this.point_10gacha=this.gacha.count_rest*this.gacha.point):(this.str_gacha10="10\u9023",this.point_10gacha=10*this.gacha.point)}},J={class:"bg-neutral-700 h-full flex flex-col rounded-md overflow-hidden relative"},K=["data-src"],Q={key:0,class:"absolute inset-0 flex items-center"},W={class:"w-full bg-neutral-900/90 hover:bg-neutral-900 py-1"},X={class:"py-2 border-y"},Z={key:0},$={key:1},tt={class:"text-center"},et={class:"bg-gradient-to-r from-sky-400 to-purple-400 via-green-400 bg-clip-text text-transparent font-black text-3xl font-[mplus2]"},st={key:0,class:"mr-3"},at={key:0,class:"absolute z-10 top-0 left-0 items-center px-2 py-1 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},it={key:1,class:"absolute z-10 top-0 left-0 items-center px-2 py-1 bg-neutral-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},nt={class:"absolute z-10 top-0 right-0 flex flex-col gap-1"},ot={key:1,class:"absolute w-full h-full z-10 flex flex-col justify-center items-center gap-8"},lt={class:"text-white text-5xl w-full bg-neutral-900/80 text-center font-black pb-2 font-[mplus2]"},rt={key:2,class:"absolute bottom-0 w-full h-full bg-opacity-70 z-[5] bg-neutral-900 flex items-center justify-center"},ct={class:"text-white text-xl text-center font-bold px-6 py-1 bg-yellow-500 rounded-lg flex flex-col gap-2"},dt={key:0},ht={key:1},ut={key:3,class:"absolute bottom-0 w-full h-full bg-opacity-70 z-10 bg-neutral-900 flex flex-col justify-center items-center gap-4"},_t=e("div",{class:"text-white text-xl w-full text-center font-black"},"\u30E9\u30F3\u30AF\u5236\u9650",-1),mt=e("div",{class:"text-white text-sm w-full text-center font-black"},null,-1),ft=[_t,mt],gt={class:"w-full flex flex-col justify-center flex-1 max-h-20"},xt={class:"text-white font-[mplus2]"},bt={class:"flex justify-between items-center pt-2 w-full"},yt={class:"flex items-end gap-1.5 w-[45%] px-3"},vt={class:"text-white text-base md:text-xl font-bold"},wt=e("span",{class:"text-white pb-0.5 text-sm font-semibold"},"EP",-1),kt=e("span",{class:"text-gray-300 text-xs pb-0.5 text-nowrap"},"/1\u56DE",-1),pt=e("img",{src:"/images/icon_cash.png",class:"h-5 mb-1"},null,-1),Mt={class:"text-white text-base md:text-xl font-bold"},St=e("span",{class:"text-gray-300 text-xs pb-0.5 text-nowrap"},"/1\u56DE",-1),Ct={class:"flex-1 flex flex-col items-end gap-1.5 pr-2"},Et={key:0,class:"text-white text-sm pr-1"},Lt={key:1,class:"flex items-center"},It=e("span",{class:"font-semibold pr-2"},"- / -",-1),Nt=[It],zt={class:"w-full mb-2.5"},Tt={class:"w-full h-2.5 rounded-full overflow-hidden flex bg-neutral-800"},Dt={key:4,class:"flex items-center"},Vt={key:0},Ot={key:1},jt={class:"text-center"},Bt={class:"bg-rose-400 bg-clip-text text-transparent font-extrabold text-xl font-[mplus2]"},Gt={key:0,class:"mr-3"},Ft={key:5,class:"px-1 py-1 flex items-end"};function At(n,i,t,h,r,o){var C;const M=w("vue-countdown"),S=w("Link"),V=w("GachaButtons");return s(),a("div",{class:k(["cursor-pointer w-full overflow-hidden border rounded-md shadow-[0_4px_8px_0px_rgba(0,0,0,0.3)] p-1 bg-yellow-100",{"cursor-pointer hover:shadow-[0_4px_8px_3px_rgba(0,0,0,0.3)]":!t.url_edit&&t.gacha.count_rest,"grayscale-[80%]":!t.url_edit&&t.gacha.count_rest==0}])},[e("div",J,[u(S,{href:o.url_card,onClick:o.saveScroll,class:k(["relative flex-1",{"grayscale-[80%]":t.url_edit&&t.gacha.count_rest==0}])},{default:_(()=>[e("img",{"data-src":t.gacha.thumbnail,class:"lazy w-full aspect-[32/21] object-cover"},null,8,K),r.countdown&&t.gacha.remaining>0&&t.gacha.timeStatus==0?(s(),a("div",Q,[e("div",W,[e("div",X,[u(M,{time:t.gacha.remaining*1e3,transform:o.transform,class:"text-gray-100 flex flex-wrap items-center justify-around px-2 py-0.5 w-full text-xl font-semibold",onEnd:i[0]||(i[0]=d=>r.countdown=!1)},{default:_(({days:d,hours:b,minutes:y,seconds:v})=>[t.gacha.timeStatus==0?(s(),a("span",Z,"\u767A\u58F2\u307E\u3067")):l("",!0),t.gacha.timeStatus==1?(s(),a("span",$,"\u7D42\u4E86\u307E\u3067")):l("",!0),e("span",tt,[e("span",et,[d>0?(s(),a("span",st,c(d)+"\u65E5",1)):l("",!0),m(c(b)+":"+c(y)+":"+c(v),1)])])]),_:1},8,["time","transform"])])])])):l("",!0)]),_:1},8,["href","onClick","class"]),t.url_edit?(s(),a(p,{key:0},[t.gacha.status==1?(s(),a("div",at," \u516C\u958B ")):(s(),a("div",it," \u975E\u516C\u958B ")),e("div",nt,[u(S,{href:t.url_edit,onClick:o.saveScroll,class:"items-center px-8 py-2.5 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150"},{default:_(()=>[m(" \u7DE8\u96C6\u3059\u308B ")]),_:1},8,["href","onClick"]),e("button",{onClick:i[1]||(i[1]=d=>{o.saveScroll,t.openCopyModal(t.gacha.id)}),class:"px-4 py-2 bg-sky-500 hover:bg-sky-600 text-sm text-neutral-50"}," \u30B3\u30D4\u30FC "),e("button",{onClick:i[2]||(i[2]=d=>{o.saveScroll,o.destroyGacha(t.gacha.id)}),class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-sm text-neutral-50"}," \u524A\u9664 ")])],64)):l("",!0),t.gacha.count_rest==0&&!t.url_edit?(s(),a("div",ot,[e("div",lt,[m(" SOLD OUT "),r.user&&r.user.type==1?(s(),a("button",{key:0,class:"text-base font-normal text-white border border-neutral-300 w-fit rounded-full min-w-[40%] px-5 py-1 hover:bg-white hover:text-black",onClick:i[3]||(i[3]=d=>o.clickCard())},"\u6392\u51FA\u5C65\u6B74")):l("",!0)])])):l("",!0),t.url_edit&&(t.gacha.count_rest!=t.gacha.ableCount||!t.gacha.has_video)?(s(),a("div",rt,[e("div",ct,[t.gacha.has_video?l("",!0):(s(),a("div",dt,"\u52D5\u753B\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093")),t.gacha.count_rest!=t.gacha.ableCount?(s(),a("div",ht,"\u73FE\u5728\u56DE\u305B\u307E\u305B\u3093")):l("",!0)])])):l("",!0),t.gacha.rank_limit>0&&t.gacha.rank_limit&1<<((C=r.user)==null?void 0:C.current_rank)&&!t.url_edit?(s(),a("div",ut,ft)):l("",!0),e("div",gt,[e("div",xt,[e("div",bt,[e("div",yt,[t.gacha.dp_gacha?(s(),a(p,{key:0},[e("span",vt,c(o.format_number(t.gacha.point)),1),wt,kt],64)):(s(),a(p,{key:1},[pt,e("span",Mt,c(o.format_number(t.gacha.point)),1),St],64))]),e("div",Ct,[t.gacha.count_card>0?(s(),a("span",Et," \u306E\u3053\u308A "+c(o.format_number(t.gacha.count_rest))+" / "+c(o.format_number(t.gacha.count_card)),1)):(s(),a("div",Lt,Nt)),e("div",zt,[e("div",Tt,[e("div",{class:k(["h-full rounded-full border-neutral-800",{"bg-gradient-to-r from-[#dd422d] via-[#fae94e] to-[#02ec0e]":t.gacha.count_card>0,"bg-[#02ec0e] w-full":t.gacha.count_card==0}]),style:F(t.gacha.count_card>0?{width:o.progress_value,backgroundSize:o.progress_background_width}:{})},null,6)])])])])])]),r.countdown&&t.gacha.remaining>0&&t.gacha.timeStatus==1&&t.gacha.count_rest>0?(s(),a("div",Dt,[u(M,{time:t.gacha.remaining*1e3,transform:o.transform,class:"text-gray-100 flex items-center justify-around px-2 pb-1 w-full font-semibold",onEnd:i[4]||(i[4]=d=>r.countdown=!1)},{default:_(({days:d,hours:b,minutes:y,seconds:v})=>[t.gacha.timeStatus==0?(s(),a("span",Vt,"\u767A\u58F2\u307E\u3067")):l("",!0),t.gacha.timeStatus==1?(s(),a("span",Ot,"\u7D42\u4E86\u307E\u3067")):l("",!0),e("span",jt,[e("span",Bt,[d>0?(s(),a("span",Gt,c(d)+"\u65E5",1)):l("",!0),m(c(b)+":"+c(y)+":"+c(v),1)])])]),_:1},8,["time","transform"])])):l("",!0),t.url_edit?l("",!0):(s(),a("div",Ft,[u(V,{gacha:t.gacha},null,8,["gacha"])]))])],2)}const Yt=q(Y,[["render",At]]);export{Yt as G};
