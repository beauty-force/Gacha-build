import{r as u,o as i,i as v,w as h,b as d,d as e,t as l,e as x,c as r,L as w,u as b,G as C,F as D,f as P,n as k,h as T}from"./app.e22c9ac0.js";import{_ as y}from"./_plugin-vue_export-helper.cdc0426e.js";import{N as B,e as G,o as N,f as j}from"./useConfirm.a1995efd.js";import{r as S}from"./PlayIcon.d589ff7a.js";const q={name:"GachaConfirmDialog",components:{Dialog:B,DialogPanel:G,TransitionChild:N,TransitionRoot:j},props:{isOpen:{type:Boolean,default:!1},gachaTitle:{type:String,required:!0},number:{type:Number,required:!0},pointCost:{type:Number,required:!0},currentPoints:{type:Number,required:!0},isDpGacha:{type:Boolean,default:!1},thumbnail:{type:String,required:!0}},computed:{remainingPoints(){return this.currentPoints-this.pointCost},pointType(){return this.isDpGacha?"EP":"\u30DD\u30A4\u30F3\u30C8"}},methods:{formatNumber(t){return String(t).replace(/(.)(?=(\d{3})+$)/g,"$1,")},closeDialog(){this.$emit("close")},confirmAction(){this.$emit("confirm"),this.closeDialog()}}},L=e("div",{class:"fixed inset-0 bg-black/50"},null,-1),E={class:"fixed inset-0 overflow-y-auto"},F={class:"flex min-h-full items-center justify-center p-4"},V=["src"],A={class:"text-center my-4"},I={class:"text-lg font-bold text-gray-900 mb-2"},O=e("p",{class:"text-base text-gray-700 mb-1 font-medium"}," \u30AC\u30C1\u30E3\u3092\u5F15\u304D\u307E\u3059\u304B\uFF1F ",-1),R={class:"text-sm text-gray-600 font-medium"},U={class:"font-bold text-red-500 text-base pr-0.5"},z={class:"font-bold"},H={class:"flex items-center justify-center mb-6 bg-gray-50 rounded-lg p-4"},J={class:"flex items-center space-x-2"},K={class:"text-lg font-bold text-gray-900"},M={class:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center"},Q={key:0,src:"/images/icon_cash.png",class:"w-8 h-8"},W={key:1,class:"text-sm text-white"},X=e("div",{class:"mx-4 text-2xl text-gray-400"},">",-1),Y={class:"flex items-center space-x-2"},Z={class:"text-lg font-bold text-red-500"},$={class:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center"},tt={key:0,src:"/images/icon_cash.png",class:"w-8 h-8"},et={key:1,class:"text-sm text-white"},st={class:"flex flex-col space-y-3"};function ot(t,s,a,f,n,o){const g=u("TransitionChild"),m=u("DialogPanel"),c=u("Dialog"),p=u("TransitionRoot");return i(),v(p,{appear:"",show:a.isOpen,as:"template"},{default:h(()=>[d(c,{as:"div",onClose:o.closeDialog,class:"relative z-50"},{default:h(()=>[d(g,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:h(()=>[L]),_:1}),e("div",E,[e("div",F,[d(g,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:h(()=>[d(m,{class:"w-full max-w-md transform overflow-hidden rounded-lg bg-white p-6 text-left align-middle shadow-xl transition-all font-sans"},{default:h(()=>[e("img",{src:a.thumbnail,class:"w-full h-auto"},null,8,V),e("div",A,[e("h3",I," \u300C"+l(a.gachaTitle)+"\u300D ",1),O,e("p",R,[e("span",U,l(a.number),1),x("\u56DE\u5206\u306E"),e("span",z,l(o.pointType),1),x("\u3092\u6D88\u8CBB\u3057\u307E\u3059\u3002 ")])]),e("div",H,[e("div",J,[e("span",K,l(a.currentPoints.toLocaleString()),1),e("div",M,[a.isDpGacha?(i(),r("span",W,"EP")):(i(),r("img",Q))])]),X,e("div",Y,[e("span",Z,l(o.remainingPoints.toLocaleString()),1),e("div",$,[a.isDpGacha?(i(),r("span",et,"EP")):(i(),r("img",tt))])])]),e("div",st,[e("button",{onClick:s[0]||(s[0]=(..._)=>o.confirmAction&&o.confirmAction(..._)),class:"w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-4 rounded-md transition-colors duration-200"}," \u30AA\u30EA\u30D1\u3092\u5F15\u304F "),e("button",{onClick:s[1]||(s[1]=(..._)=>o.closeDialog&&o.closeDialog(..._)),class:"w-full bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-md transition-colors duration-200"}," \u30AD\u30E3\u30F3\u30BB\u30EB ")])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}const at=y(q,[["render",ot]]);const nt={components:{Link:w,PlayIcon:S,GachaConfirmDialog:at},props:{gacha:Object},data(){return{category_share:b().props.value.category_share,processing:!1,buttons:[],showConfirmDialog:!1,selectedNumber:0,selectedPointCost:0,colorThemes:["from-neutral-500 to-neutral-700 hover:from-neutral-600 hover:to-neutral-800","from-yellow-400 to-yellow-600 hover:from-yellow-500 hover:to-yellow-700","from-red-500 to-red-700 hover:from-red-600 hover:to-red-800","from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800","from-green-500 to-green-700 hover:from-green-600 hover:to-green-800"]}},computed:{displayButtons(){if(!this.buttons||this.buttons.length===0)return this.getDefaultButtons();const t=this.buttons.filter(s=>s<=this.gacha.count_rest);return t.length===0?[]:(t[t.length-1]<this.gacha.count_rest&&this.buttons.length>t.length&&t.push(this.gacha.count_rest),t.map((s,a)=>{const f=s*this.gacha.point,n=s>=this.gacha.count_rest?"\u5168\u3066":s==1?"1\u56DE":`${s}\u9023`,o=a%this.colorThemes.length;return{number:s,point:f,text:n,classes:s>=this.gacha.count_rest||s>=100?"all_button":this.colorThemes[o]}}))},currentUserPoints(){const t=b().props.value.auth.user;return t?this.gacha.dp_gacha?t.dp:t.point:0}},methods:{format_number(t){return String(t).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getDefaultButtons(){const t=[];if(t.push({number:1,point:this.gacha.point,text:"1\u56DE",classes:this.colorThemes[0]}),this.gacha.count_rest>1&&(this.gacha.gacha_limit==0||this.gacha.gacha_limit>1)){const s=this.gacha.count_rest<=10?this.gacha.count_rest:10;t.push({number:s,point:s*this.gacha.point,text:this.gacha.count_rest<=10?"\u5168\u3066":"10\u9023",classes:this.colorThemes[1]})}if(this.gacha.count_rest>10&&(this.gacha.gacha_limit==0||this.gacha.gacha_limit>10)){const s=this.gacha.count_rest<=100?this.gacha.count_rest:100;t.push({number:s,point:s*this.gacha.point,text:this.gacha.count_rest<=100?"\u5168\u3066":"100\u9023",classes:"all_button"})}return t},clickgacha(t){this.selectedNumber=t,this.selectedPointCost=this.gacha.point*t,!(this.currentUserPoints<this.selectedPointCost)&&(this.showConfirmDialog=!0)},closeConfirmDialog(){this.showConfirmDialog=!1},confirmGacha(){this.start_gacha(this.selectedNumber)},start_gacha(t){this.processing=!0,!this.url_edit&&C({id:this.gacha.id,number:t,code:this.gacha.code}).post(route("user.gacha.start_post"),{onFinish:()=>{this.processing=!1}})}},mounted(){this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix),this.buttons=this.gacha.buttons?this.gacha.buttons.split(",").map(t=>parseInt(t)).sort((t,s)=>t-s):[]}},it={key:0,class:"w-full mx-auto flex flex-col justify-center py-1 px-1 gap-2 md:max-w-md"},rt={class:"grid grid-cols-2 gap-2 font-[mplus2]"},ct=["onClick","disabled"],lt={class:"text-nowrap flex items-center justify-center min-w-36"},ht={class:"font-extrabold text-[15px]"},ut=e("span",{class:"font-semibold text-[11px]"},"\u30AC\u30C1\u30E3",-1);function dt(t,s,a,f,n,o){var m;const g=u("GachaConfirmDialog");return a.gacha.count_rest>0?(i(),r("div",it,[e("div",rt,[(i(!0),r(D,null,P(o.displayButtons,(c,p)=>(i(),r("button",{key:c.number,onClick:_=>o.clickgacha(c.number),class:k([[c.classes,{"opacity-50":n.processing},{"col-span-2":p===o.displayButtons.length-1&&o.displayButtons.length%2===1}],"cursor-pointer rounded-md bg-gradient-to-br border border-yellow-400/50 text-white text-center space-y-1 pt-1.5 pb-2"]),disabled:n.processing},[e("div",lt,[e("span",ht,l(c.text),1),ut])],10,ct))),128))]),d(g,{"is-open":n.showConfirmDialog,"gacha-title":a.gacha.title,number:n.selectedNumber,"point-cost":n.selectedPointCost,thumbnail:(m=a.gacha.thumbnail)!=null?m:a.gacha.image,"current-points":o.currentUserPoints,"is-dp-gacha":a.gacha.dp_gacha==1,onClose:o.closeConfirmDialog,onConfirm:o.confirmGacha},null,8,["is-open","gacha-title","number","point-cost","thumbnail","current-points","is-dp-gacha","onClose","onConfirm"])])):T("",!0)}const pt=y(nt,[["render",dt]]);export{pt as G};
