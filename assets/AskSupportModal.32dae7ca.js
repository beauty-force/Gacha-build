import{q as _,y as D,A as B,o as n,i as L,w as O,c,d as e,I as V,J as q,K as C,t as d,h as f,n as z,e as h,F as G,f as K,D as w,V as N,a as P,a6 as E,a7 as U}from"./app.5aeb4b76.js";import{h as I}from"./useConfirm.82591324.js";import{_ as J}from"./_plugin-vue_export-helper.cdc0426e.js";const u=p=>(E("data-v-135cfacd"),p=p(),U(),p),R={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},H={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},W=u(()=>e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75"},null,-1)),Q={class:"inline-block align-bottom bg-white rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},X=u(()=>e("h3",{class:"text-xl font-bold text-white flex items-center"},[e("svg",{class:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),h(" \u30B5\u30DD\u30FC\u30C8\u3078\u8CEA\u554F ")],-1)),Y=u(()=>e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),Z=[Y],ee=["onSubmit"],te=u(()=>e("label",{for:"subject",class:"block text-sm font-semibold text-gray-700 mb-1"},[h(" \u4EF6\u540D "),e("span",{class:"text-red-500"},"*")],-1)),oe={key:0,class:"mt-1 text-sm text-red-600"},se=u(()=>e("label",{for:"question",class:"block text-sm font-semibold text-gray-700 mb-1"},[h(" \u8CEA\u554F\u5185\u5BB9 "),e("span",{class:"text-red-500"},"*")],-1)),ae={key:0,class:"mt-1 text-sm text-red-600"},le={class:"mt-1 text-xs text-gray-500"},re=u(()=>e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[h(" \u753B\u50CF\u3092\u6DFB\u4ED8 "),e("span",{class:"text-gray-500 text-xs font-normal"},"(\u4EFB\u610F\u3001\u6700\u59273\u679A\u3001\u5408\u8A0810MB)")],-1)),ne={class:"mb-3"},ie=u(()=>e("svg",{class:"w-5 h-5 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),ce=["disabled"],ue={key:0,class:"grid grid-cols-3 gap-3"},de=["src","alt"],pe=["onClick"],me=u(()=>e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),ge=[me],fe={class:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs px-2 py-1 truncate"},he={key:1,class:"mt-2 text-sm text-red-600"},be=u(()=>e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},[e("p",{class:"text-sm text-gray-700"},[e("strong",null,"\u3054\u6CE8\u610F:"),h(" \u901A\u5E38\u30011-2\u55B6\u696D\u65E5\u4EE5\u5185\u306B\u56DE\u7B54\u3044\u305F\u3057\u307E\u3059\u3002 ")])],-1)),ve={class:"flex justify-end space-x-3 pt-2"},xe=["disabled"],_e={key:0},ye={key:1},we={__name:"AskSupportModal",props:{isOpen:Boolean,defaultSubject:String},emits:["close"],setup(p,{emit:$}){const m=p,i=_({subject:m.defaultSubject||"",question:""}),l=_([]),o=_({}),x=_(!1),k=3,g=10*1024*1024,j=5*1024*1024,b=D(()=>l.value.reduce((t,a)=>t+a.file.size,0)),y=()=>{$("close"),S()},S=()=>{i.value={subject:"",question:""},l.value=[],o.value={}},A=t=>{const a=Array.from(t.target.files);if(o.value.images=null,l.value.length+a.length>k){o.value.images=`\u753B\u50CF\u306F\u6700\u5927${k}\u679A\u307E\u3067\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3067\u304D\u307E\u3059`,t.target.value="";return}for(const s of a){if(!s.type.match(/^image\/(jpeg|jpg|png|gif|webp)$/)){o.value.images="\u5BFE\u5FDC\u3057\u3066\u3044\u308B\u753B\u50CF\u5F62\u5F0F: JPEG, PNG, GIF, WebP";continue}if(s.size>j){o.value.images=`\u5404\u753B\u50CF\u306F${v(j)}\u4EE5\u4E0B\u306B\u3057\u3066\u304F\u3060\u3055\u3044`;continue}const r=new FileReader;r.onload=M=>{l.value.push({file:s,preview:M.target.result}),b.value>g&&(o.value.images=`\u5408\u8A08\u30B5\u30A4\u30BA\u304C${v(g)}\u3092\u8D85\u3048\u3066\u3044\u307E\u3059`)},r.readAsDataURL(s)}t.target.value=""},F=t=>{l.value.splice(t,1),o.value.images=null},v=t=>{if(t===0)return"0 B";const a=1024,s=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(a));return Math.round(t/Math.pow(a,r)*100)/100+" "+s[r]},T=async()=>{if(o.value={},b.value>g){o.value.images=`\u5408\u8A08\u30B5\u30A4\u30BA\u304C${v(g)}\u3092\u8D85\u3048\u3066\u3044\u307E\u3059`;return}x.value=!0;try{const t=new FormData;t.append("subject",i.value.subject),t.append("question",i.value.question),l.value.forEach((s,r)=>{t.append(`images[${r}]`,s.file)});const a=await P.post(route("user.support-question.store"),t,{headers:{"Content-Type":"multipart/form-data"}});await I.fire({icon:"success",title:"\u9001\u4FE1\u5B8C\u4E86",text:a.data.message,confirmButtonColor:"#f59e0b",confirmButtonText:"OK"}),y()}catch(t){t.response&&t.response.data.errors?o.value=t.response.data.errors:await I.fire({icon:"error",title:"\u30A8\u30E9\u30FC",text:"\u9001\u4FE1\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002\u3082\u3046\u4E00\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044\u3002",confirmButtonColor:"#f59e0b",confirmButtonText:"OK"})}finally{x.value=!1}};return B(()=>m.isOpen,t=>{t?m.defaultSubject&&(i.value.subject=m.defaultSubject):S()}),B(()=>m.defaultSubject,t=>{t&&m.isOpen&&(i.value.subject=t)}),(t,a)=>(n(),L(N,{name:"modal"},{default:O(()=>[p.isOpen?(n(),c("div",R,[e("div",H,[W,e("div",Q,[e("div",{class:"bg-gradient-to-r from-yellow-400 to-amber-500 px-6 py-4"},[e("div",{class:"flex items-center justify-between"},[X,e("button",{onClick:y,class:"text-white hover:text-yellow-100 transition-colors"},Z)])]),e("form",{onSubmit:V(T,["prevent"]),class:"px-6 py-5 space-y-4"},[e("div",null,[te,q(e("input",{id:"subject","onUpdate:modelValue":a[0]||(a[0]=s=>i.value.subject=s),type:"text",placeholder:"\u8CEA\u554F\u306E\u4EF6\u540D\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400",required:""},null,512),[[C,i.value.subject]]),o.value.subject?(n(),c("p",oe,d(o.value.subject),1)):f("",!0)]),e("div",null,[se,q(e("textarea",{id:"question","onUpdate:modelValue":a[1]||(a[1]=s=>i.value.question=s),rows:"6",placeholder:"\u304A\u56F0\u308A\u306E\u5185\u5BB9\u3092\u8A73\u3057\u304F\u304A\u66F8\u304D\u304F\u3060\u3055\u3044",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 resize-none",required:""},null,512),[[C,i.value.question]]),o.value.question?(n(),c("p",ae,d(o.value.question),1)):f("",!0),e("p",le,d(i.value.question.length)+"/2000\u6587\u5B57",1)]),e("div",null,[re,e("div",ne,[e("label",{for:"image-upload",class:z([{"opacity-50 cursor-not-allowed":l.value.length>=3,"cursor-pointer hover:bg-gray-50":l.value.length<3},"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white transition-colors"])},[ie,h(" \u753B\u50CF\u3092\u9078\u629E ("+d(l.value.length)+"/3) ",1)],2),e("input",{id:"image-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",multiple:"",onChange:A,disabled:l.value.length>=3,class:"hidden"},null,40,ce)]),l.value.length>0?(n(),c("div",ue,[(n(!0),c(G,null,K(l.value,(s,r)=>(n(),c("div",{key:r,class:"relative group aspect-square bg-gray-100 rounded-lg overflow-hidden border-2 border-gray-200"},[e("img",{src:s.preview,alt:`Preview ${r+1}`,class:"w-full h-full object-cover"},null,8,de),e("button",{type:"button",onClick:M=>F(r),class:"absolute top-1 right-1 p-1 bg-red-500 hover:bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",title:"\u524A\u9664"},ge,8,pe),e("div",fe,d(s.file.name),1)]))),128))])):f("",!0),o.value.images?(n(),c("p",he,d(o.value.images),1)):f("",!0),w(b)>0?(n(),c("p",{key:2,class:z(["mt-2 text-xs",w(b)>g?"text-red-600":"text-gray-500"])}," \u5408\u8A08\u30B5\u30A4\u30BA: "+d(v(w(b)))+" / "+d(v(g)),3)):f("",!0)]),be,e("div",ve,[e("button",{type:"button",onClick:y,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold rounded-lg transition-colors"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),e("button",{type:"submit",disabled:x.value,class:"px-5 py-2 bg-gradient-to-r from-yellow-400 to-amber-500 hover:from-yellow-500 hover:to-amber-600 text-white font-semibold rounded-lg transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},[x.value?(n(),c("span",_e,"\u9001\u4FE1\u4E2D...")):(n(),c("span",ye,"\u9001\u4FE1\u3059\u308B"))],8,xe)])],40,ee)])])])):f("",!0)]),_:1}))}},Me=J(we,[["__scopeId","data-v-135cfacd"]]);export{Me as A};
