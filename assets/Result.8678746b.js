import{H as y,L as w,G as C,r as u,o as d,c,b as _,w as j,F as g,d as e,n as m,e as r,t as h,h as b,f as A,J as R,a2 as D}from"./app.0eb71d99.js";import{A as L}from"./Admin.e0ad1771.js";import{u as I}from"./useConfirm.2f2cdaff.js";import{_ as O}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as z}from"./PlayIcon.1fe95338.js";const{confirm:x,alert:p}=I(),S={components:{Head:y,AppLayout:L,Link:w,PlayIcon:z},props:{errors:Object,auth:Object,category_share:Object,products:Object,token:String,show_review:Boolean,rank:Object,delivery_limit:Number},data(){return{isCheckAll:!1,showRankDialog:!1,isClosing:!1}},computed:{selectedPoints(){let t=0;for(let s=0;s<this.products.data.length;s++)this.form.checks["id"+this.products.data[s].id]&&(t+=parseInt(this.products.data[s].point));return t},selectedCount(){let t=0;for(let s=0;s<this.products.data.length;s++)this.form.checks["id"+this.products.data[s].id]&&t++;return t}},mounted(){this.rank&&(this.showRankDialog=!0)},setup(t){let s={},i;for(i=0;i<t.products.data.length;i++)s["id"+t.products.data[i].id]=!1;return{form:C({checks:s,token:t.token})}},methods:{closeRankDialog(){this.isClosing=!0,setTimeout(()=>{this.showRankDialog=!1,this.isClosing=!1},300)},format_number(t){return String(t).replace(/(.)(?=(\d{3})+$)/g,"$1,")},submit(){let t,s=0;var i=0;for(t=0;t<this.products.data.length;t++)this.form.checks["id"+this.products.data[t].id]&&(s++,i=i+parseInt(this.products.data[t].point));let a="";i>0?a="\u9078\u629E\u3057\u305F"+s+"\u70B9\u306E\u5546\u54C1\u3092"+i+"pt\u3068\u4EA4\u63DB\u3057\u307E\u3059\u3002":a="\u5168\u3066\u306E\u5546\u54C1\u304C\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3057\u307E\u3059\u3002",x(a).then(n=>{n&&this.form.post(route("user.gacha.result.exchange"),{onFinish:()=>{}})})},delivery(){let t,s=0;var i=0;let a=0;for(t=0;t<this.products.data.length;t++)this.form.checks["id"+this.products.data[t].id]&&(s++,i=i+parseInt(this.products.data[t].point),this.products.data[t].rare=="\u30DD\u30A4\u30F3\u30C8"&&a++);if(a>0){p("\u30DD\u30A4\u30F3\u30C8\u306F\u767A\u9001\u3067\u304D\u307E\u305B\u3093");return}let n="";if(s>0){if(n="\u9078\u629E\u3057\u305F"+s+"\u70B9\u306E\u5546\u54C1\u3092\u767A\u9001\u4F9D\u983C\u3057\u307E\u3059\u3002",i<this.delivery_limit){p("\u767A\u9001\u4F9D\u983C\u304C\u3067\u304D\u308B\u6700\u4F4E\u30DD\u30A4\u30F3\u30C8\u306F"+this.format_number(this.delivery_limit)+"pt\u3067\u3059\u3002");return}}else n="\u5168\u3066\u306E\u5546\u54C1\u304C\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3057\u307E\u3059\u3002";x(n).then(l=>{l&&this.form.post(route("user.gacha.result.delivery"),{onFinish:()=>{}})})},checkall(){let t;for(t=0;t<this.products.data.length;t++)this.form.checks["id"+this.products.data[t].id]=this.isCheckAll&&this.products.data[t].status!=3},checkone(){this.isCheckAll=this.products.data.length>0,this.products.data.forEach(t=>{this.form.checks["id"+t.id]!=!0&&(this.isCheckAll=!1)})},toggleSelectAll(){this.isCheckAll=!this.isCheckAll,this.checkall()}}},V={class:"h-full flex flex-col justify-start"},B={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},F={class:"flex items-center justify-center min-h-screen pt-4 px-4 text-center sm:block sm:p-0"},N=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),P={class:"bg-gradient-to-r from-amber-500 to-amber-600 px-4 pt-6 pb-4 text-white"},H={class:"text-center"},E=e("h3",{class:"text-lg leading-6 font-bold mb-2 flex items-center justify-center gap-2"},[e("span",{class:"text-xl"},"\u{1F389}"),r("\u4F1A\u54E1\u30E9\u30F3\u30AF\u5909\u66F4\u306E\u304A\u77E5\u3089\u305B\uFF01"),e("span",{class:"text-xl"},"\u{1F389}")],-1),T=e("p",{class:"text-amber-50 mb-4 text-base"},"\u3042\u306A\u305F\u306E\u30E9\u30F3\u30AF\u304C\u30A2\u30C3\u30D7\u3057\u307E\u3057\u305F\u{1F44F}\u2728",-1),M={class:"inline-block"},U=["src"],G={class:"bg-white"},J={class:"text-center"},q={class:"text-left text-gray-800 space-y-3 text-sm md:text-base bg-amber-50 p-4"},K=e("p",{class:"font-bold text-lg mb-3 text-amber-700"},"\u{1F4E6}\u73FE\u5728\u53D7\u3051\u3089\u308C\u308B\u7279\u5178\u4E00\u89A7\u{1F4E6}",-1),Q={class:"flex items-center gap-2"},W={class:"text-amber-700"},X={class:"flex items-center gap-2"},Y={class:"text-amber-700"},Z={class:"flex items-center gap-2"},$={class:"text-amber-700"},ee=e("p",{class:"flex items-center gap-2"},[r("\u{1F539} "),e("span",null,"\u30E9\u30F3\u30AF\u9650\u5B9A\uFF1A\u7279\u5225\u30AC\u30C1\u30E3\u304C\u89E3\u653E\u3055\u308C\u307E\u3057\u305F\uFF01")],-1),te=e("p",{class:"text-gray-600 my-4 font-semibold"},"\u{1F4A1}\u7279\u5178\u3092\u6D3B\u304B\u3057\u3066\u3001\u3055\u3089\u306B\u304A\u5F97\u306B\u30A4\u30D6\u30AC\u30C1\u30E3\u3092\u697D\u3057\u3082\u3046\uFF01",-1),se={class:"bg-white px-4 py-4 sm:px-6 sm:flex sm:flex-row-reverse justify-center border-t-2 border-amber-200"},oe={class:"sticky top-0 z-30 bg-gradient-to-r from-amber-400 via-amber-500 to-amber-400 shadow-lg"},ie={class:"max-w-4xl mx-auto flex justify-between items-center py-3 px-4"},ae=e("h1",{class:"text-white text-lg font-bold text-center"}," \u30AC\u30C1\u30E3\u7D50\u679C ",-1),le=["href"],ne={class:"m-auto items-center px-2 py-2 bg-white flex-1 w-full"},re=["href"],de=e("div",{class:"bg-theme bg-theme-hover px-3 py-2 rounded-md text-center text-white"},[e("img",{src:"/images/video_review.png",class:"w-full",alt:"\u30AC\u30C1\u30E3\u6F14\u51FA\u3092\u3082\u3046\u4E00\u5EA6\u898B\u308B"})],-1),ce=[de],he={class:"p-2 md:p-3 grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-3"},me=["for"],be={class:"relative h-28 md:h-32 w-20 md:w-24 flex-shrink-0 bg-gradient-to-br from-amber-50 to-yellow-50 flex justify-center items-center"},fe=["src"],ue=["src","alt"],_e={class:"flex-1 px-1 md:px-2 py-3 flex flex-col justify-around items-start"},ge=["id","onUpdate:modelValue"],xe={class:"text-gray-800 text-xs font-bold line-clamp-2"},pe={class:"inline-block px-2 py-0.5 bg-amber-100 text-amber-800 text-xs font-bold rounded-full"},ke={class:"flex items-center gap-1"},ve=e("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1),ye={class:"text-xs font-bold text-amber-700"},we={key:1,class:"text-xs text-rose-600 font-semibold rounded-full"},Ce=e("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1),je=[Ce],Ae={class:"sticky bottom-0 z-30 w-full bg-white border-t border-gray-200 shadow-lg"},Re={class:"mx-auto px-4 py-2"},De={class:"flex items-center justify-between mb-2"},Le={class:"flex items-center gap-1 text-gray-700 text-base"},Ie=e("img",{src:"/images/icon_cash.png",class:"w-4 h-4",alt:"coin icon"},null,-1),Oe={class:"font-semibold"},ze={class:"flex gap-2"},Se=["disabled"],Ve=["disabled"],Be=e("div",{class:"pb-2 text-center text-xs text-gray-500"}," \u203B\u9078\u629E\u3055\u308C\u306A\u304B\u3063\u305F\u5546\u54C1\u306F\u300C\u7372\u5F97\u6E08\u307F\u5546\u54C1\u4E00\u89A7\u300D\u306B\u79FB\u52D5\u3055\u308C\u307E\u3059\u3002 ",-1);function Fe(t,s,i,a,n,l){const k=u("Head"),v=u("AppLayout");return d(),c(g,null,[_(k,{title:"\u30AC\u30C1\u30E3\u2013\u7D50\u679C"}),_(v,{hide_header:!0},{default:j(()=>[e("div",V,[n.showRankDialog?(d(),c("div",B,[e("div",F,[e("div",{class:m(["fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",{"animate-[fadeIn_0.3s_ease-out]":!n.isClosing,"animate-[fadeOut_0.3s_ease-out]":n.isClosing}]),"aria-hidden":"true"},null,2),N,e("div",{class:m(["inline-block align-bottom bg-gradient-to-br from-amber-50 via-white to-amber-50 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full border-4 border-amber-400",{"animate-[bounceIn_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":!n.isClosing,"animate-[bounceOut_0.6s_cubic-bezier(0.68,-0.55,0.265,1.55)]":n.isClosing}])},[e("div",P,[e("div",H,[E,T,e("div",M,[e("img",{src:i.rank.badge,alt:"Rank Image",class:"w-full max-w-80 h-32"},null,8,U)])])]),e("div",G,[e("div",J,[e("div",q,[K,e("p",Q,[r("\u{1F539} "),e("span",null,[r("\u30E9\u30F3\u30AF\u30A2\u30C3\u30D7\u30DC\u30FC\u30CA\u30B9\uFF1A"),e("strong",W,h(i.rank.bonus.toLocaleString())+"PT",1),r("\u4ED8\u4E0E\uFF01")])]),e("p",X,[r("\u{1F539} "),e("span",null,[r("\u8CFC\u5165\u91D1\u984D\u306B\u5FDC\u3058\u3066\uFF1A"),e("strong",Y,h(i.rank.pt_rate)+"%",1),r("\u306E\u30DC\u30FC\u30CA\u30B9\u30DD\u30A4\u30F3\u30C8\u9084\u5143\uFF01")])]),e("p",Z,[r("\u{1F539} "),e("span",null,[r("EP\u9084\u5143\u7387\uFF1A"),e("strong",$,h(i.rank.dp_rate)+"%",1),r("\uFF08\u901A\u5E38\u3088\u308A\u304A\u5F97\u306B\u8CAF\u307E\u308B\uFF01\uFF09")])]),ee]),te])]),e("div",se,[e("button",{type:"button",onClick:s[0]||(s[0]=(...o)=>l.closeRankDialog&&l.closeRankDialog(...o)),class:"w-full inline-flex justify-center rounded-lg border-2 border-amber-500 bg-gradient-to-r from-amber-500 to-amber-600 shadow-lg px-6 py-3 text-base font-semibold text-white hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 sm:ml-3 sm:w-auto transition-all"}," \u9589\u3058\u308B ")])],2)])])):b("",!0),e("div",oe,[e("div",ie,[ae,e("a",{class:"px-4 py-2 bg-white text-amber-600 rounded-lg font-semibold hover:bg-amber-50 transition-colors shadow-md",href:t.route("user.gacha.end",{token:i.token})}," \u30B9\u30AD\u30C3\u30D7 ",8,le)])]),e("div",ne,[i.show_review?(d(),c("a",{key:0,class:"w-full px-3 md:px-6 my-2",href:t.route("user.gacha.video",{token:i.token})},ce,8,re)):b("",!0),e("div",null,[e("div",he,[(d(!0),c(g,null,A(i.products.data,(o,Ne)=>(d(),c("div",{class:m(["relative border-2 rounded-lg overflow-hidden shadow-md transition-all hover:shadow-xl",{"border-amber-500 shadow-amber-200 bg-amber-50":a.form.checks["id"+o.id],"bg-white border-gray-200":!a.form.checks["id"+o.id]}])},[e("label",{for:"checkbox"+o.id,class:"flex cursor-pointer"},[e("div",be,[e("img",{class:"max-h-full max-w-full object-contain p-1.5",src:o.image},null,8,fe),o.badge?(d(),c("img",{key:0,src:o.badge,class:"absolute bottom-2 right-2 w-[30%] drop-shadow-lg",alt:o.badge},null,8,ue)):b("",!0)]),e("div",_e,[o.status==1?R((d(),c("input",{key:0,id:"checkbox"+o.id,type:"checkbox","onUpdate:modelValue":f=>a.form.checks["id"+o.id]=f,onChange:s[1]||(s[1]=(...f)=>l.checkone&&l.checkone(...f)),class:"hidden"},null,40,ge)),[[D,a.form.checks["id"+o.id]]]):b("",!0),e("div",xe,h(o.name),1),e("div",pe,h(o.rare),1),e("div",ke,[ve,e("span",ye,h(l.format_number(o.point)),1)]),o.status==3?(d(),c("div",we," \u767A\u9001\u4F9D\u983C\u6E08\u307F ")):b("",!0)])],8,me),o.status==1?(d(),c("div",{key:0,class:m(["absolute bottom-2 right-2 rounded-full p-1 shadow-lg transition-all duration-100 opacity-75",{"bg-theme":a.form.checks["id"+o.id],"bg-gray-300":!a.form.checks["id"+o.id]}])},je,2)):b("",!0)],2))),256))])])]),e("div",Ae,[e("div",Re,[e("div",De,[e("div",Le,[e("span",null,"\u9078\u629E\u4E2D "+h(l.selectedCount)+"\u679A \xA0/\xA0",1),Ie,e("span",Oe,h(l.format_number(l.selectedPoints)),1)]),e("button",{type:"button",onClick:s[2]||(s[2]=o=>l.toggleSelectAll()),class:"px-4 py-2 text-sm font-semibold bg-amber-500 hover:bg-amber-600 text-white rounded-lg transition"}," \u5168\u3066\u9078\u629E ")]),e("div",ze,[e("button",{type:"button",onClick:s[3]||(s[3]=o=>l.submit()),class:m([{"opacity-50":a.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 shadow-md transition"]),disabled:a.form.processing}," \u30DD\u30A4\u30F3\u30C8\u306B\u5909\u3048\u308B ",10,Se),e("button",{type:"button",onClick:s[4]||(s[4]=o=>l.delivery()),class:m([{"opacity-50":a.form.processing},"flex-1 py-3 rounded-lg font-semibold text-sm text-white bg-gray-600 hover:bg-gray-700 shadow-md transition"]),disabled:a.form.processing}," \u767A\u9001\u4F9D\u983C ",10,Ve)])]),Be])])]),_:1})],64)}const Ue=O(S,[["render",Fe]]);export{Ue as default};
