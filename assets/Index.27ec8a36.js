import{H as U,L as N,G as k,r as f,o as c,c as d,b as g,w,F as _,d as e,f as x,i as S,e as b,t as o,n as m,J as v,K as C,h as u,a2 as L}from"./app.5db884b0.js";import{A as T}from"./Admin.c65ac0bf.js";import{P as O}from"./Pagination.ccab08c5.js";import{a as B,u as F}from"./useConfirm.24f0e45b.js";import{_ as H}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as R}from"./ChevronRightIcon.d4657908.js";import{r as D}from"./EllipsisHorizontalIcon.ec2f4f87.js";import{r as z}from"./ArrowLeftIcon.cd119e88.js";const{confirm:y}=F(),E={components:{Head:U,AppLayout:T,Link:N,ChevronLeftIcon:B,ChevronRightIcon:R,EllipsisHorizontalIcon:D,ArrowLeftIcon:z,Pagination:O},props:{errors:Object,gacha:Object,category_share:Object,products:Object,search_cond:Object,totalProducts:Number,totalPoints:Number,searchProducts:Number,searchPoints:Number},data(){return{hasCheck:!1,main_tab:[{title:"\u767A\u9001\u4F9D\u983C\u4E2D",route_url:route("admin.delivery"),is_active:!0},{title:"\u767A\u9001\u6E08\u307F",route_url:route("admin.delivery.completed"),is_active:!1},{title:"\u53D6\u5F97\u6E08\u307F",route_url:route("admin.delivery.acquired"),is_active:!1}],page_step:0,is_busy:!1,profile:{},user_products:[],user:{},hasCheck:!1,isCheckAll:!1}},setup(l){const s=k(l.search_cond),r=k({user_id:0,checks:{},tracking_number:"",delete:!1,add_point:!1}),n=k({checks:{}});return{form:r,form_search:s,delivery_products:n}},methods:{changeCheck(){let l,s=!1;for(this.isCheckAll=this.user_products.length>0,l=0;l<this.user_products.length;l++)this.form.checks["id"+this.user_products[l].id]?s=!0:this.isCheckAll=!1;this.hasCheck=s},showProductDetail(l){this.is_busy=!0;const s={user_id:l};axios.post(route("admin.delivery.product_data"),s).then(r=>{if((r.status==201||r.status==200)&&r.data.status){this.profile=r.data.profile,this.user=r.data.user,this.user_products=r.data.products,this.page_step=1,this.form.user_id=this.user.id,this.form.checks={},this.form.tracking_number="",this.hasCheck=this.isCheckAll=!1;let n;for(n=0;n<this.user_products.length;n++)this.form.checks["id"+this.user_products[n].id]=!1}this.is_busy=!1}).catch(r=>{this.is_busy=!0})},changeUserCheck(l,s){let r=s.target.checked;this.delivery_products.checks["id"+l]=r},backToList(){this.page_step=0},submit(){this.hasCheck&&y("\u9078\u629E\u3057\u305F\u5546\u54C1\u3092\u767A\u9001\u3057\u307E\u3059\u304B?").then(l=>{l&&(this.form.delete=!1,this.form.add_point=!1,this.form.post(route("admin.delivery.post"),{onFinish:()=>{this.page_step=0}}))})},remove(){this.hasCheck&&y("\u9078\u629E\u3057\u305F\u5546\u54C1\u3092\u524A\u9664\u3057\u307E\u3059\u304B?").then(l=>{l&&(this.form.delete=!0,y(`\u9078\u629E\u3057\u305F\u5546\u54C1\u3092\u30DD\u30A4\u30F3\u30C8\u306B\u5909\u63DB\u3057\u307E\u3059\u3002
\u5909\u63DB\u3055\u308C\u305F\u30DD\u30A4\u30F3\u30C8\u3092\u914D\u5E03\u3057\u307E\u3059\u304B\uFF1F`).then(s=>{s!==0&&(this.form.add_point=s,this.form.post(route("admin.delivery.post"),{onFinish:()=>{this.page_step=0}}))}))})},search(){this.form_search.get(route("admin.delivery"))},checkall(){let l;for(this.hasCheck=!1,l=0;l<this.user_products.length;l++)this.form.checks["id"+this.user_products[l].id]=this.isCheckAll,this.hasCheck=this.isCheckAll},delivery_csv(){axios.post(route("admin.delivery.csv_post"),{checks:this.delivery_products.checks},{responseType:"blob"}).then(l=>{const s=new Blob([l.data],{type:"text/csv"}),r=document.createElement("a");r.href=window.URL.createObjectURL(s),r.download="\u767A\u9001\u4F9D\u983C\u4E00\u89A7.csv",r.click()})}}},M={key:0,class:"pt-2 md:px-6 px-4 mb-6"},q={class:"w-full text-neutral-400 mb-3"},G={class:"mb-2 flex justify-between items-center text-sm"},J=e("br",null,null,-1),K=e("br",null,null,-1),Q={class:"flex items-center gap-2 w-full flex-wrap mb-2 py-2 justify-between text-sm"},W={class:"flex items-center gap-2 flex-1"},X={class:"mb-6 grid grid-cols-1 md:grid-cols-2"},Y={key:0,class:"-mx-4 my-2 col-span-1 md:col-span-2"},Z={key:1,class:"flex border-neutral-600 border-l-8 border-b border items-center w-full px-2 my-1 -ml-1 hover:bg-slate-100 col-span-1 md:col-span-2 shadow"},$=["for"],ee=["id","onChange"],te={class:"flex-1"},se=["onClick"],oe={class:"flex border-neutral-200 items-center w-full hover:bg-slate-100 py-0.5 px-1 gap-1"},re={class:"flex items-center"},le={class:"relative"},ne=["src"],ie={key:0},ce=["src"],de={class:"cursor-pointer min-h-24 flex items-center justify-between flex-1 text-xs py-1 px-2 my-0.5"},ae={class:"text-left"},ue={class:"text-red-500"},he=["disabled"],_e={key:1,class:"pt-2 md:px-6 px-4 mb-6"},pe={class:"flex justify-between items-center sticky top-20 bg-white z-10 py-1.5"},fe={class:"flex items-center gap-2"},be=["disabled"],me=e("h2",{class:"text-lg font-bold"},"\u914D\u9001\u5546\u54C1\u8A73\u7D30",-1),ge={class:"text-center"},ve={class:"cursor-pointer flex items-center"},ke=e("span",{class:"ml-2"},"\u5168\u3066\u3092\u9078\u629E\u3059\u308B",-1),xe=e("hr",{class:"mb-3"},null,-1),ye={class:"mb-6 grid grid-cols-1 md:grid-cols-2"},we={class:"flex items-center"},Ce=["for"],Le={class:"relative"},je=["src"],Ae={key:0},Pe=["src"],Ve={class:"cursor-pointer h-24 flex items-center justify-between flex-1 text-xs py-1 px-2 my-0.5"},Ie={class:"text-left"},Ue={class:"text-red-500"},Ne=["id","onUpdate:modelValue"],Se=e("div",{class:"mb-1 text-base font-semibold"},"\u914D\u9001\u5148\u60C5\u5831",-1),Te=e("hr",{class:"mb-3"},null,-1),Oe={class:"w-full mb-6"},Be={class:"w-full text-sm"},Fe=e("td",{class:"p-1 w-2/5 font-bold"},"\u30A2\u30C9\u30EC\u30B9",-1),He={class:"p-1 w-3/5"},Re=e("td",{class:"p-1 w-2/5 font-bold"},"\u540D\u524D",-1),De={class:"p-1 w-3/5"},ze=e("td",{class:"p-1 w-2/5 font-bold"},"\u540D\u524D(\u30AB\u30CA)",-1),Ee={class:"p-1 w-3/5"},Me=e("td",{class:"p-1 w-2/5 font-bold"},"\u90F5\u4FBF\u756A\u53F7",-1),qe={class:"p-1 w-3/5"},Ge=e("td",{class:"p-1 w-2/5 font-bold"},"\u90FD\u9053\u5E9C\u770C",-1),Je={class:"p-1 w-3/5"},Ke=e("td",{class:"p-1 w-2/5 font-bold"},"\u4F4F\u6240",-1),Qe={class:"p-1 w-3/5"},We=e("td",{class:"p-1 w-2/5 font-bold"},"\u96FB\u8A71\u756A\u53F7",-1),Xe={class:"p-1 w-3/5"},Ye=e("td",{class:"p-1 w-2/5 font-bold"},"\u8FFD\u8DE1\u756A\u53F7",-1),Ze={class:"p-1 w-3/5"},$e={class:"mb-6 w-full text-center"},et=["disabled"],tt=["disabled"];function st(l,s,r,n,i,a){const j=f("Head"),A=f("Link"),P=f("ChevronRightIcon"),V=f("ArrowLeftIcon"),I=f("AppLayout");return c(),d(_,null,[g(j,{title:"\u914D\u9001\u5546\u54C1"}),g(I,null,{default:w(()=>[i.page_step==0?(c(),d("div",M,[e("div",q,[(c(!0),d(_,null,x(i.main_tab,(t,h)=>(c(),S(A,{href:t.route_url,class:m(["inline-block px-4 py-1.5",{"border-b-2 border-red-600 text-red-600":t.is_active}])},{default:w(()=>[b(o(t.title),1)]),_:2},1032,["href","class"]))),256))]),e("div",G,[e("p",null,[b(" \u7DCF\u5546\u54C1\u6570: "+o(r.totalProducts.toLocaleString())+" \u4EF6",1),J,b(" \u7DCF\u30DD\u30A4\u30F3\u30C8: "+o(r.totalPoints.toLocaleString())+" PT ",1)]),e("p",null,[b(" \u691C\u7D22\u5546\u54C1\u6570: "+o(r.searchProducts.toLocaleString())+" \u4EF6",1),K,b(" \u691C\u7D22\u30DD\u30A4\u30F3\u30C8: "+o(r.searchPoints.toLocaleString())+" PT ",1)])]),e("div",Q,[e("div",W,[v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.form_search.name=t),type:"text",placeholder:"\u540D\u524D\u3001\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u3001\u96FB\u8A71\u756A\u53F7\u3001\u5546\u54C1\u540D",class:"h-9 flex-1 w-0 border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md shadow-sm placeholder-neutral-300"},null,512),[[C,n.form_search.name]])]),e("button",{type:"button",onClick:s[1]||(s[1]=(...t)=>a.search&&a.search(...t)),class:"rounded-md border bg-neutral-600 text-white px-4 py-2"},"\u691C\u7D22")]),e("div",X,[(c(!0),d(_,null,x(r.products.data,(t,h)=>(c(),d(_,null,[h>0&&r.products.data[h-1].user_id!=t.user_id?(c(),d("hr",Y)):u("",!0),h==0||r.products.data[h-1].user_id!=t.user_id?(c(),d("div",Z,[e("label",{class:"flex-1 flex items-center gap-2 py-3 cursor-pointer",for:"user_checks["+t.user_id+"]"},[e("input",{type:"checkbox",id:"user_checks["+t.user_id+"]",onChange:p=>a.changeUserCheck(t.user_id,p),class:"h-4 w-4 rounded border-neutral-300 text-neutral-600 shadow-sm focus:ring-0"},null,40,ee),e("span",te,o(t.user_name)+" ( "+o(t.email)+" ) "+o(t.address),1)],8,$),e("button",{onClick:p=>a.showProductDetail(t.user_id),class:"text-sm"},[g(P,{class:"w-5"})],8,se)])):u("",!0),e("div",oe,[e("div",re,[e("div",le,[e("img",{src:t.image,class:"w-20 h-24 inline-block object-contain"},null,8,ne),t.black_case?(c(),d("div",ie,[e("img",{src:t.black_case,class:"w-6 h-6 inline-block object-contain absolute bottom-0 right-0"},null,8,ce)])):u("",!0)]),e("div",de,[e("div",ae,[e("div",null,o(t.name),1),e("div",null,o(t.gacha_title),1),e("div",null,o(t.rare),1),e("div",ue,o(t.point.toLocaleString())+"pt",1),e("div",null,o(t.updated_at),1)])])])])],64))),256))]),e("button",{type:"button",onClick:s[2]||(s[2]=t=>a.delivery_csv()),class:m([{"opacity-25":n.delivery_products.processing},"sticky bottom-3 float-right inline-block items-center px-8 py-2.5 bg-neutral-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-neutral-700 active:bg-neutral-700 focus:outline-none focus:border-neutral-700 focus:shadow-outline-neutral transition ease-in-out duration-150 m-1"]),disabled:n.delivery_products.processing}," \u767A\u9001CSV ",10,he)])):u("",!0),i.page_step==1?(c(),d("div",_e,[e("div",pe,[e("div",fe,[e("button",{type:"button",onClick:s[3]||(s[3]=t=>a.backToList()),class:m([{"opacity-25":n.form.processing},"p-1.5 rounded-full hover:bg-neutral-100"]),disabled:n.form.processing},[g(V,{class:"w-5"})],10,be),me]),e("div",ge,[e("label",ve,[v(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=t=>i.isCheckAll=t),onChange:s[5]||(s[5]=t=>a.checkall()),class:"h-5 w-5 rounded border-neutral-300 text-neutral-600 shadow-sm focus:ring-neutral-500"},null,544),[[L,i.isCheckAll]]),ke])])]),xe,e("div",ye,[(c(!0),d(_,null,x(i.user_products,(t,h)=>(c(),d("div",we,[e("label",{for:"checkbox"+t.id,class:"flex border-neutral-200 items-center w-full hover:bg-slate-100 py-0.5"},[e("div",Le,[e("img",{src:t.image,class:"w-20 h-24 inline-block object-contain"},null,8,je),t.black_case?(c(),d("div",Ae,[e("img",{src:t.black_case,class:"w-6 h-6 inline-block object-contain absolute bottom-0 right-0"},null,8,Pe)])):u("",!0)]),e("div",Ve,[e("div",Ie,[e("div",null,o(t.name),1),e("div",null,o(t.gacha_title),1),e("div",null,o(t.rare),1),e("div",Ue,o(t.point.toLocaleString())+"pt",1),e("div",null,o(t.updated_at),1),e("div",null,o(t.status),1)])]),v(e("input",{id:"checkbox"+t.id,"onUpdate:modelValue":p=>n.form.checks["id"+t.id]=p,type:"checkbox",onChange:s[6]||(s[6]=p=>a.changeCheck()),class:"cursor-pointer rounded border-neutral-300 text-neutral-600 shadow-sm focus:ring-neutral-500 m-1"},null,40,Ne),[[L,n.form.checks["id"+t.id]]])],8,Ce)]))),256))]),Se,Te,e("div",Oe,[e("table",Be,[e("tr",null,[Fe,e("td",He,o(i.user.email),1)]),i.profile?(c(),d(_,{key:0},[e("tr",null,[Re,e("td",De,o(i.profile.first_name)+" "+o(i.profile.last_name),1)]),e("tr",null,[ze,e("td",Ee,o(i.profile.first_name_gana)+"\u3000"+o(i.profile.last_name_gana),1)]),e("tr",null,[Me,e("td",qe,o(i.profile.postal_code),1)]),e("tr",null,[Ge,e("td",Je,o(i.profile.prefecture),1)]),e("tr",null,[Ke,e("td",Qe,o(i.profile.city)+o(i.profile.street)+"\u3000"+o(i.profile.building),1)]),e("tr",null,[We,e("td",Xe,o(i.profile.phone),1)]),e("tr",null,[Ye,e("td",Ze,[v(e("input",{type:"text",id:"tracking_number","onUpdate:modelValue":s[7]||(s[7]=t=>n.form.tracking_number=t),class:"h-10 rounded-sm w-full px-3 py-1 border border-yellow-300 focus:border-yellow-300 focus:ring focus:ring-yellow-200 focus:ring-opacity-50"},null,512),[[C,n.form.tracking_number]])])])],64)):u("",!0)])]),e("div",$e,[e("button",{type:"button",onClick:s[8]||(s[8]=t=>a.submit()),class:m([{"opacity-25":n.form.processing},"inline-block items-center px-8 py-2.5 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150 m-1"]),disabled:n.form.processing}," \u914D\u9001\u6E08\u307F\u306B\u3059\u308B ",10,et),e("button",{type:"button",onClick:s[9]||(s[9]=t=>a.remove()),class:m([{"opacity-25":n.form.processing},"inline-block items-center px-8 py-2.5 bg-neutral-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-neutral-700 active:bg-neutral-700 focus:outline-none focus:border-neutral-700 focus:shadow-outline-neutral transition ease-in-out duration-150 m-1"]),disabled:n.form.processing}," \u524A\u9664 ",10,tt)])])):u("",!0)]),_:1})],64)}const ut=H(E,[["render",st]]);export{ut as default};
