import{d as y,r as x,c as n,o as r,a as g,w as u,b as t,l as f,e as c,F as b,f as m,n as a,t as d,i as k,y as w,g as C}from"./app-Ct-hd0Am.js";import{U}from"./UserLayout-BK7-xARQ.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useConfirm-DwxSSItW.js";import"./index-BL8z1zGQ.js";const j={components:{Head:y.Head,AppLayout:U,Link:y.Link},props:{},data(){return{user:null,period:"",users:[],loading:!1,periods:[{title:"本日",period:"daily"},{title:"週間",period:"weekly"},{title:"月間",period:"monthly"}]}},setup(i){},computed:{is_admin(){return this.user&&this.user.type==1}},mounted(){this.user=y.usePage().props.value.auth.user,this.onPeriodSelection("daily")},methods:{onPeriodSelection(i){this.period!=i&&(this.loading=!0,this.users=[],this.period=i,C.get(route("ranking.data",{period:this.period})).then(l=>{this.loading=!1,this.users=l.data.users}).catch(l=>{}))},isCurrentUser(i){return this.user&&this.user.id===i}}},F={class:"h-full flex flex-col"},B={class:"px-4 pt-4 pb-1"},H={class:"pt-2 w-full"},S={class:"w-full text-neutral-500 space-x-1 border-b-4 border-yellow-500 px-4 flex justify-center"},z=["onClick"],N={class:"flex-1 relative"},P={key:0,class:"absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center bg-neutral-300/75 z-[20]"},V={class:"p-3"},A={class:"relative flex justify-center w-full pb-4"},D=["src"],E={class:"flex items-center gap-2"},M=["src"],R={class:"space-y-0.5 flex-1"};function T(i,l,q,G,o,s){const v=x("Head"),p=x("Link"),_=x("AppLayout");return r(),n(b,null,[g(v,{title:"ランキング"}),g(_,null,{default:u(()=>[t("div",F,[t("div",B,[l[2]||(l[2]=t("h1",{class:"text-xl font-bold flex gap-4 md:gap-6 items-end"},[c(" ランキング "),t("span",{class:"text-xs md:text-sm text-neutral-500 md:leading-6 leading-5"}," ※1時間毎に更新 ")],-1)),s.is_admin?(r(),f(p,{key:0,href:i.route("admin.ranking.history"),class:"text-sm border border-yellow-500 rounded-full px-3 py-1 hover:text-white hover:bg-yellow-500 absolute top-4 right-3"},{default:u(()=>[...l[0]||(l[0]=[c(" 報酬履歴 ",-1)])]),_:1},8,["href"])):(r(),f(p,{key:1,href:i.route("ranking.about"),class:"text-sm border border-yellow-500 rounded-full px-3 py-1 hover:text-white hover:bg-yellow-500 absolute top-4 right-3"},{default:u(()=>[...l[1]||(l[1]=[c(" 報酬について ",-1)])]),_:1},8,["href"]))]),t("div",H,[t("div",S,[(r(!0),n(b,null,m(o.periods,(e,h)=>(r(),n("button",{onClick:I=>s.onPeriodSelection(e.period),class:a(["-mb-[1px] flex-1 inline-block text-center py-1.5 rounded-t-md border-yellow-500 border-x border-t",{"bg-yellow-500 text-white":e.period==o.period,"hover:bg-yellow-400 hover:text-white":e.period!=o.period}])},d(e.title),11,z))),256))])]),t("div",N,[o.loading?(r(),n("div",P,[...l[3]||(l[3]=[t("div",{class:"w-16 h-16 bg-white p-4 rounded-full shadow-lg"},[t("svg",{class:"animate-spin h-8 w-8 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})])],-1)])])):k("",!0),t("div",V,[(r(!0),n(b,null,m(o.users,(e,h)=>(r(),n("div",null,[e.total_points==o.users[0].total_points?(r(),n("div",{key:0,class:a(["flex justify-center flex-col items-center gap-1 py-2 border-b",{"bg-yellow-50 rounded-lg px-3 py-3 border-2 border-yellow-400":s.isCurrentUser(e.id)}])},[t("div",A,[t("div",{class:a(["w-24 h-24 rounded-full border-2 overflow-hidden relative",{"ring-4 ring-yellow-400 ring-offset-2":s.isCurrentUser(e.id)}]),style:w({backgroundColor:e.bg_color||"#FFD700"})},[t("img",{src:o.users[0].avatar?"/images/avatars/"+o.users[0].avatar:"/images/user_icon.png",class:"w-full h-full object-cover"},null,8,D)],6),l[4]||(l[4]=t("img",{src:"/images/top_one.svg",class:"w-28 absolute bottom-0"},null,-1))]),t("div",E,[s.is_admin?(r(),f(p,{key:0,href:i.route("admin.users.detail",{id:o.users[0].id}),class:a(["flex font-bold text-base hover:text-yellow-500",{"text-yellow-600":s.isCurrentUser(e.id)}])},{default:u(()=>[c(d(o.users[0].name),1)]),_:1},8,["href","class"])):(r(),n("span",{key:1,class:a(["flex font-bold text-base",{"text-yellow-600":s.isCurrentUser(e.id)}])},d(o.users[0].name),3))])],2)):(r(),n("div",{key:1,class:a(["flex items-center gap-2.5 border-b py-2 rounded-lg px-2 transition-all",{"bg-yellow-50 border-2 border-yellow-400":s.isCurrentUser(e.id),"border-transparent":!s.isCurrentUser(e.id)}])},[t("span",{class:a(["w-8 text-center text-xl font-[mplus2]",{"text-yellow-600 font-bold":s.isCurrentUser(e.id)}])},d(o.users[h-1].total_points!=e.total_points?h+1:""),3),t("div",{class:a(["w-14 h-14 rounded-full border overflow-hidden relative",{"ring-2 ring-yellow-400 ring-offset-1":s.isCurrentUser(e.id)}]),style:w({backgroundColor:e.bg_color||"#FFD700"})},[t("img",{src:e.avatar?"/images/avatars/"+e.avatar:"/images/user_icon.png",class:"w-full h-full object-cover"},null,8,M)],6),t("div",R,[s.is_admin?(r(),f(p,{key:0,href:i.route("admin.users.detail",{id:e.id}),class:a(["flex font-bold text-base hover:text-yellow-500",{"text-yellow-600":s.isCurrentUser(e.id)}])},{default:u(()=>[c(d(e.name),1)]),_:2},1032,["href","class"])):(r(),n("span",{key:1,class:a(["flex font-bold text-base",{"text-yellow-600":s.isCurrentUser(e.id)}])},d(e.name),3))])],2))]))),256))])])])]),_:1})],64)}const X=L(j,[["render",T]]);export{X as default};
