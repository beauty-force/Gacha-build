import{d as c,r as p,l as f,o as d,w as o,a as x,b as e,c as i,i as _,e as y,F as w,f as v,t as n,n as k}from"./app-DqbpHCH1.js";import{A as L}from"./Admin-sCihLsPb.js";import{u as S}from"./useConfirm-DFPtZnQT.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{confirm:D}=S(),H={components:{Head:c.Head,Link:c.Link,AdminLayout:L},props:{notifications:Array},methods:{isScheduled(s){return s.published_at?new Date(s.published_at)>new Date:!1},getPublishStatusLabel(s){return s.is_published?this.isScheduled(s)?"配信予定":"公開":"非公開"},formatDate(s){const t=new Date(s),l=t.getFullYear(),m=String(t.getMonth()+1).padStart(2,"0"),h=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),u=String(t.getMinutes()).padStart(2,"0");return`${l}/${m}/${h} ${a}:${u}`},getTypeLabel(s){return{announcement:"お知らせ",maintenance:"メンテナンス",event:"イベント",campaign:"キャンペーン",important:"重要"}[s]||s||"お知らせ"},truncateMessage(s){if(!s)return"";const t=100;return s.length<=t?s:s.substring(0,t)+"..."},deleteNotification(s){D("このお知らせを削除しますか？","削除すると元に戻せません。","warning").then(t=>{t&&c.useForm({}).delete(route("admin.notifications.destroy",s))})}}},A={class:"py-2"},M={class:"max-w-7xl mx-auto sm:px-0 lg:px-2"},B={class:"bg-white shadow-sm sm:rounded-lg"},N={class:"p-4 text-gray-900"},V={class:"flex justify-between items-center mb-6"},F={class:"overflow-x-scroll w-full"},j={class:"min-w-full divide-y divide-gray-200"},T={class:"bg-white divide-y divide-gray-200"},z={class:"px-3 py-4"},E={class:"text-sm font-medium text-gray-900 max-w-md line-clamp-2",style:{"white-space":"pre-line"}},P={class:"text-xs text-gray-500 mt-1"},I={class:"px-3 py-4 whitespace-nowrap text-sm text-gray-500"},Y={class:"text-xs text-gray-400 mt-1"},q={class:"px-3 py-4 whitespace-nowrap"},G={key:0,class:"text-xs text-amber-700 mt-1"},J={class:"px-3 py-4 whitespace-nowrap text-sm font-medium"},K={class:"flex space-x-2"},O=["onClick"],Q={key:0,class:"text-center py-12"};function R(s,t,l,m,h,a){const u=p("Head"),g=p("Link"),b=p("AdminLayout");return d(),f(b,null,{default:o(()=>[x(u,null,{default:o(()=>[...t[0]||(t[0]=[e("title",null,"お知らせ管理",-1)])]),_:1}),e("div",A,[e("div",M,[e("div",B,[e("div",N,[e("div",V,[t[2]||(t[2]=e("h3",{class:"text-lg font-semibold"},"お知らせ一覧",-1)),x(g,{href:s.route("admin.notifications.create"),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},{default:o(()=>[...t[1]||(t[1]=[y(" 新規作成 ",-1)])]),_:1},8,["href"])]),e("div",F,[e("table",j,[t[5]||(t[5]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-3 text-left text-sm text-nowrap text-gray-500 uppercase tracking-wider"}," メッセージ "),e("th",{class:"px-3 py-3 text-left text-sm text-nowrap text-gray-500 uppercase tracking-wider"}," 配信対象 "),e("th",{class:"px-3 py-3 text-left text-sm text-nowrap text-gray-500 uppercase tracking-wider"}," 公開状態 "),e("th",{class:"px-3 py-3 text-left text-sm text-nowrap text-gray-500 uppercase tracking-wider"}," 操作 ")])],-1)),e("tbody",T,[(d(!0),i(w,null,v(l.notifications,r=>(d(),i("tr",{key:r.id},[e("td",z,[e("div",E,n(a.truncateMessage(r.message)),1),e("div",P,n(a.getTypeLabel(r.type))+" | "+n(a.formatDate(r.created_at)),1)]),e("td",I,[y(n(r.target_name)+" ",1),e("div",Y," 読了: "+n(r.read_count)+" / "+n(r.user_count),1)]),e("td",q,[e("span",{class:k({"px-2 inline-flex text-xs leading-5 font-semibold rounded-full":!0,"bg-green-100 text-green-800":r.is_published&&!a.isScheduled(r),"bg-amber-100 text-amber-800":r.is_published&&a.isScheduled(r),"bg-gray-100 text-gray-800":!r.is_published})},n(a.getPublishStatusLabel(r)),3),r.is_published&&a.isScheduled(r)?(d(),i("div",G,n(a.formatDate(r.published_at))+" から表示 ",1)):_("",!0)]),e("td",J,[e("div",K,[x(g,{href:s.route("admin.notifications.edit",r.id),class:"text-indigo-600 hover:text-indigo-900 p-1 rounded hover:bg-indigo-50",title:"編集"},{default:o(()=>[...t[3]||(t[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),_:1},8,["href"]),e("button",{onClick:U=>a.deleteNotification(r.id),class:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"削除"},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,O)])])]))),128))])])]),l.notifications.length===0?(d(),i("div",Q,[...t[6]||(t[6]=[e("p",{class:"text-gray-500"},"お知らせがありません",-1)])])):_("",!0)])])])])]),_:1})}const ee=C(H,[["render",R]]);export{ee as default};
