import{r as u,o as n,i as v,w as h,b as d,d as e,t as l,c as i,L as w,u as y,G as C,F as x,f as D,n as P,h as k}from"./app.43138155.js";import{_ as b}from"./_plugin-vue_export-helper.cdc0426e.js";import{N as B,e as T,o as G,f as N}from"./useConfirm.9d3b096f.js";import{r as j}from"./PlayIcon.f968e08b.js";const S={name:"GachaConfirmDialog",components:{Dialog:B,DialogPanel:T,TransitionChild:G,TransitionRoot:N},props:{isOpen:{type:Boolean,default:!1},gachaTitle:{type:String,required:!0},number:{type:Number,required:!0},pointCost:{type:Number,required:!0},currentPoints:{type:Number,required:!0},isDpGacha:{type:Boolean,default:!1},thumbnail:{type:String,required:!0}},computed:{remainingPoints(){return this.currentPoints-this.pointCost},pointType(){return this.isDpGacha?"EP":"\u30DD\u30A4\u30F3\u30C8"}},methods:{formatNumber(t){return String(t).replace(/(.)(?=(\d{3})+$)/g,"$1,")},closeDialog(){this.$emit("close")},confirmAction(){this.$emit("confirm"),this.closeDialog()}}},q=e("div",{class:"fixed inset-0 bg-black/50"},null,-1),E={class:"fixed inset-0 overflow-y-auto"},L={class:"flex min-h-full items-center justify-center p-4"},F=["src"],A={class:"text-center my-4"},I={class:"text-lg font-bold text-gray-900 mb-2"},O=e("p",{class:"text-base text-gray-700 mb-1 font-medium"}," \u30AC\u30C1\u30E3\u3092\u5F15\u304D\u307E\u3059\u304B\uFF1F ",-1),R={class:"text-sm text-gray-600 font-medium"},U={class:"flex items-center justify-center mb-6 bg-gray-50 rounded-lg p-4"},V={class:"flex items-center space-x-2"},z={class:"text-lg font-bold text-gray-900"},H={class:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center"},J={key:0,src:"/images/icon_cash.png",class:"w-8 h-8"},K={key:1,class:"text-sm text-white"},M=e("div",{class:"mx-4 text-2xl text-gray-400"},">",-1),Q={class:"flex items-center space-x-2"},W={class:"text-lg font-bold text-gray-900"},X={class:"w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center"},Y={key:0,src:"/images/icon_cash.png",class:"w-8 h-8"},Z={key:1,class:"text-sm text-white"},$={class:"flex flex-col space-y-3"};function tt(t,s,a,f,r,o){const g=u("TransitionChild"),m=u("DialogPanel"),c=u("Dialog"),p=u("TransitionRoot");return n(),v(p,{appear:"",show:a.isOpen,as:"template"},{default:h(()=>[d(c,{as:"div",onClose:o.closeDialog,class:"relative z-50"},{default:h(()=>[d(g,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:h(()=>[q]),_:1}),e("div",E,[e("div",L,[d(g,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:h(()=>[d(m,{class:"w-full max-w-md transform overflow-hidden rounded-lg bg-white p-6 text-left align-middle shadow-xl transition-all font-[noto-sans-jp]"},{default:h(()=>[e("img",{src:a.thumbnail,class:"w-full h-auto"},null,8,F),e("div",A,[e("h3",I," \u300C"+l(a.gachaTitle)+"\u300D ",1),O,e("p",R,l(a.number)+"\u56DE\u5206\u306E"+l(o.pointType)+"\u3092\u6D88\u8CBB\u3057\u307E\u3059\u3002 ",1)]),e("div",U,[e("div",V,[e("span",z,l(a.currentPoints.toLocaleString()),1),e("div",H,[a.isDpGacha?(n(),i("span",K,"EP")):(n(),i("img",J))])]),M,e("div",Q,[e("span",W,l(o.remainingPoints.toLocaleString()),1),e("div",X,[a.isDpGacha?(n(),i("span",Z,"EP")):(n(),i("img",Y))])])]),e("div",$,[e("button",{onClick:s[0]||(s[0]=(..._)=>o.confirmAction&&o.confirmAction(..._)),class:"w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-4 rounded-md transition-colors duration-200"}," \u30AA\u30EA\u30D1\u3092\u5F15\u304F "),e("button",{onClick:s[1]||(s[1]=(..._)=>o.closeDialog&&o.closeDialog(..._)),class:"w-full bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-md transition-colors duration-200"}," \u30AD\u30E3\u30F3\u30BB\u30EB ")])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}const et=b(S,[["render",tt]]);const st={components:{Link:w,PlayIcon:j,GachaConfirmDialog:et},props:{gacha:Object},data(){return{category_share:y().props.value.category_share,processing:!1,buttons:[],showConfirmDialog:!1,selectedNumber:0,selectedPointCost:0,colorThemes:["from-neutral-500 to-neutral-700 hover:from-neutral-600 hover:to-neutral-800","from-yellow-400 to-yellow-600 hover:from-yellow-500 hover:to-yellow-700","from-red-500 to-red-700 hover:from-red-600 hover:to-red-800","from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800","from-green-500 to-green-700 hover:from-green-600 hover:to-green-800"]}},computed:{displayButtons(){if(!this.buttons||this.buttons.length===0)return this.getDefaultButtons();const t=this.buttons.filter(s=>s<=this.gacha.count_rest);return t.length===0?[]:(t[t.length-1]<this.gacha.count_rest&&this.buttons.length>t.length&&t.push(this.gacha.count_rest),t.map((s,a)=>{const f=s*this.gacha.point,r=s>=this.gacha.count_rest?"\u5168\u3066":s==1?"1\u56DE":`${s}\u9023`,o=a%this.colorThemes.length;return{number:s,point:f,text:r,classes:s>=this.gacha.count_rest||s>=100?"all_button":this.colorThemes[o]}}))},currentUserPoints(){const t=y().props.value.auth.user;return t?this.gacha.dp_gacha?t.dp:t.point:0}},methods:{format_number(t){return String(t).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getDefaultButtons(){const t=[];if(t.push({number:1,point:this.gacha.point,text:"1\u56DE",classes:this.colorThemes[0]}),this.gacha.count_rest>1&&(this.gacha.gacha_limit==0||this.gacha.gacha_limit>1)){const s=this.gacha.count_rest<=10?this.gacha.count_rest:10;t.push({number:s,point:s*this.gacha.point,text:this.gacha.count_rest<=10?"\u5168\u3066":"10\u9023",classes:this.colorThemes[1]})}if(this.gacha.count_rest>10&&(this.gacha.gacha_limit==0||this.gacha.gacha_limit>10)){const s=this.gacha.count_rest<=100?this.gacha.count_rest:100;t.push({number:s,point:s*this.gacha.point,text:this.gacha.count_rest<=100?"\u5168\u3066":"100\u9023",classes:"all_button"})}return t},clickgacha(t){this.selectedNumber=t,this.selectedPointCost=this.gacha.point*t,!(this.currentUserPoints<this.selectedPointCost)&&(this.showConfirmDialog=!0)},closeConfirmDialog(){this.showConfirmDialog=!1},confirmGacha(){this.start_gacha(this.selectedNumber)},start_gacha(t){this.processing=!0,!this.url_edit&&C({id:this.gacha.id,number:t,code:this.gacha.code}).post(route("user.gacha.start_post"),{onFinish:()=>{this.processing=!1}})}},mounted(){this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix),this.buttons=this.gacha.buttons?this.gacha.buttons.split(",").map(t=>parseInt(t)).sort((t,s)=>t-s):[]}},ot={key:0,class:"w-full mx-auto flex flex-col justify-center py-1 px-1 gap-2 md:max-w-md"},at={class:"grid grid-cols-2 gap-2 font-[mplus2]"},nt=["onClick","disabled"],it={class:"text-nowrap flex items-center justify-center min-w-36"},rt={class:"font-extrabold text-[15px]"},ct=e("span",{class:"font-semibold text-[11px]"},"\u30AC\u30C1\u30E3",-1),lt={class:"font-semibold text-[13px] ml-2 px-0.5"},ht=e("span",{class:"font-semibold text-[13px]"},"EP",-1),ut=e("img",{src:"/images/icon_cash.png",class:"ml-2 mr-1 h-4"},null,-1),dt={class:"font-semibold text-[13px]"};function gt(t,s,a,f,r,o){var m;const g=u("GachaConfirmDialog");return a.gacha.count_rest>0?(n(),i("div",ot,[e("div",at,[(n(!0),i(x,null,D(o.displayButtons,(c,p)=>(n(),i("button",{key:c.number,onClick:_=>o.clickgacha(c.number),class:P([[c.classes,{"opacity-50":r.processing},{"col-span-2":p===o.displayButtons.length-1&&o.displayButtons.length%2===1}],"cursor-pointer rounded-md bg-gradient-to-br border border-yellow-400/50 text-white text-center space-y-1 pt-1.5 pb-2"]),disabled:r.processing},[e("div",it,[e("span",rt,l(c.text),1),ct,a.gacha.dp_gacha?(n(),i(x,{key:0},[e("span",lt,l(o.format_number(c.point)),1),ht],64)):(n(),i(x,{key:1},[ut,e("span",dt,l(o.format_number(c.point)),1)],64))])],10,nt))),128))]),d(g,{"is-open":r.showConfirmDialog,"gacha-title":a.gacha.title,number:r.selectedNumber,"point-cost":r.selectedPointCost,thumbnail:(m=a.gacha.thumbnail)!=null?m:a.gacha.image,"current-points":o.currentUserPoints,"is-dp-gacha":a.gacha.dp_gacha,onClose:o.closeConfirmDialog,onConfirm:o.confirmGacha},null,8,["is-open","gacha-title","number","point-cost","thumbnail","current-points","is-dp-gacha","onClose","onConfirm"])])):k("",!0)}const xt=b(st,[["render",gt]]);export{xt as G};
