import{o as n,c as i,d as t,t as a,h,G as S,q as x,i as H,w as v,b as _,D as m,H as q,F as g,f as C,I as $,n as L,e as z,J as G,ab as R,a as T}from"./app.ca94a14d.js";import{A as U}from"./UserLayout.4f83c65f.js";import{u as K}from"./useConfirm.8e89a0dc.js";import{o as A,f as O}from"./Category.7b503dfa.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.b203fd80.js";const Q={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},W={class:"flex flex-col items-center"},X=t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-theme"},null,-1),Y={class:"mt-2 text-white text-sm"},Z={__name:"Loading",props:{show:{type:Boolean,default:!1},message:{type:String,default:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."}},setup(o){return(y,D)=>o.show?(n(),i("div",Q,[t("div",W,[X,t("p",Y,a(o.message),1)])])):h("",!0)}},tt={class:"py-4"},et={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},st={class:"bg-white overflow-hidden"},ot={class:"p-6 bg-white border-gray-200"},nt={key:0,class:"text-lg font-semibold mb-6"},it={key:1,class:"mb-8 p-6 bg-blue-50 rounded-lg"},at={class:"flex flex-wrap justify-between md:grid md:grid-cols-3 gap-4"},lt=t("p",{class:"text-sm text-blue-600"},"\u30D7\u30E9\u30F3\u540D",-1),rt={class:"font-medium"},dt=t("p",{class:"text-sm text-blue-600"},"\u958B\u59CB\u65E5",-1),ct={class:"font-medium"},ut=t("p",{class:"text-sm text-blue-600"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),mt={class:"font-medium"},bt={class:"flex flex-wrap items-end justify-between mt-3"},_t={key:0,class:"flex items-center py-2"},ht={class:"flex items-center gap-1"},ft=["src","alt"],pt={class:"font-medium"},xt={class:"text-sm text-gray-500"},vt={class:"text-xs text-gray-500"},gt=["disabled"],yt=t("h3",{class:"text-lg font-semibold mb-6"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),wt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},kt={class:"text-xl font-bold mb-2"},St={class:"text-gray-600 mb-4"},Ct={class:"mb-4"},$t={class:"text-xl font-bold leading-8"},Dt=t("span",{class:"text-sm font-normal"},"/\u6708",-1),Ft={class:"text-green-600 text-sm"},Nt={key:0},jt=["onSubmit"],Bt=["disabled"],Lt={key:1},zt=["onClick"],At={key:1,class:"w-full bg-gray-200 text-gray-600 font-bold py-2 px-4 rounded cursor-not-allowed",disabled:""},Vt={class:"py-3 px-1 text-center"},It={class:"font-bold text-lg"},Mt={class:"text-lg font-bold text-theme mt-1"},Jt=t("span",{class:"text-sm font-normal"},"/\u6708",-1),Pt={class:"p-2"},Et={key:0,class:"text-sm text-gray-500 mb-2"},Ht={key:1,class:"space-y-2"},qt=["onClick"],Gt=["id","value"],Rt=["for"],Tt={class:"flex items-center"},Ut=["src","alt"],Kt={class:"font-medium"},Ot={class:"text-sm text-gray-500"},Qt={class:"text-xs text-gray-500"},Wt={key:2,class:"text-gray-500 mb-2"},Xt=t("hr",{class:"my-1"},null,-1),Yt={class:"flex justify-between p-2"},Zt={class:"space-x-2"},te=["disabled"],le={__name:"Index",props:{plans:Array,currentSubscription:Array,cards:Array},setup(o){const y=o,{confirm:D}=K(),w=S({}),k=x(!1),d=x(""),c=x(null),r=x(!1),f=e=>new Intl.NumberFormat("ja-JP").format(e),V=e=>new Date(e).toLocaleDateString("ja-JP"),F=e=>`/images/credit_cards/${e.toLowerCase()}.svg`,N=e=>e.replace(/(.{4})/g,"$1 ").trim(),j=e=>`${e.slice(0,2)}/${e.slice(2)}`,I=()=>{D("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u3092\u30AD\u30E3\u30F3\u30BB\u30EB\u3057\u3066\u3082\u3088\u308D\u3057\u3044\u3067\u3059\u304B\uFF1F").then(e=>{e&&(r.value=!0,w.post(route("user.subscription.cancel",y.currentSubscription.id),{onFinish:()=>{r.value=!1}}))})},M=()=>{r.value=!0,T.get(route("user.point.card_register")).then(e=>{r.value=!1,e.data.status==1&&(window.location.href=e.data.link_url)}).catch(()=>{r.value=!1})},J=e=>{c.value=e,k.value=!0},p=()=>{k.value=!1,d.value="",c.value=null},P=()=>{c.value&&d.value&&(r.value=!0,S({card_id:d.value}).post(route("user.subscription.subscribe",c.value.id),{onFinish:()=>{r.value=!1,p()},preserveScroll:!0}))},E=e=>{r.value=!0,S({plan_id:e.id}).post(route("user.subscription.update",y.currentSubscription.id),{onFinish:()=>{r.value=!1},preserveScroll:!0})};return(e,u)=>(n(),H(U,null,{default:v(()=>[_(m(q),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),_(Z,{show:r.value},null,8,["show"]),t("div",tt,[t("div",et,[t("div",st,[t("div",ot,[o.currentSubscription?(n(),i("h3",nt,"\u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3")):h("",!0),o.currentSubscription?(n(),i("div",it,[t("div",at,[t("div",null,[lt,t("p",rt,a(o.currentSubscription.plan.name),1)]),t("div",null,[dt,t("p",ct,a(V(o.currentSubscription.start_date)),1)]),t("div",null,[ut,t("p",mt,a(f(o.currentSubscription.plan.point))+" pt",1)])]),t("div",bt,[(n(!0),i(g,null,C(o.cards,s=>(n(),i(g,null,[o.currentSubscription.card_id===s.id?(n(),i("div",_t,[t("div",ht,[t("img",{src:F(s.brand),alt:s.brand,class:"w-20 h-12 mr-2"},null,8,ft),t("div",null,[t("p",pt,a(N(s.card_no)),1),t("p",xt,"\u6709\u52B9\u671F\u9650: "+a(j(s.expire)),1),t("p",vt,"\u540D\u7FA9\u4EBA: "+a(s.holder_name),1)])])])):h("",!0)],64))),256)),t("form",{onSubmit:u[0]||(u[0]=$(s=>I(),["prevent"])),class:"mt-4"},[t("button",{type:"submit",class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded text-sm",disabled:m(w).processing}," \u30AD\u30E3\u30F3\u30BB\u30EB ",8,gt)],32)])])):h("",!0),yt,t("div",wt,[(n(!0),i(g,null,C(o.plans,s=>{var b;return n(),i("div",{key:s.id,class:L(["border rounded-lg p-6",{"bg-yellow-50 border-yellow-500 border-2":((b=o.currentSubscription)==null?void 0:b.plan_id)===s.id}])},[t("h4",kt,a(s.name),1),t("p",St,a(s.description),1),t("div",Ct,[t("p",$t,[z("\xA5"+a(f(s.amount)),1),Dt]),t("p",Ft,a(f(s.point))+" \u30DD\u30A4\u30F3\u30C8\u4ED8\u4E0E",1)]),o.currentSubscription?(n(),i("div",Lt,[o.currentSubscription.plan_id!=s.id?(n(),i("button",{key:0,class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-4 rounded text-sm",onClick:l=>E(s)}," \u30D7\u30E9\u30F3\u5909\u66F4 ",8,zt)):(n(),i("button",At," \u73FE\u5728\u306E\u30D7\u30E9\u30F3 "))])):(n(),i("div",Nt,[t("form",{onSubmit:$(l=>J(s),["prevent"])},[t("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-4 rounded text-sm",disabled:m(w).processing}," \u30B5\u30D6\u30B9\u30AF\u30E9\u30A4\u30D6 ",8,Bt)],40,jt)]))],2)}),128))])])])])]),_(m(O),{show:k.value,class:""},{default:v(()=>[_(m(A),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:v(()=>{var s,b;return[t("div",{class:"fixed inset-0 z-40",onClick:p},[t("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:u[2]||(u[2]=$(()=>{},["stop"]))},[t("div",Vt,[t("div",It,a((s=c.value)==null?void 0:s.name),1),t("div",Mt,[z("\xA5 "+a(f((b=c.value)==null?void 0:b.amount)),1),Jt])]),t("div",Pt,[o.cards.length>0?(n(),i("div",Et,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):h("",!0),o.cards.length>0?(n(),i("div",Ht,[(n(!0),i(g,null,C(o.cards,l=>(n(),i("div",{key:l.id,class:L([{"border-yellow-500 bg-yellow-50 border-2":d.value===l.id,"hover:bg-gray-50 hover:border-gray-300":d.value!==l.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:B=>d.value=l.id},[G(t("input",{type:"radio",id:"card-"+l.id,value:l.id,"onUpdate:modelValue":u[1]||(u[1]=B=>d.value=B),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,Gt),[[R,d.value]]),t("label",{for:"card-"+l.id,class:"flex-1 cursor-pointer"},[t("div",Tt,[t("img",{src:F(l.brand),alt:l.brand,class:"w-20 h-12 mr-2"},null,8,Ut),t("div",null,[t("p",Kt,a(N(l.card_no)),1),t("p",Ot,"\u6709\u52B9\u671F\u9650: "+a(j(l.expire)),1),t("p",Qt,"\u540D\u7FA9\u4EBA: "+a(l.holder_name),1)])])],8,Rt)],10,qt))),128))])):(n(),i("div",Wt," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),Xt,t("button",{onClick:M,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),t("div",Yt,[t("div",Zt,[t("button",{onClick:p,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),t("button",{onClick:P,class:"bg-theme text-white px-4 py-2 rounded text-sm",disabled:!d.value}," \u9078\u629E\u3057\u305F\u30AB\u30FC\u30C9\u3067\u30B5\u30D6\u30B9\u30AF\u30E9\u30A4\u30D6 ",8,te)])])])])]}),_:1}),_(m(A),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:v(()=>[t("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:p})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{le as default};
