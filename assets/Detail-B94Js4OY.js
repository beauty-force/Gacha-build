import{d as m,r as c,c as l,o as d,a as b,w as g,b as t,i as a,t as r,e as w,F as f,j as p,v as h,k as L,f as x,y as _,n as k,m as T}from"./app-Ct-hd0Am.js";import{A as j}from"./Admin-CJNxv3aF.js";import{u as V}from"./useConfirm-DwxSSItW.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{confirm:v}=V(),P={components:{Head:m.Head,AppLayout:j,Link:m.Link},props:{errors:Object,user:Object,profile:Object,rank:String,auth:Object,subscription:Object,allTags:Array},methods:{submit(){this.form.post(route("admin.users.update"),{preserveScroll:!0,onFinish:()=>{}})},add_point(n){m.useForm({id:this.user.id,point:n}).post(route("admin.users.add_point"),{preserveScroll:!0,onFinish:()=>{this.form.point=this.user.point}})},updateStatus(n,e){e==0?v("アカウントをブロックしますか？","獲得した商品と発送依頼中の商品は全て回収されます。","warning").then(s=>{s&&m.useForm({id:n,status:e}).post(route("admin.users.update"))}):v("アカウントを承認しますか？").then(s=>{s&&m.useForm({id:n,status:e}).post(route("admin.users.update"))})},isTagSelected(n){return this.tagForm.tag_ids.includes(n)},assignTags(){this.tagForm.post(route("admin.users.assign_tags"),{preserveScroll:!0,onFinish:()=>{}})},format_number(n){return String(n).replace(/(.)(?=(\d{3})+$)/g,"$1,")}},setup(n){const e=m.useForm({id:n.user.id,point:n.user.point,dp:n.user.dp,type:n.user.type}),s=m.useForm({user_id:n.user.id,tag_ids:n.user.tags?n.user.tags.map(i=>i.id):[]});return{form:e,tagForm:s}}},A={class:"md:px-4 px-2"},B={class:"border-b w-full p-2 my-2 font-semibold flex justify-between items-center"},H={class:"flex gap-2"},O={class:"w-full text-sm"},D={class:"p-1 w-3/5"},N={class:"p-1 w-3/5"},U={key:0,class:"p-1 w-3/5"},E={class:"flex gap-2 mt-2"},z={key:1,class:"p-1 w-3/5"},J={key:0,class:"p-1 w-3/5"},I={key:1,class:"p-1 w-3/5"},Y={class:"p-1 w-3/5"},q={class:"p-1 w-3/5"},G={class:"p-1 w-3/5"},K={class:"p-1 w-3/5"},Q={class:"p-1 w-3/5"},R={class:"p-1 w-3/5"},W={class:"p-1 w-3/5"},X={key:0},Z={class:"p-1 w-3/5"},$={class:"p-1 w-3/5"},tt={key:2},et={class:"p-1 w-3/5"},st={key:3},ot={class:"p-1 w-3/5"},rt={class:"p-1 w-3/5"},nt={class:"space-y-2"},lt={class:"flex flex-wrap gap-2 mb-2"},dt={key:0,class:"text-gray-400 text-sm"},it={class:"flex flex-wrap gap-2"},ut=["value"],at={class:"text-sm"},mt={key:0,class:"text-xs text-gray-500"},ft=["disabled"],bt={key:0,class:"my-6 text-center border border-yellow-500 rounded-full p-0.5 w-fit mx-auto text-sm"},pt=["disabled"];function ct(n,e,s,i,gt,u){const S=c("Head"),y=c("Link"),C=c("AppLayout");return d(),l(f,null,[b(S,{title:"ユーザー管理"}),b(C,null,{default:g(()=>[t("div",A,[t("div",B,[t("h3",null,"ユーザー詳細 (ID-"+r(s.user.id)+")",1),t("div",H,[b(y,{href:n.route("admin.users.history",{id:s.user.id}),class:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 text-sm"},{default:g(()=>[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),w(" 履歴を表示 ",-1)])]),_:1},8,["href"]),b(y,{href:n.route("admin.users"),class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-normal text-white bg-red-500 hover:bg-red-400 rounded-md transition-colors"},{default:g(()=>[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),w(" 戻る ",-1)])]),_:1},8,["href"])])]),t("table",O,[t("tbody",null,[s.user?(d(),l(f,{key:0},[t("tr",null,[e[12]||(e[12]=t("td",{class:"p-1 w-2/5 font-bold"},"メールアドレス",-1)),t("td",D,r(s.user.email),1)]),t("tr",null,[e[13]||(e[13]=t("td",{class:"p-1 w-2/5 font-bold"},"電話番号",-1)),t("td",N,r(s.profile?s.profile.phone:s.user.phone),1)]),t("tr",null,[e[14]||(e[14]=t("td",{class:"p-1 w-2/5 font-bold"},"ポイント",-1)),s.auth.user.type==1||s.auth.user.type==2?(d(),l("td",U,[p(t("input",{class:"bg-white/90 w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400",type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>i.form.point=o)},null,512),[[h,i.form.point]]),t("div",E,[t("button",{type:"button",onClick:e[1]||(e[1]=o=>u.add_point(500)),class:"px-4 py-2 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-md shadow-md hover:from-green-500 hover:to-blue-600 transition duration-300 ease-in-out transform hover:scale-105"}," +500 PT "),t("button",{type:"button",onClick:e[2]||(e[2]=o=>u.add_point(1e3)),class:"px-4 py-2 bg-gradient-to-r from-purple-400 to-pink-500 text-white rounded-md shadow-md hover:from-purple-500 hover:to-pink-600 transition duration-300 ease-in-out transform hover:scale-105"}," +1,000 PT ")])])):(d(),l("td",z,r(s.user.point.toLocaleString()),1))]),t("tr",null,[e[15]||(e[15]=t("td",{class:"p-1 w-2/5 font-bold"},"EP",-1)),s.auth.user.type==1||s.auth.user.type==2?(d(),l("td",J,[p(t("input",{class:"bg-white/90 w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400",type:"number","onUpdate:modelValue":e[3]||(e[3]=o=>i.form.dp=o)},null,512),[[h,i.form.dp]])])):(d(),l("td",I,r(s.user.dp.toLocaleString()),1))]),t("tr",null,[e[16]||(e[16]=t("td",{class:"p-1 w-2/5 font-bold"},"消費PT",-1)),t("td",Y,r(s.user.consume_point.toLocaleString()),1)])],64)):a("",!0),s.profile?(d(),l(f,{key:1},[t("tr",null,[e[17]||(e[17]=t("td",{class:"p-1 w-2/5 font-bold"},"名前",-1)),t("td",q,r(s.profile.first_name)+" "+r(s.profile.last_name),1)]),t("tr",null,[e[18]||(e[18]=t("td",{class:"p-1 w-2/5 font-bold"},"名前(カナ)",-1)),t("td",G,r(s.profile.first_name_gana)+" "+r(s.profile.last_name_gana),1)]),t("tr",null,[e[19]||(e[19]=t("td",{class:"p-1 w-2/5 font-bold"},"郵便番号",-1)),t("td",K,r(s.profile.postal_code),1)]),t("tr",null,[e[20]||(e[20]=t("td",{class:"p-1 w-2/5 font-bold"},"都道府県",-1)),t("td",Q,r(s.profile.prefecture),1)]),t("tr",null,[e[21]||(e[21]=t("td",{class:"p-1 w-2/5 font-bold"},"住所",-1)),t("td",R,r(s.profile.city)+r(s.profile.street)+"　"+r(s.profile.building),1)]),t("tr",null,[e[22]||(e[22]=t("td",{class:"p-1 w-2/5 font-bold"},"ランク",-1)),t("td",W,r(s.rank),1)]),s.subscription?(d(),l("tr",X,[e[23]||(e[23]=t("td",{class:"p-1 w-2/5 font-bold"},"サブスクリプション",-1)),t("td",Z,r(s.subscription.plan.name)+" ("+r(s.subscription.plan.amount.toLocaleString("jp-JP",{style:"currency",currency:"JPY"}))+", "+r(s.subscription.plan.point)+" pt)     "+r(s.subscription.starting_date)+" 登録 ",1)])):a("",!0),t("tr",null,[e[24]||(e[24]=t("td",{class:"p-1 w-2/5 font-bold"},"招待コード",-1)),t("td",$,r(s.user.invite_code),1)])],64)):a("",!0),s.auth.user.type==1?(d(),l("tr",tt,[e[26]||(e[26]=t("td",{class:"p-1 w-2/5 font-bold"},"アカウント種別",-1)),t("td",et,[p(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>i.form.type=o),class:"w-full px-3 py-2 border border-neutral-300 focus:border-neutral-300 focus:ring focus:ring-neutral-200 focus:ring-opacity-50 rounded-md placeholder-neutral-400"},[...e[25]||(e[25]=[t("option",{value:"0"},"ユーザー",-1),t("option",{value:"2"},"管理スタッフ",-1),t("option",{value:"3"},"発送スタッフ",-1)])],512),[[L,i.form.type]])])])):a("",!0),s.auth.user.type==1&&s.user.type!=1||s.auth.user.type==2&&s.user.type==0?(d(),l("tr",st,[e[27]||(e[27]=t("td",{class:"p-1 w-2/5 font-bold"},"アカウント承認",-1)),t("td",ot,[s.user.status?(d(),l("button",{key:0,onClick:e[5]||(e[5]=o=>u.updateStatus(s.user.id,0)),class:"px-2 py-1 rounded-md border text-rose-500 hover:bg-rose-100"},"削除")):(d(),l("button",{key:1,onClick:e[6]||(e[6]=o=>u.updateStatus(s.user.id,1)),class:"px-2 py-1 rounded-md border text-sky-500 hover:bg-sky-100"},"承認"))])])):a("",!0),t("tr",null,[e[28]||(e[28]=t("td",{class:"p-1 w-2/5 font-bold"},"タグ",-1)),t("td",rt,[t("div",nt,[t("div",lt,[(d(!0),l(f,null,x(s.user.tags||[],o=>(d(),l("span",{key:o.id,class:"px-3 py-1 rounded-full text-sm font-medium text-white",style:_({backgroundColor:o.color_theme})},r(o.name),5))),128)),!s.user.tags||s.user.tags.length===0?(d(),l("span",dt,"タグなし")):a("",!0)]),t("div",it,[(d(!0),l(f,null,x(s.allTags,o=>(d(),l("label",{key:o.id,class:k(["flex items-center gap-2 px-3 py-1 border rounded cursor-pointer hover:bg-gray-50",{"bg-blue-50 border-blue-300":u.isTagSelected(o.id)}])},[p(t("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":e[7]||(e[7]=F=>i.tagForm.tag_ids=F),class:"rounded"},null,8,ut),[[T,i.tagForm.tag_ids]]),t("div",{class:"w-4 h-4 rounded border",style:_({backgroundColor:o.color_theme})},null,4),t("span",at,r(o.name),1),o.type==="auto"?(d(),l("span",mt," (自動: "+r(u.format_number(o.purchase_amount_limit))+"円) ",1)):a("",!0)],2))),128))]),t("button",{onClick:e[8]||(e[8]=(...o)=>u.assignTags&&u.assignTags(...o)),disabled:i.tagForm.processing,class:"mt-2 px-4 py-2 bg-blue-500 hover:bg-blue-700 text-white rounded-md disabled:opacity-50 text-sm"}," タグを更新 ",8,ft)])])])])]),s.auth.user.type==1?(d(),l("div",bt,[t("button",{type:"button",onClick:e[9]||(e[9]=(...o)=>u.submit&&u.submit(...o)),class:k([{"opacity-25":i.form.processing},"inline-block items-center px-10 py-1 rounded-full font-semibold text-white uppercase bg-theme bg-theme-hover"]),disabled:i.form.processing}," 保存 ",10,pt)])):a("",!0)])]),_:1})],64)}const _t=M(P,[["render",ct]]);export{_t as default};
