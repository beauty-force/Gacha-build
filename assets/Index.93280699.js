import{o as a,c as d,d as t,t as n,h as x,G as P,q as w,i as G,w as k,b as f,D as g,H as O,f as v,F as _,I as F,e as j,n as S,J as R,aa as U,a as K}from"./app.68a61c2a.js";import{A as Q}from"./UserLayout.04e29594.js";import{o as B,f as W,u as X}from"./useConfirm.f7e6c9b6.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.88147dc6.js";const Y={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Z={class:"flex flex-col items-center"},tt=t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-theme"},null,-1),et={class:"mt-2 text-white text-sm"},st={__name:"Loading",props:{show:{type:Boolean,default:!1},message:{type:String,default:"\u8AAD\u307F\u8FBC\u307F\u4E2D..."}},setup(o){return(p,y)=>o.show?(a(),d("div",Y,[t("div",Z,[tt,t("p",et,n(o.message),1)])])):x("",!0)}},ot={class:"md:py-2 md:px-4 bg-white"},it={class:"space-y-6 mb-4"},nt=["src"],rt={class:"py-4 px-4 overflow-hidden"},at={class:"bg-white border-gray-200"},dt={key:0,class:"mb-8"},lt=t("h3",{class:"text-lg font-bold mb-4 text-gray-800 flex items-center"},[t("svg",{class:"w-6 h-6 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),j(" \u73FE\u5728\u306E\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3 ")],-1),ct={class:"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border border-blue-200 rounded-2xl p-4 shadow-lg"},ut={class:"flex items-center gap-4 mb-2"},mt={class:"flex-shrink-0"},ht=["src"],_t={class:"flex-1"},gt={class:"text-xl font-bold text-gray-900 mb-1"},xt={class:"text-sm text-gray-600"},bt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ft={class:"bg-white rounded-xl p-4 shadow-sm border border-blue-100"},vt={class:"flex items-center justify-between"},pt=t("p",{class:"text-sm text-gray-600 mb-1"},"\u6708\u984D\u6599\u91D1",-1),yt={class:"text-2xl font-bold text-gray-900"},wt=t("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1),kt={class:"bg-white rounded-xl p-4 shadow-sm border border-green-100"},St={class:"flex items-center justify-between"},jt=t("p",{class:"text-sm text-gray-600 mb-1"},"\u4ED8\u4E0E\u30DD\u30A4\u30F3\u30C8",-1),Dt={class:"text-2xl font-bold text-green-600"},Ct=t("div",{class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},[t("img",{src:"/images/icon_cash.png",class:"w-6 h-6"})],-1),Lt={class:"bg-white rounded-xl p-4 shadow-sm border border-rose-100"},Pt={class:"flex items-center justify-between"},Ft=t("p",{class:"text-sm text-gray-600 mb-1"},"\u304A\u5F97\u30DD\u30A4\u30F3\u30C8",-1),$t={class:"text-2xl font-bold text-rose-600"},Jt=t("div",{class:"w-10 h-10 bg-rose-100 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-rose-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1),Mt={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},Bt={class:"flex-1"},Tt={key:0,class:"bg-white rounded-xl p-4 shadow-sm border border-gray-200"},zt={class:"flex items-center gap-4"},Vt=["src","alt"],Nt={class:"flex-1"},At={class:"font-semibold text-gray-900"},It={class:"text-sm text-gray-500"},Et={class:"text-xs text-gray-500"},Ht={class:"flex-shrink-0"},qt={class:"flex justify-end"},Gt=["disabled"],Ot=t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Rt=t("h3",{class:"text-lg font-semibold mb-4"},"\u5229\u7528\u53EF\u80FD\u306A\u30D7\u30E9\u30F3",-1),Ut={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Kt={class:"flex items-center gap-2 mb-4"},Qt={class:"flex-shrink-0"},Wt=["src"],Xt={class:"flex-1 min-w-0"},Yt={class:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl px-3 py-2 border border-gray-200"},Zt={class:"flex flex-col"},te={class:"flex justify-between items-center gap-3"},ee=t("p",{class:"text-xs text-gray-600"},"\u6708\u984D",-1),se={class:"text-base font-bold text-gray-900"},oe={class:"flex justify-between items-center gap-3"},ie=t("p",{class:"text-xs text-gray-600"},"\u30DD\u30A4\u30F3\u30C8",-1),ne={class:"text-base font-bold text-green-600"},re={class:"text-end mt-2"},ae={class:"inline-flex items-center px-3 py-1 bg-rose-100 text-rose-600 text-xs font-semibold rounded-full"},de=t("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),le={class:"mb-3"},ce={class:"flex items-center justify-between p-2 bg-blue-50 rounded"},ue={class:"flex items-center gap-2"},me=t("svg",{class:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),he={class:"min-w-0 flex-1"},_e=t("p",{class:"text-xs font-medium text-blue-900"},"\u767B\u9332\u671F\u9593",-1),ge=["title"],xe=["onSubmit"],be=["disabled"],fe={key:0,class:"text-xs text-gray-500 mt-1 text-center"},ve={class:"my-6 space-y-6"},pe=["src"],ye={class:"py-3 px-1 text-center"},we={class:"font-bold text-lg"},ke={class:"text-lg font-bold text-theme mt-1"},Se=t("span",{class:"text-sm font-normal"},"/\u6708",-1),je={class:"p-2"},De={key:0,class:"text-sm text-gray-500 mb-2"},Ce={key:1,class:"space-y-2"},Le=["onClick"],Pe=["id","value"],Fe=["for"],$e={class:"flex items-center"},Je=["src","alt"],Me={class:"font-medium"},Be={class:"text-sm text-gray-500"},Te={class:"text-xs text-gray-500"},ze={key:2,class:"text-gray-500 mb-2"},Ve=t("hr",{class:"my-1"},null,-1),Ne={class:"flex justify-between p-2 gap-2"},Ae=["disabled"],Oe={__name:"Index",props:{plans:Array,currentSubscription:Object,cards:Array,images:Array,top_images:Array},setup(o){const p=o,{confirm:y}=X(),D=P({}),C=w(!1),c=w(""),m=w(null),u=w(!1),h=e=>new Intl.NumberFormat("ja-JP").format(e),T=e=>new Date(e).toLocaleDateString("ja-JP"),$=e=>`/images/credit_cards/${e.toLowerCase()}.svg`,J=e=>e.replace(/(.{4})/g,"$1 ").trim(),M=e=>`${e.slice(0,2)}/${e.slice(2)}`,z=e=>{if(!e.start_date&&!e.end_date)return"\u7121\u5236\u9650";if(e.start_date&&e.end_date){const i=new Date(e.start_date),s=new Date(e.end_date),l=i.toLocaleDateString("ja-JP",{month:"2-digit",day:"2-digit"})+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),r=s.toLocaleDateString("ja-JP",{month:"2-digit",day:"2-digit"})+" "+s.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`${l} - ${r}`}if(e.start_date){const i=new Date(e.start_date);return`${i.toLocaleDateString("ja-JP",{month:"2-digit",day:"2-digit"})+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})} \u304B\u3089`}if(e.end_date){const i=new Date(e.end_date);return`${i.toLocaleDateString("ja-JP",{month:"2-digit",day:"2-digit"})+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})} \u307E\u3067`}return"\u7121\u5236\u9650"},V=e=>{if(!e.start_date&&!e.end_date)return"\u767B\u9332\u671F\u9593: \u7121\u5236\u9650";if(e.start_date&&e.end_date){const i=new Date(e.start_date),s=new Date(e.end_date),l=i.toLocaleDateString("ja-JP")+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),r=s.toLocaleDateString("ja-JP")+" "+s.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"});return`\u767B\u9332\u671F\u9593: ${l} - ${r}`}if(e.start_date){const i=new Date(e.start_date);return`\u767B\u9332\u958B\u59CB: ${i.toLocaleDateString("ja-JP")+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})}`}if(e.end_date){const i=new Date(e.end_date);return`\u767B\u9332\u7D42\u4E86: ${i.toLocaleDateString("ja-JP")+" "+i.toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})}`}return"\u767B\u9332\u671F\u9593: \u7121\u5236\u9650"},N=e=>{switch(e){case"upcoming":return"\u958B\u59CB\u524D";case"ended":return"\u7D42\u4E86\u6E08\u307F";default:return""}},A=e=>{switch(e){case"active":return"\u53D7\u4ED8\u4E2D";case"upcoming":return"\u958B\u59CB\u524D";case"ended":return"\u7D42\u4E86\u6E08\u307F";default:return"\u53D7\u4ED8\u4E2D"}},I=()=>{y("\u89E3\u7D04\u3057\u307E\u3059\u304B\uFF1F","\u89E3\u7D04\u5F8C\u30011\u30F6\u6708\u9593\u767B\u9332\u306F\u3067\u304D\u307E\u305B\u3093\u3002").then(e=>{e&&(u.value=!0,D.post(route("user.subscription.cancel",p.currentSubscription.id),{onFinish:()=>{u.value=!1}}))})},E=()=>{u.value=!0,K.get(route("user.point.card_register",{type:"subscription"})).then(e=>{u.value=!1,e.data.status==1&&(window.location.href=e.data.link_url)}).catch(()=>{u.value=!1})},H=e=>{m.value=e,C.value=!0},b=()=>{C.value=!1,c.value="",m.value=null},q=()=>{m.value&&c.value&&(p.currentSubscription?y("\u30D7\u30E9\u30F3\u3092\u5909\u66F4\u3057\u307E\u3059\u304B\uFF1F",'<div class="text-start space-y-2"><div>\u2022\u3000\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u306E\u5834\u5408\u3001\u73FE\u5728\u306E\u30D7\u30E9\u30F3\u3068\u306E\u5DEE\u984D\u304C\u3059\u3050\u306B\u8ACB\u6C42\u3055\u308C\u3001\u8ACB\u6C42\u65E5\u3082\u672C\u65E5\u306B\u66F4\u65B0\u3055\u308C\u307E\u3059\u3002</div><div>\u2022\u3000\u30C0\u30A6\u30F3\u30B0\u30EC\u30FC\u30C9\u307E\u305F\u306F\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u5909\u66F4\u3059\u308B\u5834\u5408\u3001\u8ACB\u6C42\u65E5\u306F\u5909\u308F\u3089\u305A\u3001\u6B21\u56DE\u306E\u8ACB\u6C42\u6642\u306B\u65B0\u3057\u3044\u30D7\u30E9\u30F3\u306E\u6599\u91D1\u304C\u9069\u7528\u3055\u308C\u307E\u3059\u3002</div></div>').then(e=>{e&&(u.value=!0,P({plan_id:m.value.id,card_id:c.value}).post(route("user.subscription.update",p.currentSubscription.id),{onFinish:()=>{u.value=!1,b()},preserveScroll:!0}))}):y("\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3\u306B\u767B\u9332\u3057\u307E\u3059\u304B\uFF1F").then(e=>{e&&(u.value=!0,P({card_id:c.value}).post(route("user.subscription.subscribe",m.value.id),{onFinish:()=>{u.value=!1,b()},preserveScroll:!0}))}))};return(e,i)=>(a(),G(Q,null,{default:k(()=>[f(g(O),{title:"\u30B5\u30D6\u30B9\u30AF\u30EA\u30D7\u30B7\u30E7\u30F3"}),f(st,{show:u.value,message:"\u51E6\u7406\u4E2D..."},null,8,["show","message"]),t("div",ot,[t("div",it,[(a(!0),d(_,null,v(o.top_images,(s,l)=>(a(),d("img",{key:l,src:s,class:"w-full"},null,8,nt))),128))]),t("div",rt,[t("div",at,[o.currentSubscription?(a(),d("div",dt,[lt,t("div",ct,[t("div",ut,[t("div",mt,[t("img",{src:"/images/plans/"+o.currentSubscription.plan.image,class:"w-24 h-20 object-contain flex-shrink-0 rounded-lg"},null,8,ht)]),t("div",_t,[t("h4",gt,n(o.currentSubscription.plan.name),1),t("p",xt,"\u958B\u59CB\u65E5: "+n(T(o.currentSubscription.start_date)),1)])]),t("div",bt,[t("div",ft,[t("div",vt,[t("div",null,[pt,t("p",yt,"\xA5"+n(h(o.currentSubscription.plan.amount)),1)]),wt])]),t("div",kt,[t("div",St,[t("div",null,[jt,t("p",Dt,n(h(o.currentSubscription.plan.point)),1)]),Ct])]),t("div",Lt,[t("div",Pt,[t("div",null,[Ft,t("p",$t,n(h(o.currentSubscription.plan.point-o.currentSubscription.plan.amount)),1)]),Jt])])]),t("div",Mt,[t("div",Bt,[(a(!0),d(_,null,v(o.cards,s=>(a(),d(_,null,[o.currentSubscription.card_id===s.id?(a(),d("div",Tt,[t("div",zt,[t("img",{src:$(s.brand),alt:s.brand,class:"w-16 h-10"},null,8,Vt),t("div",Nt,[t("p",At,n(J(s.card_no)),1),t("p",It,"\u6709\u52B9\u671F\u9650: "+n(M(s.expire)),1),t("p",Et,"\u540D\u7FA9\u4EBA: "+n(s.holder_name),1)])])])):x("",!0)],64))),256))]),t("div",Ht,[t("form",{onSubmit:i[0]||(i[0]=F(s=>I(),["prevent"]))},[t("div",qt,[t("button",{type:"submit",class:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 px-6 rounded-xl text-sm transition-all duration-200 transform hover:scale-105 disabled:opacity-50 flex items-center",disabled:g(D).processing},[Ot,j(" \u89E3\u7D04 ")],8,Gt)])],32)])])])])):x("",!0),Rt,t("div",Ut,[(a(!0),d(_,null,v(o.plans,s=>{var l,r;return a(),d("div",{key:s.id,class:S(["bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow duration-200",{"ring-2 ring-yellow-400 ring-offset-1":((l=o.currentSubscription)==null?void 0:l.plan_id)===s.id,"border-2 border-gray-200":((r=o.currentSubscription)==null?void 0:r.plan_id)!==s.id}])},[t("div",Kt,[t("div",Qt,[t("img",{src:s.image,class:"w-36 object-contain"},null,8,Wt)]),t("div",Xt,[t("div",Yt,[t("div",Zt,[t("div",te,[ee,t("p",se,"\xA5"+n(h(s.amount)),1)]),t("div",oe,[ie,t("p",ne,n(h(s.point)),1)])]),t("div",re,[t("span",ae,[de,j(" "+n(h(s.point-s.amount))+" pt\u304A\u5F97!! ",1)])])])])]),t("div",le,[t("div",ce,[t("div",ue,[me,t("div",he,[_e,t("p",{class:"text-xs text-blue-700 truncate",title:V(s)},n(z(s)),9,ge)])]),t("span",{class:S(["inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",{"bg-green-100 text-green-800":s.status==="active","bg-blue-100 text-blue-800":s.status==="upcoming","bg-gray-100 text-gray-600":s.status==="ended"}])},n(A(s.status)),3)])]),t("div",null,[t("form",{onSubmit:F(L=>H(s),["prevent"])},[t("button",{type:"submit",class:"w-full bg-theme bg-theme-hover text-white font-bold py-2 px-3 rounded text-xs transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g(D).processing||!s.is_available_for_subscription},n(o.currentSubscription?o.currentSubscription.plan_id!=s.id?"\u30D7\u30E9\u30F3\u5909\u66F4":"\u30AB\u30FC\u30C9\u5909\u66F4":"\u53C2\u52A0\u3059\u308B!"),9,be)],40,xe),s.is_available_for_subscription?x("",!0):(a(),d("p",fe,n(N(s.status)),1))])],2)}),128))]),t("div",ve,[(a(!0),d(_,null,v(o.images,(s,l)=>(a(),d("img",{key:l,src:s,class:"w-full"},null,8,pe))),128))])])])]),f(g(W),{show:C.value,class:""},{default:k(()=>[f(g(B),{enter:"transition ease-in-out duration-200 transform","enter-from":"translate-y-full","enter-to":"translate-y-0",leave:"transition ease-in-out duration-200 transform","leave-from":"translate-y-0","leave-to":"translate-y-full",as:"template"},{default:k(()=>{var s,l;return[t("div",{class:"fixed inset-0 z-40",onClick:b},[t("div",{class:"flex flex-col text-neutral-700 rounded relative z-20 top-20 w-fit min-w-64 px-4 bg-neutral-50 border-l border-neutral-200 m-auto max-w-[90%] py-2",onClick:i[2]||(i[2]=F(()=>{},["stop"]))},[t("div",ye,[t("div",we,n((s=m.value)==null?void 0:s.name),1),t("div",ke,[j("\xA5 "+n(h((l=m.value)==null?void 0:l.amount)),1),Se])]),t("div",je,[o.cards.length>0?(a(),d("div",De,"\u304A\u652F\u6255\u3044\u30AB\u30FC\u30C9\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044")):x("",!0),o.cards.length>0?(a(),d("div",Ce,[(a(!0),d(_,null,v(o.cards,r=>(a(),d(_,{key:r.id},[!o.currentSubscription||m.value&&m.value.id!=o.currentSubscription.plan_id||r.id!=o.currentSubscription.card_id?(a(),d("div",{key:0,class:S([{"border-yellow-500 bg-yellow-50 border-2":c.value===r.id,"hover:bg-gray-50 hover:border-gray-300":c.value!==r.id},"flex items-center p-2 border rounded cursor-pointer"]),onClick:L=>c.value=r.id},[R(t("input",{type:"radio",id:"card-"+r.id,value:r.id,"onUpdate:modelValue":i[1]||(i[1]=L=>c.value=L),class:"mr-2 focus:ring-0 focus:ring-offset-0"},null,8,Pe),[[U,c.value]]),t("label",{for:"card-"+r.id,class:"flex-1 cursor-pointer"},[t("div",$e,[t("img",{src:$(r.brand),alt:r.brand,class:"w-20 h-12 mr-2"},null,8,Je),t("div",null,[t("p",Me,n(J(r.card_no)),1),t("p",Be,"\u6709\u52B9\u671F\u9650: "+n(M(r.expire)),1),t("p",Te,"\u540D\u7FA9\u4EBA: "+n(r.holder_name),1)])])],8,Fe)],10,Le)):x("",!0)],64))),128))])):(a(),d("div",ze," \u767B\u9332\u6E08\u307F\u306E\u30AB\u30FC\u30C9\u304C\u3042\u308A\u307E\u305B\u3093 "))]),Ve,t("button",{onClick:E,class:"text-blue-500 hover:text-blue-700 text-sm p-2"}," + \u65B0\u3057\u3044\u30AB\u30FC\u30C9\u3092\u767B\u9332 "),t("div",Ne,[t("button",{onClick:b,class:"bg-gray-300 text-gray-700 flex-1 py-2 rounded text-sm"}," \u30AD\u30E3\u30F3\u30BB\u30EB "),t("button",{onClick:q,class:S(["bg-theme text-white flex-1 py-2 rounded text-sm",{"opacity-50":!c.value}]),disabled:!c.value}," \u78BA\u8A8D ",10,Ae)])])])]}),_:1}),f(g(B),{enter:"transition-opacity ease-linear duration-200","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-200","leave-from":"opacity-100","leave-to":"opacity-0",class:"fixed inset-0 z-30"},{default:k(()=>[t("div",{class:"bg-neutral-600 h-full bg-opacity-50",onClick:b})]),_:1})]),_:1},8,["show"])]),_:1}))}};export{Oe as default};
