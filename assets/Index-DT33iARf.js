import{d as x,r as m,c as d,o as n,a,w as b,i as u,b as t,F as g,f as _,l as N,n as h,e as y,t as c,h as C,j,m as L}from"./app-D8qqHlea.js";import{A as B}from"./UserLayout-BrlhOyYO.js";import{u as H}from"./useConfirm-n4MunjC8.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as S,a as T,c as U,r as E}from"./ChevronRightIcon-Vqc2GG6M.js";import"./index-DwEkfMsA.js";const{confirm:I,alert:v}=H(),M={components:{Head:x.Head,AppLayout:B,Link:x.Link,ChevronDoubleLeftIcon:E,ChevronDoubleRightIcon:U,ChevronLeftIcon:T,ChevronRightIcon:S},props:{errors:Object,gacha:Object,category_share:Object,products:Object,profile:Object,delivery_limit:Number},data(){return{hasCheck:!1,main_tab:[{title:"未選択",route_url:route("user.products"),is_active:!0},{title:"発送待ち",route_url:route("user.products.wait"),is_active:!1},{title:"発送済み",route_url:route("user.products.delivered"),is_active:!1}],ready_delivery:0,products_count:0,isCheckAll:!1,_products:this.products.data.filter(r=>r.status==1)}},setup(r){console.log(r.products);let e={};return{form:x.useForm({checks:e})}},methods:{format_number(r){return String(r).replace(/(.)(?=(\d{3})+$)/g,"$1,")},changeCheck(){let r,e=!1;for(this._products=this.products.data.filter(o=>o.status==1),this.isCheckAll=this._products.length>0,r=0;r<this._products.length;r++)this.form.checks["id"+this._products[r].id]?e=!0:this.isCheckAll=!1;this.hasCheck=e},submit(r){let e,o=0;var l=0;let i=0;for(e=0;e<this._products.length;e++)this.form.checks["id"+this._products[e].id]&&(o++,l=parseInt(l)+parseInt(this._products[e].point),this._products[e].rare=="ポイント"&&i++);if(r=="point")l>0&&I("交換しますか？ 選択した"+o+"点の商品を"+this.format_number(l)+"ptと交換します。").then(f=>{f&&this.form.post(route("user.products.point.exchange"),{onFinish:()=>{this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})});else{if(i>0){v("ポイントは発送できません");return}if(o>0){if(l<this.delivery_limit){v("発送依頼ができる最低ポイントは"+this.format_number(this.delivery_limit)+"ptです。");return}this.products_count=o,this.ready_delivery=1}}},back_delivery(){this.ready_delivery=0},submit_delivery(){this.profile.city&&this.profile.street?I(""+this.products_count+"点の商品を配送しますか？").then(r=>{r&&this.form.post(route("user.delivery.post"),{onFinish:()=>{this.ready_delivery=2,this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})}):v("入力エラー、配送先情報を入力してください。")},checkall(){let r;for(this.hasCheck=!1,r=0;r<this._products.length;r++)this.form.checks["id"+this._products[r].id]=this.isCheckAll,this.hasCheck=this.isCheckAll}}},P={key:0,class:"w-full min-h-full"},q={class:"sticky top-20 py-3 z-[2] bg-white"},G={class:"w-full text-neutral-500 space-x-1 border-b-4 border-yellow-500 px-4 flex justify-center"},J={key:0,class:"sticky top-[8.5rem] z-[3] bg-white py-2 px-4 flex justify-center items-center gap-1 border-b"},K={class:"px-3 py-1.5 rounded-md text-xs border border-yellow-500 bg-yellow-500 text-white font-bold"},Q={class:"grid md:grid-cols-2 gap-1 px-4 md:px-6 py-2"},W={class:"flex border-neutral-200 items-start w-full"},X=["id","onUpdate:modelValue"],Y=["for"],Z={class:"relative"},$=["src"],ee=["src","alt"],te={class:"min-h-28 flex flex-col justify-evenly flex-1 items-start gap-0.5"},se=["src"],oe={class:"text-base px-3 font-bold"},re={key:1,class:"text-sm px-3"},ie={class:"text-xs px-3 text-neutral-400"},le={key:2,class:"flex bg-red-500 justify-center items-center rounded-full px-3 mx-auto min-w-[60%] py-0.5 text-white w-fit text-base"},ne={key:1,class:"sticky bottom-16 md:bottom-20 bg-white py-5 space-y-3"},de={class:"text-center relative"},ce={class:"flex items-center cursor-pointer justify-center"},ae={class:"text-center text-neutral-600 flex justify-center items-center gap-2 text-xs md:text-sm"},ue=["disabled"],he=["disabled"],fe={key:2,class:"flex items-center justify-center py-8"},be={key:1,class:"pt-6 md:px-6 px-4"},pe={class:"mb-3 text-sm"},me={class:"mb-8 grid md:grid-cols-2"},ye={key:0,class:"mb-0 border-neutral-200 border-b p-1"},ge={class:"flex border-neutral-200 items-center"},xe=["src"],_e=["for"],ve={class:"text-red-500"},ke={class:"mb-8 border border-neutral-200 rounded-md px-4 py-2 flex items-center justify-between"},we={class:"flex-1 space-y-1"},Ce={class:"font-bold text-sm"},je={class:"text-sm"},Le={class:"text-sm"},Ie={key:0,class:"text-sm"},Ae={class:"mb-8 text-center text-neutral-50"},De=["disabled"],Ve=["disabled"],Oe={key:2,class:"pt-6 md:px-6 px-4"},Re={class:"mb-8"},Fe={class:"mb-6 text-center text-neutral-50 flex flex-wrap justify-center gap-2"};function Ne(r,e,o,l,i,f){const A=m("Head"),p=m("Link"),D=m("ChevronDoubleLeftIcon"),V=m("ChevronLeftIcon"),O=m("ChevronRightIcon"),R=m("ChevronDoubleRightIcon"),F=m("AppLayout");return n(),d(g,null,[a(A,{title:"獲得した商品一覧"}),a(F,null,{default:b(()=>[i.ready_delivery==0?(n(),d("div",P,[e[16]||(e[16]=t("h1",{class:"underline underline-offset-8 py-3 text-center text-lg font-bold bg-white"},"   獲得した商品一覧   ",-1)),t("div",q,[t("div",G,[(n(!0),d(g,null,_(i.main_tab,(s,k)=>(n(),N(p,{href:s.route_url,class:h(["-mb-[1px] flex-1 inline-block text-center py-1.5 rounded-t-md border-yellow-500 border-x border-t",{"bg-yellow-500 text-white":s.is_active,"hover:bg-yellow-400 hover:text-white":!s.is_active}])},{default:b(()=>[y(c(s.title),1)]),_:2},1032,["href","class"]))),256))])]),o.products.data.length&&o.products.last_page>1?(n(),d("div",J,[a(p,{href:o.products.first_page_url||r.route("user.products",{page:1}),class:h(["w-8 h-8 rounded-md text-sm border border-yellow-500 font-medium transition-colors flex items-center justify-center",o.products.current_page>1?"bg-white text-yellow-600 hover:bg-yellow-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed opacity-50"])},{default:b(()=>[a(D,{class:"w-4 h-4"})]),_:1},8,["href","class"]),a(p,{href:o.products.prev_page_url||"#",class:h(["w-8 h-8 rounded-md text-sm border border-yellow-500 font-medium transition-colors flex items-center justify-center",o.products.prev_page_url?"bg-white text-yellow-600 hover:bg-yellow-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed opacity-50"]),onClick:e[0]||(e[0]=C(()=>{},["prevent"]))},{default:b(()=>[a(V,{class:"w-4 h-4"})]),_:1},8,["href","class"]),t("span",K,c(o.products.current_page)+" / "+c(o.products.last_page),1),a(p,{href:o.products.next_page_url||"#",class:h(["w-8 h-8 rounded-md text-sm border border-yellow-500 font-medium transition-colors flex items-center justify-center",o.products.next_page_url?"bg-white text-yellow-600 hover:bg-yellow-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed opacity-50"]),onClick:e[1]||(e[1]=C(()=>{},["prevent"]))},{default:b(()=>[a(O,{class:"w-4 h-4"})]),_:1},8,["href","class"]),a(p,{href:o.products.last_page_url||r.route("user.products",{page:o.products.last_page}),class:h(["w-8 h-8 rounded-md text-sm border border-yellow-500 font-medium transition-colors flex items-center justify-center",o.products.current_page<o.products.last_page?"bg-white text-yellow-600 hover:bg-yellow-50 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed opacity-50"])},{default:b(()=>[a(R,{class:"w-4 h-4"})]),_:1},8,["href","class"])])):u("",!0),t("div",Q,[(n(!0),d(g,null,_(o.products.data,(s,k)=>(n(),d("div",{class:h(["mt-1 py-2 px-3 border rounded-md hover:bg-yellow-50",{"bg-yellow-100 border-yellow-300":l.form.checks["id"+s.id]}])},[t("div",W,[j(t("input",{id:"checkbox"+s.id,"onUpdate:modelValue":w=>l.form.checks["id"+s.id]=w,type:"checkbox",onChange:e[2]||(e[2]=w=>f.changeCheck()),class:"cursor-pointer rounded border-yellow-300 text-yellow-600 shadow-sm focus:ring-0 m-1"},null,40,X),[[L,l.form.checks["id"+s.id]]]),t("label",{for:"checkbox"+s.id,class:"flex-1 cursor-pointer flex items-center text-sm py-1 px-2"},[t("div",Z,[t("img",{src:s.image,class:"h-28 w-20 object-contain"},null,8,$),s.badge?(n(),d("img",{key:0,src:s.badge,class:"absolute -top-2 -right-2 w-[35%]",alt:s.badge},null,8,ee)):u("",!0)]),t("div",te,[s.rank>0?(n(),d("img",{key:0,src:`/images/badge${s.rank}.png`,class:"px-3 h-7 w-auto object-contain"},null,8,se)):u("",!0),t("div",oe,c(s.name),1),s.gacha_title?(n(),d("div",re,c(s.gacha_title),1)):u("",!0),t("div",ie,"保有期限: "+c(s.expiration),1),s.is_lost_product!=2?(n(),d("div",le,[e[11]||(e[11]=t("img",{src:"/images/icon_cash.png",class:"h-4 mr-1"},null,-1)),t("span",null,c(s.point.toLocaleString())+" PT",1)])):u("",!0)])],8,Y)])],2))),256))]),o.products.data.length?(n(),d("div",ne,[t("div",de,[t("label",ce,[j(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=s=>i.isCheckAll=s),onChange:e[4]||(e[4]=s=>f.checkall()),class:"h-5 w-5 cursor-pointer rounded border-yellow-400 text-yellow-600 focus:ring-0"},null,544),[[L,i.isCheckAll]]),e[12]||(e[12]=t("span",{class:"ml-2 font-bold text-yellow-600"},"全てを選択する",-1))])]),t("div",ae,[t("button",{type:"button",onClick:e[5]||(e[5]=s=>f.submit("point")),class:h([{"opacity-50":l.form.processing||!i.hasCheck},"w-40 md:w-60 inline-block items-center px-1 py-1 border rounded-md font-semibold text-white uppercase tracking-widest bg-theme bg-theme-hover focus:shadow-outline-blue transition ease-in-out duration-150"]),disabled:l.form.processing||!i.hasCheck},[...e[13]||(e[13]=[t("div",{class:"p-1"},"ポイントに換える",-1)])],10,ue),t("button",{type:"button",onClick:e[6]||(e[6]=s=>f.submit("delivery")),class:h([{"opacity-50":l.form.processing||!i.hasCheck},"w-40 md:w-60 inline-block items-center px-1 py-1 border rounded-md font-semibold text-white uppercase tracking-widest bg-theme bg-theme-hover focus:shadow-outline-lime transition ease-in-out duration-150"]),disabled:l.form.processing||!i.hasCheck},[...e[14]||(e[14]=[t("div",{class:"p-1"},"発送する",-1)])],10,he)])])):(n(),d("div",fe,[...e[15]||(e[15]=[t("p",{class:"text-center"},"獲得した商品はありません",-1)])]))])):u("",!0),i.ready_delivery==1?(n(),d("div",be,[e[18]||(e[18]=t("h2",{class:"mb-2 text-lg font-bold"},"配送内容の確認",-1)),e[19]||(e[19]=t("hr",{class:"mb-6"},null,-1)),t("div",pe,"配送商品 （計"+c(i.products_count)+"点）",1),t("div",me,[(n(!0),d(g,null,_(o.products.data,(s,k)=>(n(),d(g,null,[l.form.checks["id"+s.id]?(n(),d("div",ye,[t("div",ge,[t("img",{src:s.image,class:"h-20 inline-block object-contain"},null,8,xe),t("label",{for:"checkbox"+s.id,class:"cursor-pointer h-20 flex flex-col justify-evenly flex-1 text-xs py-1 px-2"},[t("div",null,c(s.name),1),t("div",null,c(s.rare),1),t("div",ve,c(s.point)+"pt",1)],8,_e)])])):u("",!0)],64))),256))]),e[20]||(e[20]=t("div",{class:"mb-2 text-sm"},"配送先情報",-1)),t("div",ke,[t("div",we,[o.profile.id?(n(),d(g,{key:0},[t("p",Ce,c(o.profile.first_name+o.profile.last_name),1),t("p",je,"〒"+c(o.profile.postal_code),1),t("p",Le,c(o.profile.city)+c(o.profile.street),1),o.profile.building?(n(),d("p",Ie,c(o.profile.building),1)):u("",!0)],64)):u("",!0)]),t("div",null,[a(p,{href:r.route("user.address"),type:"button",onClick:e[7]||(e[7]=s=>f.back_delivery()),class:h([{"opacity-25":l.form.processing||!i.hasCheck},"inline-block items-center px-5 py-1.5 bg-neutral-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-neutral-700 active:bg-neutral-700 focus:outline-none focus:border-neutral-700 focus:shadow-outline-neutral transition ease-in-out duration-150 m-1"]),disabled:l.form.processing||!i.hasCheck},{default:b(()=>[...e[17]||(e[17]=[y(" 編集 ",-1)])]),_:1},8,["href","class","disabled"])])]),t("div",Ae,[t("button",{type:"button",onClick:e[8]||(e[8]=s=>f.back_delivery()),class:h([{"opacity-25":l.form.processing||!i.hasCheck},"w-32 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-neutral-600 hover:bg-neutral-700 transition ease-in-out duration-150 m-1"]),disabled:l.form.processing||!i.hasCheck}," 戻る ",10,De),t("button",{type:"button",onClick:e[9]||(e[9]=s=>f.submit_delivery()),class:h([{"opacity-25":l.form.processing||!i.hasCheck},"w-32 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-theme bg-theme-hover transition ease-in-out duration-150 m-1"]),disabled:l.form.processing||!i.hasCheck}," 発送する ",10,Ve)])])):u("",!0),i.ready_delivery==2?(n(),d("div",Oe,[e[29]||(e[29]=t("h2",{class:"mb-2 text-lg font-bold"},"配送手続き完了",-1)),e[30]||(e[30]=t("hr",{class:"mb-8"},null,-1)),t("div",Re,[y(" 計"+c(i.products_count)+"点の商品の配送手続きが完了しました。",1),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=t("br",null,null,-1)),e[23]||(e[23]=y(" 商品の発送には",-1)),e[24]||(e[24]=t("span",{class:"font-bold"},"数日~数週間",-1)),e[25]||(e[25]=y("かかる可能性がございます。",-1)),e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=y(" ご了承のほどよろしくお願い致します。 ",-1))]),t("div",Fe,[a(p,{href:r.route("main"),class:"w-48 inline-block items-center px-1 py-2 bg-red-600 rounded-md font-semibold text-sm text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150 m-1"},{default:b(()=>[...e[28]||(e[28]=[y(" ガチャTOPへ ",-1)])]),_:1},8,["href"]),t("button",{type:"button",onClick:e[10]||(e[10]=s=>f.back_delivery()),class:"w-48 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-theme bg-theme-hover transition ease-in-out duration-150 m-1"}," 獲得した商品一覧へ ")])])):u("",!0)]),_:1})],64)}const Ee=z(M,[["render",Ne]]);export{Ee as default};
