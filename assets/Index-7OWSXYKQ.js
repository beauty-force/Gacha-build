import{d as y,r as _,c as d,o as n,a as f,w as m,i as u,b as t,F as b,f as k,l as O,n as h,e as p,t as c,j as C,m as j}from"./app-Bb4dk2vA.js";import{U as F}from"./UserLayout-DMC7_vET.js";import{u as N}from"./useConfirm-BoHXeJuv.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DUMVm5vt.js";const{confirm:A,alert:g}=N(),B={components:{Head:y.Head,AppLayout:F,Link:y.Link},props:{errors:Object,gacha:Object,category_share:Object,products:Object,profile:Object,delivery_limit:Number},data(){return{hasCheck:!1,main_tab:[{title:"未選択",route_url:route("user.products"),is_active:!0},{title:"発送待ち",route_url:route("user.products.wait"),is_active:!1},{title:"発送済み",route_url:route("user.products.delivered"),is_active:!1}],ready_delivery:0,products_count:0,isCheckAll:!1,_products:this.products.data.filter(o=>o.status==1)}},setup(o){let e={};return{form:y.useForm({checks:e})}},methods:{format_number(o){return String(o).replace(/(.)(?=(\d{3})+$)/g,"$1,")},changeCheck(){let o,e=!1;for(this._products=this.products.data.filter(l=>l.status==1),this.isCheckAll=this._products.length>0,o=0;o<this._products.length;o++)this.form.checks["id"+this._products[o].id]?e=!0:this.isCheckAll=!1;this.hasCheck=e},submit(o){let e,l=0;var r=0;let i=0;for(e=0;e<this._products.length;e++)this.form.checks["id"+this._products[e].id]&&(l++,r=parseInt(r)+parseInt(this._products[e].point),this._products[e].rare=="ポイント"&&i++);if(o=="point")r>0&&A("交換しますか？ 選択した"+l+"点の商品を"+this.format_number(r)+"ptと交換します。").then(a=>{a&&this.form.post(route("user.products.point.exchange"),{onFinish:()=>{this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})});else{if(i>0){g("ポイントは発送できません");return}if(l>0){if(r<this.delivery_limit){g("発送依頼ができる最低ポイントは"+this.format_number(this.delivery_limit)+"ptです。");return}this.products_count=l,this.ready_delivery=1}}},back_delivery(){this.ready_delivery=0},submit_delivery(){this.profile.city&&this.profile.street?A(""+this.products_count+"点の商品を配送しますか？").then(o=>{o&&this.form.post(route("user.delivery.post"),{onFinish:()=>{this.ready_delivery=2,this.form.checks={},this.hasCheck=!1,this.isCheckAll=!1}})}):g("入力エラー、配送先情報を入力してください。")},checkall(){let o;for(this.hasCheck=!1,o=0;o<this._products.length;o++)this.form.checks["id"+this._products[o].id]=this.isCheckAll,this.hasCheck=this.isCheckAll}}},H={key:0,class:"w-full min-h-full"},I={class:"sticky top-20 py-3 z-[2] bg-white"},S={class:"w-full text-neutral-500 space-x-1 border-b-4 border-yellow-500 px-4 flex justify-center"},T={class:"grid md:grid-cols-2 gap-1 px-4 md:px-6 py-2"},z={class:"flex border-neutral-200 items-start w-full"},D=["id","onUpdate:modelValue"],E=["for"],P={class:"relative"},M=["src"],q=["src","alt"],G={class:"min-h-28 flex flex-col justify-evenly flex-1 items-start gap-0.5"},J=["src"],K={class:"text-base px-3 font-bold"},Q={key:1,class:"text-sm px-3"},R={class:"text-xs px-3 text-neutral-400"},W={key:2,class:"flex bg-red-500 justify-center items-center rounded-full px-3 mx-auto min-w-[60%] py-0.5 text-white w-fit text-base"},X={key:0,class:"sticky bottom-16 md:bottom-20 bg-white py-5 space-y-3"},Y={class:"text-center relative"},Z={class:"flex items-center cursor-pointer justify-center"},$={class:"text-center text-neutral-600 flex justify-center items-center gap-2 text-xs md:text-sm"},ee=["disabled"],te=["disabled"],se={key:1,class:"flex items-center justify-center py-8"},oe={key:1,class:"pt-6 md:px-6 px-4"},ie={class:"mb-3 text-sm"},re={class:"mb-8 grid md:grid-cols-2"},le={key:0,class:"mb-0 border-neutral-200 border-b p-1"},ne={class:"flex border-neutral-200 items-center"},de=["src"],ce=["for"],ae={class:"text-red-500"},ue={class:"mb-8 border border-neutral-200 rounded-md px-4 py-2 flex items-center justify-between"},he={class:"flex-1 space-y-1"},pe={class:"font-bold text-sm"},be={class:"text-sm"},fe={class:"text-sm"},me={key:0,class:"text-sm"},xe={class:"mb-8 text-center text-neutral-50"},ye=["disabled"],_e=["disabled"],ke={key:2,class:"pt-6 md:px-6 px-4"},ge={class:"mb-8"},ve={class:"mb-6 text-center text-neutral-50 flex flex-wrap justify-center gap-2"};function we(o,e,l,r,i,a){const L=_("Head"),x=_("Link"),V=_("AppLayout");return n(),d(b,null,[f(L,{title:"獲得した商品一覧"}),f(V,null,{default:m(()=>[i.ready_delivery==0?(n(),d("div",H,[e[14]||(e[14]=t("h1",{class:"underline underline-offset-8 py-3 text-center text-lg font-bold bg-white"},"   獲得した商品一覧   ",-1)),t("div",I,[t("div",S,[(n(!0),d(b,null,k(i.main_tab,(s,v)=>(n(),O(x,{href:s.route_url,class:h(["-mb-[1px] flex-1 inline-block text-center py-1.5 rounded-t-md border-yellow-500 border-x border-t",{"bg-yellow-500 text-white":s.is_active,"hover:bg-yellow-400 hover:text-white":!s.is_active}])},{default:m(()=>[p(c(s.title),1)]),_:2},1032,["href","class"]))),256))])]),t("div",T,[(n(!0),d(b,null,k(l.products.data,(s,v)=>(n(),d("div",{class:h(["mt-1 py-2 px-3 border rounded-md hover:bg-yellow-50",{"bg-yellow-100 border-yellow-300":r.form.checks["id"+s.id]}])},[t("div",z,[C(t("input",{id:"checkbox"+s.id,"onUpdate:modelValue":w=>r.form.checks["id"+s.id]=w,type:"checkbox",onChange:e[0]||(e[0]=w=>a.changeCheck()),class:"cursor-pointer rounded border-yellow-300 text-yellow-600 shadow-sm focus:ring-0 m-1"},null,40,D),[[j,r.form.checks["id"+s.id]]]),t("label",{for:"checkbox"+s.id,class:"flex-1 cursor-pointer flex items-center text-sm py-1 px-2"},[t("div",P,[t("img",{src:s.image,class:"h-28 w-20 object-contain"},null,8,M),s.badge?(n(),d("img",{key:0,src:s.badge,class:"absolute -top-2 -right-2 w-[35%]",alt:s.badge},null,8,q)):u("",!0)]),t("div",G,[s.rank>0?(n(),d("img",{key:0,src:`/images/badge${s.rank}.png`,class:"px-3 h-7 w-auto object-contain"},null,8,J)):u("",!0),t("div",K,c(s.name),1),s.gacha_title?(n(),d("div",Q,c(s.gacha_title),1)):u("",!0),t("div",R,"保有期限: "+c(s.expiration),1),s.is_lost_product!=2?(n(),d("div",W,[e[9]||(e[9]=t("img",{src:"/images/icon_cash.png",class:"h-4 mr-1"},null,-1)),t("span",null,c(s.point.toLocaleString())+" PT",1)])):u("",!0)])],8,E)])],2))),256))]),l.products.data.length?(n(),d("div",X,[t("div",Y,[t("label",Z,[C(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=s=>i.isCheckAll=s),onChange:e[2]||(e[2]=s=>a.checkall()),class:"h-5 w-5 cursor-pointer rounded border-yellow-400 text-yellow-600 focus:ring-0"},null,544),[[j,i.isCheckAll]]),e[10]||(e[10]=t("span",{class:"ml-2 font-bold text-yellow-600"},"全てを選択する",-1))])]),t("div",$,[t("button",{type:"button",onClick:e[3]||(e[3]=s=>a.submit("point")),class:h([{"opacity-50":r.form.processing||!i.hasCheck},"w-40 md:w-60 inline-block items-center px-1 py-1 border rounded-md font-semibold text-white uppercase tracking-widest bg-theme bg-theme-hover focus:shadow-outline-blue transition ease-in-out duration-150"]),disabled:r.form.processing||!i.hasCheck},[...e[11]||(e[11]=[t("div",{class:"p-1"},"ポイントに換える",-1)])],10,ee),t("button",{type:"button",onClick:e[4]||(e[4]=s=>a.submit("delivery")),class:h([{"opacity-50":r.form.processing||!i.hasCheck},"w-40 md:w-60 inline-block items-center px-1 py-1 border rounded-md font-semibold text-white uppercase tracking-widest bg-theme bg-theme-hover focus:shadow-outline-lime transition ease-in-out duration-150"]),disabled:r.form.processing||!i.hasCheck},[...e[12]||(e[12]=[t("div",{class:"p-1"},"発送する",-1)])],10,te)])])):(n(),d("div",se,[...e[13]||(e[13]=[t("p",{class:"text-center"},"獲得した商品はありません",-1)])]))])):u("",!0),i.ready_delivery==1?(n(),d("div",oe,[e[16]||(e[16]=t("h2",{class:"mb-2 text-lg font-bold"},"配送内容の確認",-1)),e[17]||(e[17]=t("hr",{class:"mb-6"},null,-1)),t("div",ie,"配送商品 （計"+c(i.products_count)+"点）",1),t("div",re,[(n(!0),d(b,null,k(l.products.data,(s,v)=>(n(),d(b,null,[r.form.checks["id"+s.id]?(n(),d("div",le,[t("div",ne,[t("img",{src:s.image,class:"h-20 inline-block object-contain"},null,8,de),t("label",{for:"checkbox"+s.id,class:"cursor-pointer h-20 flex flex-col justify-evenly flex-1 text-xs py-1 px-2"},[t("div",null,c(s.name),1),t("div",null,c(s.rare),1),t("div",ae,c(s.point)+"pt",1)],8,ce)])])):u("",!0)],64))),256))]),e[18]||(e[18]=t("div",{class:"mb-2 text-sm"},"配送先情報",-1)),t("div",ue,[t("div",he,[l.profile.id?(n(),d(b,{key:0},[t("p",pe,c(l.profile.first_name+l.profile.last_name),1),t("p",be,"〒"+c(l.profile.postal_code),1),t("p",fe,c(l.profile.city)+c(l.profile.street),1),l.profile.building?(n(),d("p",me,c(l.profile.building),1)):u("",!0)],64)):u("",!0)]),t("div",null,[f(x,{href:o.route("user.address"),type:"button",onClick:e[5]||(e[5]=s=>a.back_delivery()),class:h([{"opacity-25":r.form.processing||!i.hasCheck},"inline-block items-center px-5 py-1.5 bg-neutral-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-neutral-700 active:bg-neutral-700 focus:outline-none focus:border-neutral-700 focus:shadow-outline-neutral transition ease-in-out duration-150 m-1"]),disabled:r.form.processing||!i.hasCheck},{default:m(()=>[...e[15]||(e[15]=[p(" 編集 ",-1)])]),_:1},8,["href","class","disabled"])])]),t("div",xe,[t("button",{type:"button",onClick:e[6]||(e[6]=s=>a.back_delivery()),class:h([{"opacity-25":r.form.processing||!i.hasCheck},"w-32 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-neutral-600 hover:bg-neutral-700 transition ease-in-out duration-150 m-1"]),disabled:r.form.processing||!i.hasCheck}," 戻る ",10,ye),t("button",{type:"button",onClick:e[7]||(e[7]=s=>a.submit_delivery()),class:h([{"opacity-25":r.form.processing||!i.hasCheck},"w-32 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-theme bg-theme-hover transition ease-in-out duration-150 m-1"]),disabled:r.form.processing||!i.hasCheck}," 発送する ",10,_e)])])):u("",!0),i.ready_delivery==2?(n(),d("div",ke,[e[27]||(e[27]=t("h2",{class:"mb-2 text-lg font-bold"},"配送手続き完了",-1)),e[28]||(e[28]=t("hr",{class:"mb-8"},null,-1)),t("div",ge,[p(" 計"+c(i.products_count)+"点の商品の配送手続きが完了しました。",1),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=t("br",null,null,-1)),e[21]||(e[21]=p(" 商品の発送には",-1)),e[22]||(e[22]=t("span",{class:"font-bold"},"数日~数週間",-1)),e[23]||(e[23]=p("かかる可能性がございます。",-1)),e[24]||(e[24]=t("br",null,null,-1)),e[25]||(e[25]=p(" ご了承のほどよろしくお願い致します。 ",-1))]),t("div",ve,[f(x,{href:o.route("main"),class:"w-48 inline-block items-center px-1 py-2 bg-red-600 rounded-md font-semibold text-sm text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-700 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150 m-1"},{default:m(()=>[...e[26]||(e[26]=[p(" ガチャTOPへ ",-1)])]),_:1},8,["href"]),t("button",{type:"button",onClick:e[8]||(e[8]=s=>a.back_delivery()),class:"w-48 inline-block items-center px-1 py-2 rounded-md font-semibold text-sm text-white uppercase tracking-widest bg-theme bg-theme-hover transition ease-in-out duration-150 m-1"}," 獲得した商品一覧へ ")])])):u("",!0)]),_:1})],64)}const Oe=U(B,[["render",we]]);export{Oe as default};
